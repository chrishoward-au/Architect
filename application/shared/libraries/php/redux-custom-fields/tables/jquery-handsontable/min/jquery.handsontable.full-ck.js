var Handsontable={extension:{},helper:{}};!function(t,e,o){"use strict";function i(){this.refCounter=0,this.init()}function n(){function t(){var t=this;t.registerTimeout("enableObserveChanges",function(){t.updateSettings({observeChanges:!0})},0)}function e(t){return function(e,o){return e[1]===o[1]?0:null===e[1]?1:null===o[1]?-1:e[1]<o[1]?t?-1:1:e[1]>o[1]?t?1:-1:0}}function o(t){return function(e,o){if(e[1]===o[1])return 0;if(null===e[1])return 1;if(null===o[1])return-1;var i=new Date(e[1]),n=new Date(o[1]);return n>i?t?-1:1:i>n?t?1:-1:0}}function i(t){return"undefined"!=typeof t.sortColumn}var n=this;this.init=function(e){var o=this,i=o.getSettings().columnSorting,r,l;if(o.sortingEnabled=!!i,o.sortingEnabled){o.sortIndex=[];var c=s.call(o);"undefined"!=typeof c?(r=c.sortColumn,l=c.sortOrder):(r=i.column,l=i.sortOrder),n.sortByColumn.call(o,r,l),o.sort=function(){var t=Array.prototype.slice.call(arguments);return n.sortByColumn.apply(o,t)},"undefined"==typeof o.getSettings().observeChanges&&t.call(o),"afterInit"==e&&(a.call(o),o.addHook("afterCreateRow",n.afterCreateRow),o.addHook("afterRemoveRow",n.afterRemoveRow),o.addHook("afterLoadData",n.init))}else delete o.sort,o.removeHook("afterCreateRow",n.afterCreateRow),o.removeHook("afterRemoveRow",n.afterRemoveRow),o.removeHook("afterLoadData",n.init)},this.setSortingColumn=function(t,e){var o=this;return"undefined"==typeof t?(delete o.sortColumn,void delete o.sortOrder):(o.sortOrder=o.sortColumn===t&&"undefined"==typeof e?!o.sortOrder:"undefined"!=typeof e?e:!0,void(o.sortColumn=t))},this.sortByColumn=function(t,e){var o=this;n.setSortingColumn.call(o,t,e),"undefined"!=typeof o.sortColumn&&(o.PluginHooks.run("beforeColumnSort",o.sortColumn,o.sortOrder),n.sort.call(o),o.render(),r.call(o),o.PluginHooks.run("afterColumnSort",o.sortColumn,o.sortOrder))};var r=function(){var t=this,e={};"undefined"!=typeof t.sortColumn&&(e.sortColumn=t.sortColumn),"undefined"!=typeof t.sortOrder&&(e.sortOrder=t.sortOrder),(e.hasOwnProperty("sortColumn")||e.hasOwnProperty("sortOrder"))&&t.PluginHooks.run("persistentStateSave","columnSorting",e)},s=function(){var t=this,e={};return t.PluginHooks.run("persistentStateLoad","columnSorting",e),e.value},a=function(){function t(){var t=o.view.TBODY.querySelector("tr").querySelectorAll("th");return t.length}function e(e){var i=o.view.wt.wtDom.closest(e,"TH");return o.view.wt.wtDom.index(i)-t()}var o=this;o.rootElement.on("click.handsontable",".columnSorting",function(t){if(o.view.wt.wtDom.hasClass(t.target,"columnSorting")){var i=e(t.target);n.sortByColumn.call(o,i)}})};this.sort=function(){var t=this;if("undefined"!=typeof t.sortOrder){t.sortingEnabled=!1,t.sortIndex.length=0;for(var i=this.colOffset(),n=0,r=this.countRows()-t.getSettings().minSpareRows;r>n;n++)this.sortIndex.push([n,t.getDataAtCell(n,this.sortColumn+i)]);var s=t.getCellMeta(0,t.sortColumn),a;switch(s.type){case"date":a=o;break;default:a=e}this.sortIndex.sort(a(t.sortOrder));for(var n=this.sortIndex.length;n<t.countRows();n++)this.sortIndex.push([n,t.getDataAtCell(n,this.sortColumn+i)]);t.sortingEnabled=!0}},this.translateRow=function(t){var e=this;return e.sortingEnabled&&e.sortIndex&&e.sortIndex.length&&e.sortIndex[t]?e.sortIndex[t][0]:t},this.onBeforeGetSet=function(t){var e=this;t.row=n.translateRow.call(e,t.row)},this.untranslateRow=function(t){var e=this;if(e.sortingEnabled&&e.sortIndex&&e.sortIndex.length)for(var o=0;o<e.sortIndex.length;o++)if(e.sortIndex[o][0]==t)return o},this.getColHeader=function(t,e){this.getSettings().columnSorting&&this.view.wt.wtDom.addClass(e.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(t,e){var o=this;if(i(o)){for(var n=0;n<o.sortIndex.length;n++)o.sortIndex[n][0]>=t&&(o.sortIndex[n][0]+=e);for(var n=0;e>n;n++)o.sortIndex.splice(t+n,0,[t+n,o.getData()[t+n][o.sortColumn+o.colOffset()]]);r.call(o)}},this.afterRemoveRow=function(t,e){var o=this;if(i(o)){var s=n.translateRow.call(o,t);o.sortIndex.splice(t,e);for(var a=0;a<o.sortIndex.length;a++)o.sortIndex[a][0]>s&&(o.sortIndex[a][0]-=e);r.call(o)}},this.afterChangeSort=function(t){var e=this,o=!1,i={};if(t){for(var r=0;r<t.length;r++)if(t[r][1]==e.sortColumn){o=!0,i.row=n.translateRow.call(e,t[r][0]),i.col=t[r][1];break}o&&setTimeout(function(){n.sort.call(e),e.render(),e.selectCell(n.untranslateRow.call(e,i.row),i.col)},0)}}}function r(){var e,o,i,n,r,s=document.createElement("DIV"),a=s.style;s.className="ghost",a.position="absolute",a.top="25px",a.left=0,a.width="10px",a.height="10px",a.backgroundColor="#CCC",a.opacity=.7;var l=function(){var t=this;t.PluginHooks.run("persistentStateSave","manualColumnPositions",t.manualColumnPositions)},c=function(){var t=this,e={};return t.PluginHooks.run("persistentStateLoad","manualColumnPositions",e),e.value},h=function(){var c=this;c.rootElement.on("mousemove.manualColumnMove",function(t){e&&(a.left=r+t.pageX-n+6+"px","none"===a.display&&(a.display="block"))}),c.rootElement.on("mouseup.manualColumnMove",function(){e&&(i>o&&i--,c.getSettings().rowHeaders&&(o--,i--),c.manualColumnPositions.splice(i,0,c.manualColumnPositions.splice(o,1)[0]),t(".manualColumnMover.active").removeClass("active"),e=!1,c.forceFullRender=!0,c.view.render(),a.display="none",l.call(c),c.PluginHooks.run("afterColumnMove",o,i))}),c.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(t){var l=t.currentTarget,h=c.view.wt.wtDom.closest(l,"TH");o=c.view.wt.wtDom.index(h)+c.colOffset(),i=o,e=!0,n=t.pageX;var u=c.$table[0];u.parentNode.appendChild(s),a.width=c.view.wt.wtDom.outerWidth(h)+"px",a.height=c.view.wt.wtDom.outerHeight(u)+"px",r=parseInt(c.view.wt.wtDom.offset(h).left-c.view.wt.wtDom.offset(u).left,10),a.left=r+6+"px"}),c.rootElement.on("mouseenter.manualColumnMove","td, th",function(){if(e){var t=c.view.THEAD.querySelector(".manualColumnMover.active");t&&c.view.wt.wtDom.removeClass(t,"active"),i=c.view.wt.wtDom.index(this)+c.colOffset();var o=c.view.THEAD.querySelectorAll("th"),n=o[i].querySelector(".manualColumnMover");c.view.wt.wtDom.addClass(n,"active")}}),c.addHook("afterDestroy",u)},u=function(){var t=this;t.rootElement.off("mouseup.manualColumnMove"),t.rootElement.off("mousemove.manualColumnMove"),t.rootElement.off("mousedown.manualColumnMove"),t.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(t){var e=this,o=!!this.getSettings().manualColumnMove;if(o){var i=this.getSettings().manualColumnMove,n=c.call(e);this.manualColumnPositions="undefined"!=typeof n?n:i instanceof Array?i:[],e.forceFullRender=!0,"afterInit"==t&&(h.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else u.call(this),this.manualColumnPositions=[]},this.modifyCol=function(t){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[t]&&(this.manualColumnPositions[t]=t),this.manualColumnPositions[t]):t},this.getColHeader=function(t,e){if(this.getSettings().manualColumnMove){var o=document.createElement("DIV");o.className="manualColumnMover",e.firstChild.appendChild(o)}}}function s(){function e(t){a=this,n=t;var e=this.view.wt.wtTable.getCoords(t)[1];if(e>=0){r=e;var o=this.view.wt.wtDom.offset(this.rootElement[0]).left,i=this.view.wt.wtDom.offset(t).left;u=i-o-6,d.style.left=u+parseInt(this.view.wt.wtDom.outerWidth(t),10)+"px",this.rootElement[0].appendChild(d)}}function o(){var t=this;h=parseInt(this.view.wt.wtDom.outerWidth(n),10),t.view.wt.wtDom.addClass(d,"active"),g.height=t.view.wt.wtDom.outerHeight(t.$table[0])+"px",i=t}var i,n,r,s,a,l,c,h,u,d=document.createElement("DIV"),p=document.createElement("DIV"),f=document.createElement("DIV"),g=f.style;d.className="manualColumnResizer",p.className="manualColumnResizerHandle",d.appendChild(p),f.className="manualColumnResizerLine",d.appendChild(f);var m=t(document);m.mousemove(function(t){i&&(s=h+(t.pageX-c),l=C(r,s),d.style.left=u+s+"px")}),m.mouseup(function(){i&&(a.view.wt.wtDom.removeClass(d,"active"),i=!1,l!=h&&(a.forceFullRender=!0,a.view.render(),w.call(a),a.PluginHooks.run("afterColumnResize",r,l)),e.call(a,n))});var w=function(){var t=this;t.PluginHooks.run("persistentStateSave","manualColumnWidths",t.manualColumnWidths)},y=function(){var t=this,e={};return t.PluginHooks.run("persistentStateLoad","manualColumnWidths",e),e.value},v=function(){var t=this,n=0,s=null;this.rootElement.on("mouseenter.handsontable","th",function(o){i||e.call(t,o.currentTarget)}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){null==s&&(s=setTimeout(function(){n>=2&&(l=t.determineColumnWidth.call(t,r),C(r,l),t.forceFullRender=!0,t.view.render(),t.PluginHooks.run("afterColumnResize",r,l)),n=0,s=null},500)),n++}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(e){c=e.pageX,o.call(t),l=h})};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(t){var e=this,o=!!this.getSettings().manualColumnResize;if(o){var i=this.getSettings().manualColumnResize,n=y.call(e);this.manualColumnWidths="undefined"!=typeof n?n:i instanceof Array?i:[],"afterInit"==t&&(v.call(this),e.forceFullRender=!0,e.render())}};var C=function(t,e){return e=Math.max(e,20),t=a.PluginHooks.execute("modifyCol",t),a.manualColumnWidths[t]=e,e};this.getColWidth=function(t,e){this.getSettings().manualColumnResize&&this.manualColumnWidths[t]&&(e.width=this.manualColumnWidths[t])}}function a(t){var o,i=function(){e.localStorage[t+"__persistentStateKeys"]=JSON.stringify(o)},n=function(){var i=e.localStorage[t+"__persistentStateKeys"],n="string"==typeof i?JSON.parse(i):void 0;o=n?n:[]},r=function(){o=[],i()};n(),this.saveValue=function(n,r){e.localStorage[t+"_"+n]=JSON.stringify(r),-1==o.indexOf(n)&&(o.push(n),i())},this.loadValue=function(o,i){o="undefined"!=typeof o?o:i;var n=e.localStorage[t+"_"+o];return"undefined"==typeof n?void 0:JSON.parse(n)},this.reset=function(o){e.localStorage.removeItem(t+"_"+o)},this.resetAll=function(){for(var i=0;i<o.length;i++)e.localStorage.removeItem(t+"_"+o[i]);r()}}function l(){this.boundaries=null,this.callback=null}function c(){this.maxOuts=10}function h(e,o){var i;this.instance=e,this.settings=o,this.wtDom=this.instance.wtDom,this.main=document.createElement("div"),i=this.main.style,i.position="absolute",i.top=0,i.left=0;for(var n=0;5>n;n++){var r=document.createElement("DIV");r.className="wtBorder "+(o.className||""),i=r.style,i.backgroundColor=o.border.color,i.height=o.border.width+"px",i.width=o.border.width+"px",this.main.appendChild(r)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.hider.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.appendChild(this.main);var s=!1,a=t(document.body);a.on("mousedown.walkontable."+e.guid,function(){s=!0}),a.on("mouseup.walkontable."+e.guid,function(){s=!1}),t(this.main.childNodes).on("mouseenter",function(o){if(s&&e.getSetting("hideBorderOnMouseDownOver")){o.preventDefault(),o.stopImmediatePropagation();var i=this.getBoundingClientRect(),n=t(this);n.hide();var r=function(t){return t.clientY<Math.floor(i.top)?!0:t.clientY>Math.ceil(i.top+i.height)?!0:t.clientX<Math.floor(i.left)?!0:t.clientX>Math.ceil(i.left+i.width)?!0:void 0};a.on("mousemove.border."+e.guid,function(t){r(t)&&(a.off("mousemove.border."+e.guid),n.show())})}})}function u(){this.offset=0,this.total=0,this.fixedCount=0}function d(t){this.instance=t}function p(){this.cache=[]}function f(){this.countTH=0}function g(t,e,o,i){var n,r=0;for(d.apply(this,arguments),this.containerSizeFn=e,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.remainingSize=0,this.strategy=i;;){if(n=o(r),void 0===n)break;if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+n))break;this.cellSizes.push(n),this.cellSizesSum+=n,this.cellCount++,r++}var s=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-s}function m(t){var e=this,o=[];if(this.guid="wt_"+b(),this.wtDom=new y,t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=new O(this,t.table),this.wtScroll=new E(this),this.wtViewport=t.cloneSource.wtViewport):(this.wtSettings=new P(this,t),this.wtTable=new O(this,t.table),this.wtScroll=new E(this),this.wtViewport=new M(this),this.wtScrollbars=new k(this),this.wtWheel=new N(this),this.wtEvent=new v(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var i=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;n>i;i++)o.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(t,i){e.wtDom.fastInnerText(i,o[t])}])}this.selections={};var r=this.getSetting("selections");if(r)for(var s in r)r.hasOwnProperty(s)&&(this.selections[s]=new A(this,r[s]));this.drawn=!1,this.drawInterrupted=!1}function w(e){this.instance=e,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";var o=this,i,n=0,r=0,s=o.clone.wtTable.holder.parentNode;t(document.body).on("mousemove."+this.instance.guid,function(t){o.instance.wtTable.holder.parentNode&&(t.clientX-n>-5&&t.clientX-n<5&&t.clientY-r>-5&&t.clientY-r<5||(n=t.clientX,r=t.clientY,y.prototype.addClass(s,"wtDebugHidden"),y.prototype.removeClass(s,"wtDebugVisible"),clearTimeout(i),i=setTimeout(function(){y.prototype.removeClass(s,"wtDebugHidden"),y.prototype.addClass(s,"wtDebugVisible")},1e3)))})}function y(){}function v(e){var o=this;this.instance=e,this.wtDom=this.instance.wtDom;var i=[null,null],n=[null,null],r=function(t){var e=o.parentCell(t.target);o.wtDom.hasClass(t.target,"corner")?o.instance.getSetting("onCellCornerMouseDown",t,t.target):e.TD&&"TD"===e.TD.nodeName&&o.instance.hasSetting("onCellMouseDown")&&o.instance.getSetting("onCellMouseDown",t,e.coords,e.TD),2!==t.button&&e.TD&&"TD"===e.TD.nodeName&&(i[0]=e.TD,clearTimeout(n[0]),n[0]=setTimeout(function(){i[0]=null},1e3))},s,a=function(t){if(o.instance.hasSetting("onCellMouseOver")){var e=o.instance.wtTable.TABLE,i=o.wtDom.closest(t.target,["TD","TH"],e);i&&i!==s&&o.wtDom.isChildOf(i,e)&&(s=i,"TD"===i.nodeName&&o.instance.getSetting("onCellMouseOver",t,o.instance.wtTable.getCoords(i),i))}},l=function(t){if(2!==t.button){var e=o.parentCell(t.target);e.TD===i[0]&&e.TD===i[1]?(o.wtDom.hasClass(t.target,"corner")?o.instance.getSetting("onCellCornerDblClick",t,e.coords,e.TD):e.TD&&o.instance.getSetting("onCellDblClick",t,e.coords,e.TD),i[0]=null,i[1]=null):e.TD===i[0]&&(i[1]=e.TD,clearTimeout(n[1]),n[1]=setTimeout(function(){i[1]=null},500))}};t(this.instance.wtTable.holder).on("mousedown",r),t(this.instance.wtTable.TABLE).on("mouseover",a),t(this.instance.wtTable.holder).on("mouseup",l)}function C(){for(var t=arguments[0],e=arguments[1],o=1,i=arguments.length/2;i>o;o++)if(t<=arguments[2*o+1]&&e>=arguments[2*o])return!0;return!1}function b(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function S(){}function T(t,e,o){d.apply(this,arguments),this.containerSizeFn=e,this.sizeAtIndex=o,this.cellSizesSum=0,this.cellSizes=[],this.cellCount=0,this.remainingSize=-1/0}function E(t){this.instance=t}function R(){}function x(t){this.instance=t,this.init(),this.clone=this.makeClone("corner")}function D(t){this.instance=t,this.type="horizontal",this.cellSize=50,this.init(),this.clone=this.makeClone("left")}function H(t){this.instance=t,this.type="vertical",this.cellSize=23,this.init(),this.clone=this.makeClone("top")}function k(t){this.instance=t,t.getSetting("nativeScrollbars")?(t.update("scrollbarWidth",t.wtDom.getScrollbarWidth()),t.update("scrollbarHeight",t.wtDom.getScrollbarWidth()),this.vertical=new H(t),this.horizontal=new D(t),this.corner=new x(t),t.getSetting("debug")&&(this.debug=new w(t)),this.registerListeners()):(this.vertical=new K(t),this.horizontal=new X(t))}function A(t,e){this.instance=t,this.settings=e,this.selected=[],e.border&&(this.border=new h(t,e))}function P(t,e){var o=this;this.instance=t,this.defaults={table:void 0,debug:!1,scrollH:"auto",scrollV:"auto",nativeScrollbars:!1,stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(t,e,i){var n=o.getSetting("data",t,e);o.instance.wtDom.fastInnerText(i,void 0===n||null===n?"":n)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10},this.settings={};for(var i in this.defaults)if(this.defaults.hasOwnProperty(i))if(void 0!==e[i])this.settings[i]=e[i];else{if(void 0===this.defaults[i])throw new Error('A required setting "'+i+'" was not provided');this.settings[i]=this.defaults[i]}}function O(t,e){this.instance=t,this.TABLE=e,this.wtDom=this.instance.wtDom,this.wtDom.removeTextNodes(this.TABLE);var o=this.TABLE.parentNode;if(!o||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var i=document.createElement("DIV");i.className="wtSpreader",o&&o.insertBefore(i,this.TABLE),i.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,o=this.spreader.parentNode,!o||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var n=document.createElement("DIV");n.className="wtHider",o&&o.insertBefore(n,this.spreader),n.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",o=this.hider.parentNode,!o||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var r=document.createElement("DIV");r.style.position="relative",r.className="wtHolder",o&&o.insertBefore(r,this.hider),r.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var s=document.createElement("TR");this.THEAD.appendChild(s)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.oldCellCache=new p,this.currentCellCache=new p,this.rowFilter=new S,this.columnFilter=new f,this.verticalRenderReverse=!1}function M(o){if(this.instance=o,this.resetSettings(),this.instance.getSetting("nativeScrollbars")){var i=this;t(e).on("resize",function(){i.clientHeight=i.getWorkspaceHeight()})}}function N(e){e.getSetting("nativeScrollbars")||t(e.wtTable.spreader).on("mousewheel",function(t,o,i,n){i||n||!o||(n=o),(i||n)&&(n>0&&0===e.getSetting("offsetRow")||0>n&&e.wtTable.isLastRowFullyVisible()||0>i&&0===e.getSetting("offsetColumn")||i>0&&e.wtTable.isLastColumnFullyVisible()||(clearTimeout(e.wheelTimeout),e.wheelTimeout=setTimeout(function(){n?e.wtScrollbars.vertical.visible&&e.scrollVertical(-Math.ceil(n)).draw():i&&e.wtScrollbars.horizontal.visible&&e.scrollHorizontal(Math.ceil(i)).draw()},0),t.preventDefault()))})}Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=e);e>o;o++)if(o in this&&this[o]===t)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){function o(t){return/NodeList/i.test(t.item)}function i(t){for(var e=[],o=0,i=t.length;i>o;o++)e[o]=t[o];return e}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof t)throw new TypeError;e=e||this,o(e)&&(e=i(e));var n=e.length,r=[],s,a;for(s=0;n>s;s+=1)e.hasOwnProperty(s)&&(a=e[s],t.call(e,a,s,e)&&r.push(a));return r}),"undefined"==typeof WeakMap&&!function(){var t=Object.defineProperty;try{var o=!0;t(function(){},"foo",{})}catch(i){o=!1}var n=+new Date%1e9,r=function(){this.name="__st"+(1e9*Math.random()>>>0)+(n++ +"__"),o||(this._wmCache=[])};r.prototype=o?{set:function(e,o){var i=e[this.name];i&&i[0]===e?i[1]=o:t(e,this.name,{value:[e,o],writable:!0})},get:function(t){var e;return(e=t[this.name])&&e[0]===t?e[1]:void 0},"delete":function(t){this.set(t,void 0)}}:{set:function(t,e){if("undefined"!=typeof t&&"undefined"!=typeof e){for(var o=0,i=this._wmCache.length;i>o;o++)if(this._wmCache[o].key==t)return void(this._wmCache[o].value=e);this._wmCache.push({key:t,value:e})}},get:function(t){if("undefined"!=typeof t)for(var e=0,o=this._wmCache.length;o>e;e++)if(this._wmCache[e].key==t)return this._wmCache[e].value},"delete":function(t){if("undefined"!=typeof t)for(var e=0,o=this._wmCache.length;o>e;e++)this._wmCache[e].key==t&&Array.prototype.slice.call(this._wmCache,e,1)}},e.WeakMap=r}(),o.activeGuid=null,o.Core=function(i,n){function r(){var t=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==t&&(t=!0,this.onQueueEmpty())}}}function s(e,o,i){function n(){var n;e.length&&(n=m.PluginHooks.execute("beforeChange",e,o),"function"==typeof n?t.when(result).then(function(){i()}):n===!1&&e.splice(0,e.length)),"function"!=typeof n&&i()}var s=new r;s.onQueueEmpty=n;for(var a=e.length-1;a>=0;a--)if(null===e[a])e.splice(a,1);else{var l=e[a][0],c=u.propToCol(e[a][1]),h=m.runHooksAndReturn("modifyCol",c),d=m.getCellMeta(l,h);"numeric"===d.type&&"string"==typeof e[a][3]&&e[a][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(e[a][3])&&(e[a][3]=numeral().unformat(e[a][3]||"0")),m.getCellValidator(d)&&(s.addValidatorToQueue(),m.validateCell(e[a][3],d,function(t,o){return function(i){if("boolean"!=typeof i)throw new Error("Validation error: result is not boolean");i===!1&&o.allowInvalid===!1&&(e.splice(t,1),o.valid=!0,--t),s.removeValidatorFormQueue()}}(a,d),o))}s.checkIfQueueIsEmpty()}function a(t,e){var o=t.length-1;if(!(0>o)){for(;o>=0;o--)if(null!==t[o]){if(h.settings.minSpareRows)for(;t[o][0]>m.countRows()-1;)u.createRow();if("array"===m.dataType&&h.settings.minSpareCols)for(;u.propToCol(t[o][1])>m.countCols()-1;)u.createCol();u.set(t[o][0],t[o][1],t[o][3])}else t.splice(o,1);m.forceFullRender=!0,d.adjustRowsAndCols(),p.refreshBorders(null,!0),m.PluginHooks.run("afterChange",t,e||"edit")}}function l(e,o,i){return"object"==typeof e?e:t.isPlainObject(i)?i:[[e,o,i]]}function c(t){if(t.hasOwnProperty("type")){var e,i={};if("object"==typeof t.type)e=t.type;else if("string"==typeof t.type&&(e=o.cellTypes[t.type],void 0===e))throw new Error('You declared cell type "'+t.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(i[n]=e[n]);return i}}var h,u,d,p,f,g,m=this,w=function(){};o.helper.extend(w.prototype,V.prototype),o.helper.extend(w.prototype,n),o.helper.extend(w.prototype,c(n)),this.rootElement=i;var y=t(document.documentElement),v=t(document.body);this.guid="ht_"+o.helper.randomString(),this.rootElement[0].id||(this.rootElement[0].id=this.guid),h={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new w,settingsFromDOM:{},selStart:new o.SelectionPoint,selEnd:new o.SelectionPoint,isPopulated:null,scrollable:null,extensions:{},firstRun:!0},d={alter:function(t,e,i,n,r){var s;switch(i=i||1,t){case"insert_row":s=u.createRow(e,i),s&&(h.selStart.exists()&&h.selStart.row()>=e?(h.selStart.row(h.selStart.row()+s),p.transformEnd(s,0)):p.refreshBorders());break;case"insert_col":if(s=u.createCol(e,i)){if(o.helper.isArray(m.getSettings().colHeaders)){var a=[e,0];a.length+=s,Array.prototype.splice.apply(m.getSettings().colHeaders,a)}h.selStart.exists()&&h.selStart.col()>=e?(h.selStart.col(h.selStart.col()+s),p.transformEnd(0,s)):p.refreshBorders()}break;case"remove_row":u.removeRow(e,i),h.cellSettings.splice(e,i),d.adjustRowsAndCols(),p.refreshBorders();break;case"remove_col":u.removeCol(e,i);for(var l=0,c=u.getAll().length;c>l;l++)l in h.cellSettings&&h.cellSettings[l].splice(e,i);o.helper.isArray(m.getSettings().colHeaders)&&("undefined"==typeof e&&(e=-1),m.getSettings().colHeaders.splice(e,i)),h.columnSettings.splice(e,i),d.adjustRowsAndCols(),p.refreshBorders();break;default:throw new Error('There is no such action "'+t+'"')}r||d.adjustRowsAndCols()},adjustRowsAndCols:function(){var t,e,o=m.countEmptyRows(!0),i;if(e=m.countRows(),e<h.settings.minRows)for(t=0;t<h.settings.minRows-e;t++)u.createRow(m.countRows(),1,!0);if(o<h.settings.minSpareRows)for(;o<h.settings.minSpareRows&&m.countRows()<h.settings.maxRows;o++)u.createRow(m.countRows(),1,!0);if(i=m.countEmptyCols(!0),!h.settings.columns&&m.countCols()<h.settings.minCols)for(;m.countCols()<h.settings.minCols;i++)u.createCol(m.countCols(),1,!0);if(!h.settings.columns&&"array"===m.dataType&&i<h.settings.minSpareCols)for(;i<h.settings.minSpareCols&&m.countCols()<h.settings.maxCols;i++)u.createCol(m.countCols(),1,!0);if(h.settings.enterBeginsEditing)for(;(h.settings.minRows||h.settings.minSpareRows)&&m.countRows()>h.settings.minRows&&h.settings.minSpareRows&&o>h.settings.minSpareRows;o--)u.removeRow();if(h.settings.enterBeginsEditing&&!h.settings.columns)for(;(h.settings.minCols||h.settings.minSpareCols)&&m.countCols()>h.settings.minCols&&h.settings.minSpareCols&&i>h.settings.minSpareCols;i--)u.removeCol();var n=m.countRows(),r=m.countCols();if((0===n||0===r)&&p.deselect(),h.selStart.exists()){var s,a=h.selStart.row(),l=h.selStart.col(),c=h.selEnd.row(),d=h.selEnd.col();a>n-1?(a=n-1,s=!0,c>a&&(c=a)):c>n-1&&(c=n-1,s=!0,a>c&&(a=c)),l>r-1?(l=r-1,s=!0,d>l&&(d=l)):d>r-1&&(d=r-1,s=!0,l>d&&(l=d)),s&&m.selectCell(a,l,c,d)}},populateFromArray:function(t,e,i,n,r){var s,a,l,c,u=[],d={};if(a=e.length,0===a)return!1;var p,f,g,w;switch(r){case"shift_down":for(p=i?i.col-t.col+1:0,f=i?i.row-t.row+1:0,e=o.helper.translateRowsToColumns(e),l=0,c=e.length,g=Math.max(c,p);g>l;l++)if(c>l){for(s=0,a=e[l].length;f-a>s;s++)e[l].push(e[l][s%a]);e[l].unshift(t.col+l,t.row,0),m.spliceCol.apply(m,e[l])}else e[l%c][0]=t.col+l,m.spliceCol.apply(m,e[l%c]);break;case"shift_right":for(p=i?i.col-t.col+1:0,f=i?i.row-t.row+1:0,s=0,a=e.length,w=Math.max(a,f);w>s;s++)if(a>s){for(l=0,c=e[s].length;p-c>l;l++)e[s].push(e[s][l%c]);e[s].unshift(t.row+s,t.col,0),m.spliceRow.apply(m,e[s])}else e[s%a][0]=t.row+s,m.spliceRow.apply(m,e[s%a]);break;case"overwrite":default:for(d.row=t.row,d.col=t.col,s=0;a>s&&!(i&&d.row>i.row||!h.settings.minSpareRows&&d.row>m.countRows()-1||d.row>=h.settings.maxRows);s++){for(d.col=t.col,c=e[s]?e[s].length:0,l=0;c>l&&!(i&&d.col>i.col||!h.settings.minSpareCols&&d.col>m.countCols()-1||d.col>=h.settings.maxCols);l++)m.getCellMeta(d.row,d.col).readOnly||u.push([d.row,d.col,e[s][l]]),d.col++,i&&l===c-1&&(l=-1);d.row++,i&&s===a-1&&(s=-1)}m.setDataAtCell(u,null,null,n||"populateFromArray")}},getCornerCoords:function(e){function o(e,o,i){function n(t){return t[i]}return Array.prototype.map?e.apply(Math,o.map(n)):e.apply(Math,t.map(o,n))}return{TL:{row:o(Math.min,e,"row"),col:o(Math.min,e,"col")},BR:{row:o(Math.max,e,"row"),col:o(Math.max,e,"col")}}},getCellsAtCoords:function(t,e){var o=d.getCornerCoords([t,e]),i,n,r=[];for(i=o.TL.row;i<=o.BR.row;i++)for(n=o.TL.col;n<=o.BR.col;n++)r.push(m.view.getCellAtCoords({row:i,col:n}));return r}},this.selection=p={inProgress:!1,begin:function(){m.selection.inProgress=!0},finish:function(){var t=m.getSelected();m.PluginHooks.run("afterSelectionEnd",t[0],t[1],t[2],t[3]),m.PluginHooks.run("afterSelectionEndByProp",t[0],m.colToProp(t[1]),t[2],m.colToProp(t[3])),m.selection.inProgress=!1},isInProgress:function(){return m.selection.inProgress},setRangeStart:function(t){h.selStart.coords(t),p.setRangeEnd(t)},setRangeEnd:function(t,e){m.selection.begin(),h.selEnd.coords(t),h.settings.multiSelect||h.selStart.coords(t),m.view.wt.selections.current.clear(),m.view.wt.selections.current.add(h.selStart.arr()),m.view.wt.selections.area.clear(),p.isMultiple()&&(m.view.wt.selections.area.add(h.selStart.arr()),m.view.wt.selections.area.add(h.selEnd.arr())),(h.settings.currentRowClassName||h.settings.currentColClassName)&&(m.view.wt.selections.highlight.clear(),m.view.wt.selections.highlight.add(h.selStart.arr()),m.view.wt.selections.highlight.add(h.selEnd.arr())),m.PluginHooks.run("afterSelection",h.selStart.row(),h.selStart.col(),h.selEnd.row(),h.selEnd.col()),m.PluginHooks.run("afterSelectionByProp",h.selStart.row(),u.colToProp(h.selStart.col()),h.selEnd.row(),u.colToProp(h.selEnd.col())),e!==!1&&m.view.scrollViewport(t),p.refreshBorders()},refreshBorders:function(t,e){e||f.destroyEditor(t),m.view.render(),p.isSelected()&&!e&&f.prepareEditor()},isMultiple:function(){return!(h.selEnd.col()===h.selStart.col()&&h.selEnd.row()===h.selStart.row())},transformStart:function(t,e,o){h.selStart.row()+t>m.countRows()-1?o&&h.settings.minSpareRows>0?m.alter("insert_row",m.countRows()):h.settings.autoWrapCol&&(t=1-m.countRows(),e=h.selStart.col()+e==m.countCols()-1?1-m.countCols():1):h.settings.autoWrapCol&&h.selStart.row()+t<0&&h.selStart.col()+e>=0&&(t=m.countRows()-1,e=h.selStart.col()+e==0?m.countCols()-1:-1),h.selStart.col()+e>m.countCols()-1?o&&h.settings.minSpareCols>0?m.alter("insert_col",m.countCols()):h.settings.autoWrapRow&&(t=h.selStart.row()+t==m.countRows()-1?1-m.countRows():1,e=1-m.countCols()):h.settings.autoWrapRow&&h.selStart.col()+e<0&&h.selStart.row()+t>=0&&(t=h.selStart.row()+t==0?m.countRows()-1:-1,e=m.countCols()-1);var i=m.countRows(),n=m.countCols(),r={row:h.selStart.row()+t,col:h.selStart.col()+e};r.row<0?r.row=0:r.row>0&&r.row>=i&&(r.row=i-1),r.col<0?r.col=0:r.col>0&&r.col>=n&&(r.col=n-1),p.setRangeStart(r)},transformEnd:function(t,e){if(h.selEnd.exists()){var o=m.countRows(),i=m.countCols(),n={row:h.selEnd.row()+t,col:h.selEnd.col()+e};n.row<0?n.row=0:n.row>0&&n.row>=o&&(n.row=o-1),n.col<0?n.col=0:n.col>0&&n.col>=i&&(n.col=i-1),p.setRangeEnd(n)}},isSelected:function(){return h.selEnd.exists()},inInSelection:function(t){if(!p.isSelected())return!1;var e=d.getCornerCoords([h.selStart.coords(),h.selEnd.coords()]);return e.TL.row<=t.row&&e.BR.row>=t.row&&e.TL.col<=t.col&&e.BR.col>=t.col},deselect:function(){p.isSelected()&&(m.selection.inProgress=!1,h.selEnd=new o.SelectionPoint,m.view.wt.selections.current.clear(),m.view.wt.selections.area.clear(),f.destroyEditor(),p.refreshBorders(),m.PluginHooks.run("afterDeselect"))},selectAll:function(){h.settings.multiSelect&&(p.setRangeStart({row:0,col:0}),p.setRangeEnd({row:m.countRows()-1,col:m.countCols()-1},!1))},empty:function(){if(p.isSelected()){var t=d.getCornerCoords([h.selStart.coords(),h.selEnd.coords()]),e,o,i=[];for(e=t.TL.row;e<=t.BR.row;e++)for(o=t.TL.col;o<=t.BR.col;o++)m.getCellMeta(e,o).readOnly||i.push([e,o,""]);
m.setDataAtCell(i)}}},this.autofill=g={handle:null,init:function(){g.handle?g.handle.disabled=!1:g.handle={}},disable:function(){g.handle.disabled=!0},selectAdjacent:function(){var t,e,o,i,n;t=p.isMultiple()?m.view.wt.selections.area.getCorners():m.view.wt.selections.current.getCorners(),e=u.getAll();t:for(o=t[2]+1;o<m.countRows();o++){for(n=t[1];n<=t[3];n++)if(e[o][n])break t;(e[o][t[1]-1]||e[o][t[3]+1])&&(i=o)}i&&(m.view.wt.selections.fill.clear(),m.view.wt.selections.fill.add([t[0],t[1]]),m.view.wt.selections.fill.add([i,t[3]]),g.apply())},apply:function(){var t,e,o,i,n;g.handle.isDragged=0,t=m.view.wt.selections.fill.getCorners(),t&&(m.view.wt.selections.fill.clear(),e=p.isMultiple()?m.view.wt.selections.area.getCorners():m.view.wt.selections.current.getCorners(),t[0]===e[0]&&t[1]<e[1]?(o={row:t[0],col:t[1]},i={row:t[2],col:e[1]-1}):t[0]===e[0]&&t[3]>e[3]?(o={row:t[0],col:e[3]+1},i={row:t[2],col:t[3]}):t[0]<e[0]&&t[1]===e[1]?(o={row:t[0],col:t[1]},i={row:e[0]-1,col:t[3]}):t[2]>e[2]&&t[1]===e[1]&&(o={row:e[2]+1,col:t[1]},i={row:t[2],col:t[3]}),o&&(n=SheetClip.parse(u.getText(h.selStart.coords(),h.selEnd.coords())),m.PluginHooks.run("beforeAutofill",o,i,n),d.populateFromArray(o,n,i,"autofill"),p.setRangeStart({row:t[0],col:t[1]}),p.setRangeEnd({row:t[2],col:t[3]})))},showBorder:function(t){t.row=t[0],t.col=t[1];var e=d.getCornerCoords([h.selStart.coords(),h.selEnd.coords()]);if("horizontal"!==h.settings.fillHandle&&(e.BR.row<t.row||e.TL.row>t.row))t=[t.row,e.BR.col];else{if("vertical"===h.settings.fillHandle)return;t=[e.BR.row,t.col]}m.view.wt.selections.fill.clear(),m.view.wt.selections.fill.add([h.selStart.coords().row,h.selStart.coords().col]),m.view.wt.selections.fill.add([h.selEnd.coords().row,h.selEnd.coords().col]),m.view.wt.selections.fill.add(t),m.view.render()}},this.init=function(){m.PluginHooks.run("beforeInit"),this.view=new o.TableView(this),f=new o.EditorManager(m,h,p,u),this.updateSettings(h.settings,!0),this.parseSettingsFromDOM(),this.forceFullRender=!0,this.view.render(),"object"==typeof h.firstRun&&(m.PluginHooks.run("afterChange",h.firstRun[0],h.firstRun[1]),h.firstRun=!1),m.PluginHooks.run("afterInit")},this.validateCell=function(t,e,o,i){var n=m.getCellValidator(e);"[object RegExp]"===Object.prototype.toString.call(n)&&(n=function(t){return function(e,o){o(t.test(e))}}(n)),"function"==typeof n?(t=m.PluginHooks.execute("beforeValidate",t,e.row,e.prop,i),setTimeout(function(){n.call(e,t,function(n){e.valid=n,n=m.PluginHooks.execute("afterValidate",n,t,e.row,e.prop,i),o(n)})})):(e.valid=!0,o(!0))},this.setDataAtCell=function(t,e,o,i){var n=l(t,e,o),r,c,h=[],d;for(r=0,c=n.length;c>r;r++){if("object"!=typeof n[r])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof n[r][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");d=u.colToProp(n[r][1]),h.push([n[r][0],d,u.get(n[r][0],d),n[r][2]])}i||"object"!=typeof t||(i=e),s(h,i,function(){a(h,i)})},this.setDataAtRowProp=function(t,e,o,i){var n=l(t,e,o),r,c,h=[];for(r=0,c=n.length;c>r;r++)h.push([n[r][0],n[r][1],u.get(n[r][0],n[r][1]),n[r][2]]);i||"object"!=typeof t||(i=e),s(h,i,function(){a(h,i)})},this.listen=function(){o.activeGuid=m.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){o.activeGuid=null},this.isListening=function(){return o.activeGuid===m.guid},this.destroyEditor=function(t){p.refreshBorders(t)},this.populateFromArray=function(t,e,o,i,n,r,s){if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return d.populateFromArray({row:t,col:e},o,"number"==typeof i?{row:i,col:n}:null,r,s)},this.spliceCol=function(t,e,o){return u.spliceCol.apply(u,arguments)},this.spliceRow=function(t,e,o){return u.spliceRow.apply(u,arguments)},this.getCornerCoords=function(t){return d.getCornerCoords(t)},this.getSelected=function(){return p.isSelected()?[h.selStart.row(),h.selStart.col(),h.selEnd.row(),h.selEnd.col()]:void 0},this.parseSettingsFromDOM=function(){var t=this.rootElement.css("overflow");if("scroll"===t||"auto"===t?(this.rootElement[0].style.overflow="visible",h.settingsFromDOM.overflow=t):(void 0===h.settings.width||void 0===h.settings.height)&&(h.settingsFromDOM.overflow="auto"),h.settingsFromDOM.width=void 0===h.settings.width?this.rootElement.width():void 0,h.settingsFromDOM.height=void 0,void 0===h.settings.height&&("scroll"===h.settingsFromDOM.overflow||"auto"===h.settingsFromDOM.overflow)){var o=this.rootElement[0].cloneNode(!1),i=this.rootElement[0].parentNode;if(i){o.removeAttribute("id"),i.appendChild(o);var n=parseInt(e.getComputedStyle(o,null).getPropertyValue("height"),10);isNaN(n)&&o.currentStyle&&(n=parseInt(o.currentStyle.height,10)),n>0&&(h.settingsFromDOM.height=n),i.removeChild(o)}}},this.render=function(){m.view&&(m.forceFullRender=!0,m.parseSettingsFromDOM(),p.refreshBorders(null,!0))},this.loadData=function(t){function e(){h.cellSettings.length=0}if("object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof t+" given)");t=[];for(var i,n=0,r=h.settings.startRows;r>n;n++){i=[];for(var s=0,a=h.settings.startCols;a>s;s++)i.push(null);t.push(i)}}h.isPopulated=!1,w.prototype.data=t,m.dataType=h.settings.dataSchema instanceof Array||t[0]instanceof Array?"array":"function"==typeof h.settings.dataSchema?"function":"object",u=new o.DataMap(m,h,w),e(),d.adjustRowsAndCols(),m.PluginHooks.run("afterLoadData"),h.firstRun?h.firstRun=[null,"loadData"]:(m.PluginHooks.run("afterChange",null,"loadData"),m.render()),h.isPopulated=!0},this.getData=function(t,e,o,i){return"undefined"==typeof t?u.getAll():u.getRange({row:t,col:e},{row:o,col:i},u.DESTINATION_RENDERER)},this.getCopyableData=function(t,e,o,i){return u.getCopyableText({row:t,col:e},{row:o,col:i})},this.updateSettings=function(t,e){var i,n;if("undefined"!=typeof t.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof t.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(i in t)"data"!==i&&(void 0!==m.PluginHooks.hooks[i]||void 0!==m.PluginHooks.legacy[i]?("function"==typeof t[i]||o.helper.isArray(t[i]))&&m.PluginHooks.add(i,t[i]):(!e&&t.hasOwnProperty(i)&&(w.prototype[i]=t[i]),o.extension[i]&&(h.extensions[i]=new o.extension[i](m,t[i]))));if(void 0===t.data&&void 0===h.settings.data?m.loadData(null):void 0!==t.data?m.loadData(t.data):void 0!==t.columns&&u.createMap(),n=m.countCols(),h.cellSettings.length=0,n>0){var r,s;for(i=0;n>i;i++)h.columnSettings[i]=o.helper.columnFactory(w,h.columnsSettingConflicts),r=h.columnSettings[i].prototype,w.prototype.columns&&(s=w.prototype.columns[i],o.helper.extend(r,s),o.helper.extend(r,c(s)))}"undefined"!=typeof t.fillHandle&&(g.handle&&t.fillHandle===!1?g.disable():g.handle||t.fillHandle===!1||g.init()),"undefined"!=typeof t.className&&(w.prototype.className&&m.rootElement.removeClass(w.prototype.className),t.className&&m.rootElement.addClass(t.className)),e||m.PluginHooks.run("afterUpdateSettings"),d.adjustRowsAndCols(),m.view&&!h.firstRun&&(m.forceFullRender=!0,p.refreshBorders(null,!0))},this.getValue=function(){var t=m.getSelected();if(w.prototype.getValue){if("function"==typeof w.prototype.getValue)return w.prototype.getValue.call(m);if(t)return m.getData()[t[0]][w.prototype.getValue]}else if(t)return m.getDataAtCell(t[0],t[1])},this.getSettings=function(){return h.settings},this.getSettingsFromDOM=function(){return h.settingsFromDOM},this.clear=function(){p.selectAll(),p.empty()},this.alter=function(t,e,o,i,n){d.alter(t,e,o,i,n)},this.getCell=function(t,e){return m.view.getCellAtCoords({row:t,col:e})},this.colToProp=function(t){return u.colToProp(t)},this.propToCol=function(t){return u.propToCol(t)},this.getDataAtCell=function(t,e){return u.get(t,u.colToProp(e))},this.getDataAtRowProp=function(t,e){return u.get(t,e)},this.getDataAtCol=function(t){return[].concat.apply([],u.getRange({row:0,col:t},{row:h.settings.data.length-1,col:t},u.DESTINATION_RENDERER))},this.getDataAtProp=function(t){return[].concat.apply([],u.getRange({row:0,col:u.propToCol(t)},{row:h.settings.data.length-1,col:u.propToCol(t)},u.DESTINATION_RENDERER))},this.getDataAtRow=function(t){return h.settings.data[t]},this.getCellMeta=function(t,e){function i(t){var e={row:t};return m.PluginHooks.execute("beforeGet",e),e.row}function n(t){return o.PluginHooks.execute(m,"modifyCol",t)}var r=u.colToProp(e),s;if(t=i(t),e=n(e),"undefined"==typeof h.columnSettings[e]&&(h.columnSettings[e]=o.helper.columnFactory(w,h.columnsSettingConflicts)),h.cellSettings[t]||(h.cellSettings[t]=[]),h.cellSettings[t][e]||(h.cellSettings[t][e]=new h.columnSettings[e]),s=h.cellSettings[t][e],s.row=t,s.col=e,s.prop=r,s.instance=m,m.PluginHooks.run("beforeGetCellMeta",t,e,s),o.helper.extend(s,c(s)),s.cells){var a=s.cells.call(s,t,e,r);a&&(o.helper.extend(s,a),o.helper.extend(s,c(a)))}return m.PluginHooks.run("afterGetCellMeta",t,e,s),s};var C=o.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(t,e){var i=C.call(this,t,e);return o.renderers.getRenderer(i)},this.getCellEditor=o.helper.cellMethodLookupFactory("editor"),this.getCellValidator=o.helper.cellMethodLookupFactory("validator"),this.validateCells=function(t){var e=new r;e.onQueueEmpty=t;for(var o=m.countRows()-1;o>=0;){for(var i=m.countCols()-1;i>=0;)e.addValidatorToQueue(),m.validateCell(m.getDataAtCell(o,i),m.getCellMeta(o,i),function(){e.removeValidatorFormQueue()},"validateCells"),i--;o--}e.checkIfQueueIsEmpty()},this.getRowHeader=function(t){if(void 0===t){for(var e=[],o=0,i=m.countRows();i>o;o++)e.push(m.getRowHeader(o));return e}return"[object Array]"===Object.prototype.toString.call(h.settings.rowHeaders)&&void 0!==h.settings.rowHeaders[t]?h.settings.rowHeaders[t]:"function"==typeof h.settings.rowHeaders?h.settings.rowHeaders(t):h.settings.rowHeaders&&"string"!=typeof h.settings.rowHeaders&&"number"!=typeof h.settings.rowHeaders?t+1:h.settings.rowHeaders},this.hasRowHeaders=function(){return!!h.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==h.settings.colHeaders&&null!==h.settings.colHeaders)return!!h.settings.colHeaders;for(var t=0,e=m.countCols();e>t;t++)if(m.getColHeader(t))return!0;return!1},this.getColHeader=function(t){if(void 0===t){for(var e=[],i=0,n=m.countCols();n>i;i++)e.push(m.getColHeader(i));return e}return t=o.PluginHooks.execute(m,"modifyCol",t),h.settings.columns&&h.settings.columns[t]&&h.settings.columns[t].title?h.settings.columns[t].title:"[object Array]"===Object.prototype.toString.call(h.settings.colHeaders)&&void 0!==h.settings.colHeaders[t]?h.settings.colHeaders[t]:"function"==typeof h.settings.colHeaders?h.settings.colHeaders(t):h.settings.colHeaders&&"string"!=typeof h.settings.colHeaders&&"number"!=typeof h.settings.colHeaders?o.helper.spreadsheetColumnLabel(t):h.settings.colHeaders},this._getColWidthFromSettings=function(t){var e=m.getCellMeta(0,t),o=e.width;if((void 0===o||o===h.settings.width)&&(o=e.colWidths),void 0!==o&&null!==o){switch(typeof o){case"object":o=o[t];break;case"function":o=o(t)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(t){t=o.PluginHooks.execute(m,"modifyCol",t);var e={width:m._getColWidthFromSettings(t)};return e.width||(e.width=50),m.PluginHooks.run("afterGetColWidth",t,e),e.width},this.countRows=function(){return h.settings.data.length},this.countCols=function(){return"object"===m.dataType||"function"===m.dataType?h.settings.columns&&h.settings.columns.length?h.settings.columns.length:u.colToPropCache.length:"array"===m.dataType?h.settings.columns&&h.settings.columns.length?h.settings.columns.length:h.settings.data&&h.settings.data[0]&&h.settings.data[0].length?h.settings.data[0].length:0:void 0},this.rowOffset=function(){return m.view.wt.getSetting("offsetRow")},this.colOffset=function(){return m.view.wt.getSetting("offsetColumn")},this.countVisibleRows=function(){return m.view.wt.drawn?m.view.wt.wtTable.rowStrategy.countVisible():-1},this.countVisibleCols=function(){return m.view.wt.drawn?m.view.wt.wtTable.columnStrategy.countVisible():-1},this.countEmptyRows=function(t){for(var e=m.countRows()-1,o=0;e>=0;){if(u.get(e,0),m.isEmptyRow(u.getVars.row))o++;else if(t)break;e--}return o},this.countEmptyCols=function(t){if(m.countRows()<1)return 0;for(var e=m.countCols()-1,o=0;e>=0;){if(m.isEmptyCol(e))o++;else if(t)break;e--}return o},this.isEmptyRow=function(t){return h.settings.isEmptyRow.call(m,t)},this.isEmptyCol=function(t){return h.settings.isEmptyCol.call(m,t)},this.selectCell=function(t,e,o,i,n){if("number"!=typeof t||0>t||t>=m.countRows())return!1;if("number"!=typeof e||0>e||e>=m.countCols())return!1;if("undefined"!=typeof o){if("number"!=typeof o||0>o||o>=m.countRows())return!1;if("number"!=typeof i||0>i||i>=m.countCols())return!1}return h.selStart.coords({row:t,col:e}),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),m.listen(),"undefined"==typeof o?p.setRangeEnd({row:t,col:e},n):p.setRangeEnd({row:o,col:i},n),m.selection.finish(),!0},this.selectCellByProp=function(t,e,o,i,n){return arguments[1]=u.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=u.propToCol(arguments[3])),m.selectCell.apply(m,arguments)},this.deselectCell=function(){p.deselect()},this.destroy=function(){m.clearTimeouts(),m.view&&m.view.wt.destroy(),m.rootElement.empty(),m.rootElement.removeData("handsontable"),m.rootElement.off(".handsontable"),t(e).off("."+m.guid),y.off("."+m.guid),v.off("."+m.guid),m.PluginHooks.run("afterDestroy")},this.getActiveEditor=function(){return f.getActiveEditor()},this.getInstance=function(){return m.rootElement.data("handsontable")},function(){m.PluginHooks=new o.PluginHookClass;var t=m.PluginHooks.run,e=m.PluginHooks.execute;m.PluginHooks.run=function(e,i,n,r,s,a){t.call(this,m,e,i,n,r,s,a),o.PluginHooks.run(m,e,i,n,r,s,a)},m.PluginHooks.execute=function(t,i,n,r,s,a){var l=o.PluginHooks.execute(m,t,i,n,r,s,a),c=e.call(this,m,t,l,n,r,s,a);return"undefined"==typeof c?l:c},m.addHook=function(){m.PluginHooks.add.apply(m.PluginHooks,arguments)},m.addHookOnce=function(){m.PluginHooks.once.apply(m.PluginHooks,arguments)},m.removeHook=function(){m.PluginHooks.remove.apply(m.PluginHooks,arguments)},m.runHooks=function(){m.PluginHooks.run.apply(m.PluginHooks,arguments)},m.runHooksAndReturn=function(){return m.PluginHooks.execute.apply(m.PluginHooks,arguments)}}(),this.timeouts={},this.registerTimeout=function(t,e,o){clearTimeout(this.timeouts[t]),this.timeouts[t]=setTimeout(e,o||0)},this.clearTimeouts=function(){for(var t in this.timeouts)this.timeouts.hasOwnProperty(t)&&clearTimeout(this.timeouts[t])},this.version="0.10.3"};var V=function(){};V.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:function(t){for(var e,o=0,i=this.countCols();i>o;o++)if(e=this.getDataAtCell(t,o),""!==e&&null!==e&&"undefined"!=typeof e)return!1;return!0},isEmptyCol:function(t){for(var e,o=0,i=this.countRows();i>o;o++)if(e=this.getDataAtCell(o,t),""!==e&&null!==e&&"undefined"!=typeof e)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",fragmentSelection:!1,readOnly:!1,nativeScrollbars:!1,type:"text",copyable:!0,debug:!1},o.DefaultSettings=V,t.fn.handsontable=function(t){var e,i,n,r,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof t)return s=t||{},l?l.updateSettings(s):(l=new o.Core(a,s),a.data("handsontable",l),l.init()),a;if(n=[],arguments.length>1)for(e=1,i=arguments.length;i>e;e++)n.push(arguments[e]);if(l){if("undefined"==typeof l[t])throw new Error("Handsontable do not provide action: "+t);r=l[t].apply(l,n)}return r},o.TableView=function(i){var n=this,r=t(e),s=t(document.documentElement);this.instance=i,this.settings=i.getSettings(),this.settingsFromDOM=i.getSettingsFromDOM(),i.rootElement.data("originalStyle",i.rootElement[0].getAttribute("style")),i.rootElement.addClass("handsontable");var a=document.createElement("TABLE");a.className="htCore",this.THEAD=document.createElement("THEAD"),a.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),a.appendChild(this.TBODY),i.$table=t(a),i.rootElement.prepend(i.$table),i.rootElement.on("mousedown.handsontable",function(t){n.isTextSelectionAllowed(t.target)||(c(),t.preventDefault(),e.focus())}),s.on("keyup."+i.guid,function(t){i.selection.isInProgress()&&!t.shiftKey&&i.selection.finish()});var l;s.on("mouseup."+i.guid,function(t){i.selection.isInProgress()&&1===t.which&&i.selection.finish(),l=!1,i.autofill.handle&&i.autofill.handle.isDragged&&(i.autofill.handle.isDragged>1&&i.autofill.apply(),i.autofill.handle.isDragged=0),o.helper.isOutsideInput(document.activeElement)&&i.unlisten()}),s.on("mousedown."+i.guid,function(t){var e=t.target;if(e!==n.wt.wtTable.spreader)for(;e!==document.documentElement;){if(null===e)return;if(e===i.rootElement[0]||"HANDSONTABLE-TABLE"===e.nodeName)return;e=e.parentNode}n.settings.outsideClickDeselects?i.deselectCell():i.destroyEditor()}),i.rootElement.on("mousedown.handsontable",".dragdealer",function(){i.destroyEditor()}),i.$table.on("selectstart",function(t){n.settings.fragmentSelection||t.preventDefault()});var c=function(){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():document.selection&&document.selection.empty()},h={debug:function(){return n.settings.debug},table:a,stretchH:this.settings.stretchH,data:i.getDataAtCell,totalRows:i.countRows,totalColumns:i.countCols,nativeScrollbars:this.settings.nativeScrollbars,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},rowHeaders:function(){return i.hasRowHeaders()?[function(t,e){n.appendRowHeader(t,e)}]:[]},columnHeaders:function(){return i.hasColHeaders()?[function(t,e){n.appendColHeader(t,e)}]:[]},columnWidth:i.getColWidth,cellRenderer:function(t,e,o){var i=n.instance.colToProp(e),r=n.instance.getCellMeta(t,e),s=n.instance.getCellRenderer(r),a=n.instance.getDataAtRowProp(t,i);s(n.instance,o,t,e,i,a,r),n.instance.PluginHooks.run("afterRenderer",o,t,e,i,a,r)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!i.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&i.selection.isMultiple()}}},highlight:{highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(t,e,o){i.listen(),l=!0;var n={row:e[0],col:e[1]};2===t.button&&i.selection.inInSelection(n)||(t.shiftKey?i.selection.setRangeEnd(n):i.selection.setRangeStart(n)),i.PluginHooks.run("afterOnCellMouseDown",t,e,o)},onCellMouseOver:function(t,e,o){var n={row:e[0],col:e[1]};l?i.selection.setRangeEnd(n):i.autofill.handle&&i.autofill.handle.isDragged&&(i.autofill.handle.isDragged++,i.autofill.showBorder(e)),i.PluginHooks.run("afterOnCellMouseOver",t,e,o)},onCellCornerMouseDown:function(t){i.autofill.handle.isDragged=1,t.preventDefault(),i.PluginHooks.run("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(){i.autofill.selectAdjacent()},beforeDraw:function(t){n.beforeRender(t)},onDraw:function(t){n.onDraw(t)},onScrollVertically:function(){i.runHooks("afterScrollVertically")},onScrollHorizontally:function(){i.runHooks("afterScrollHorizontally")}};i.PluginHooks.run("beforeInitWalkontable",h),this.wt=new m(h),r.on("resize."+i.guid,function(){i.registerTimeout("resizeTimeout",function(){i.parseSettingsFromDOM();var t=n.getWidth(),e=n.getHeight();(h.width!==t||h.height!==e)&&(i.forceFullRender=!0,n.render(),h.width=t,h.height=e)},60)}),t(n.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(t){t.target===n.wt.wtTable.spreader&&3===t.which&&t.stopPropagation()}),s.on("click."+i.guid,function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})},o.TableView.prototype.isTextSelectionAllowed=function(t){return o.helper.isInput(t)?!0:this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(t,this.TBODY)?!0:!1},o.TableView.prototype.isCellEdited=function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()},o.TableView.prototype.getWidth=function(){var t=void 0!==this.settings.width?this.settings.width:this.settingsFromDOM.width;return"function"==typeof t?t():t},o.TableView.prototype.getHeight=function(){var t=void 0!==this.settings.height?this.settings.height:this.settingsFromDOM.height;return"function"==typeof t?t():t},o.TableView.prototype.beforeRender=function(t){t&&(this.instance.PluginHooks.run("beforeRender",this.instance.forceFullRender),this.wt.update("width",this.getWidth()),this.wt.update("height",this.getHeight()))},o.TableView.prototype.onDraw=function(t){t&&this.instance.PluginHooks.run("afterRender",this.instance.forceFullRender)},o.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.rootElement.triggerHandler("render.handsontable")},o.TableView.prototype.getCellAtCoords=function(t){var e=this.wt.wtTable.getCell([t.row,t.col]);return 0>e?null:e},o.TableView.prototype.scrollViewport=function(t){this.wt.scrollViewport([t.row,t.col])},o.TableView.prototype.appendRowHeader=function(t,e){if(t>-1)this.wt.wtDom.fastInnerHTML(e,this.instance.getRowHeader(t));else{var o=document.createElement("DIV");o.className="relative",this.wt.wtDom.fastInnerText(o," "),this.wt.wtDom.empty(e),e.appendChild(o)}},o.TableView.prototype.appendColHeader=function(t,e){var o=document.createElement("DIV"),i=document.createElement("SPAN");o.className="relative",i.className="colHeader",this.wt.wtDom.fastInnerHTML(i,this.instance.getColHeader(t)),o.appendChild(i),this.wt.wtDom.empty(e),e.appendChild(o),this.instance.PluginHooks.run("afterGetColHeader",t,e)},o.TableView.prototype.maximumVisibleElementWidth=function(t){var e=this.wt.wtViewport.getWorkspaceWidth();return this.settings.nativeScrollbars?e:e-t},o.TableView.prototype.maximumVisibleElementHeight=function(t){var e=this.wt.wtViewport.getWorkspaceHeight();return this.settings.nativeScrollbars?e:e-t},function(t){function e(t){var e,o;o={},e=t,this.getInstance=function(t){return t.guid in o||(o[t.guid]=new e(t)),o[t.guid]}}var o={},i=new WeakMap;t.editors={registerEditor:function(t,n){var r=new e(n);"string"==typeof t&&(o[t]=r),i.set(n,r)},getEditor:function(t,e){var n;if("function"==typeof t)i.get(t)||this.registerEditor(null,t),n=i.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter ');n=o[t]}if(!n)throw Error('No editor registered under name "'+t+'"');return n.getInstance(e)}}}(o),function(e){e.EditorManager=function(o,i,n){var r=this,s=t(document),a=e.helper.keyCode,l,c=function(){function t(t){if(o.isListening()&&(i.settings.beforeOnKeyDown&&i.settings.beforeOnKeyDown.call(o,t),o.PluginHooks.run("beforeKeyDown",t),!t.isImmediatePropagationStopped()&&(i.lastKeyCode=t.keyCode,n.isSelected()))){var s=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!l.isWaiting()&&!e.helper.isMetaKey(t.keyCode)&&!s)return r.openEditor(""),void t.stopPropagation();var c=t.shiftKey?n.setRangeEnd:n.setRangeStart;switch(t.keyCode){case a.A:if(s){n.selectAll(),t.preventDefault(),t.stopPropagation();break}case a.ARROW_UP:r.isEditorOpened()&&!l.isWaiting()&&r.closeEditorAndSaveChanges(s),u(t.shiftKey),t.preventDefault(),t.stopPropagation();break;case a.ARROW_DOWN:r.isEditorOpened()&&!l.isWaiting()&&r.closeEditorAndSaveChanges(s),d(t.shiftKey),t.preventDefault(),t.stopPropagation();break;case a.ARROW_RIGHT:r.isEditorOpened()&&!l.isWaiting()&&r.closeEditorAndSaveChanges(s),p(t.shiftKey),t.preventDefault(),t.stopPropagation();break;case a.ARROW_LEFT:r.isEditorOpened()&&!l.isWaiting()&&r.closeEditorAndSaveChanges(s),f(t.shiftKey),t.preventDefault(),t.stopPropagation();break;case a.TAB:var g="function"==typeof i.settings.tabMoves?i.settings.tabMoves(t):i.settings.tabMoves;t.shiftKey?n.transformStart(-g.row,-g.col):n.transformStart(g.row,g.col,!0),t.preventDefault(),t.stopPropagation();break;case a.BACKSPACE:case a.DELETE:n.empty(t),r.prepareEditor(),t.preventDefault();break;case a.F2:r.openEditor(),t.preventDefault();break;case a.ENTER:r.isEditorOpened()?(l.state!==e.EditorState.WAITING&&r.closeEditorAndSaveChanges(s),h(t.shiftKey)):o.getSettings().enterBeginsEditing?r.openEditor():h(t.shiftKey),t.preventDefault(),t.stopImmediatePropagation();break;case a.ESCAPE:r.isEditorOpened()&&r.closeEditorAndRestoreOriginalValue(s),t.preventDefault();break;case a.HOME:c(t.ctrlKey||t.metaKey?{row:0,col:i.selStart.col()}:{row:i.selStart.row(),col:0}),t.preventDefault(),t.stopPropagation();break;case a.END:c(t.ctrlKey||t.metaKey?{row:o.countRows()-1,col:i.selStart.col()}:{row:i.selStart.row(),col:o.countCols()-1}),t.preventDefault(),t.stopPropagation();break;case a.PAGE_UP:n.transformStart(-o.countVisibleRows(),0),o.view.wt.scrollVertical(-o.countVisibleRows()),o.view.render(),t.preventDefault(),t.stopPropagation();break;case a.PAGE_DOWN:n.transformStart(o.countVisibleRows(),0),o.view.wt.scrollVertical(o.countVisibleRows()),o.view.render(),t.preventDefault(),t.stopPropagation()}}}function c(){r.openEditor()}function h(t){var e="function"==typeof i.settings.enterMoves?i.settings.enterMoves(event):i.settings.enterMoves;t?n.transformStart(-e.row,-e.col):n.transformStart(e.row,e.col,!0)}function u(t){t?n.transformEnd(-1,0):n.transformStart(-1,0)}function d(t){t?n.transformEnd(1,0):n.transformStart(1,0)}function p(t){t?n.transformEnd(0,1):n.transformStart(0,1)}function f(t){t?n.transformEnd(0,-1):n.transformStart(0,-1)}s.on("keydown.handsontable."+o.guid,t),o.view.wt.update("onCellDblClick",c),o.addHook("afterDestroy",function(){s.off("keydown.handsontable."+o.guid)})};this.destroyEditor=function(t){this.closeEditor(t)},this.getActiveEditor=function(){return l},this.prepareEditor=function(){if(l&&l.isWaiting())return void this.closeEditor(!1,!1,function(t){t&&r.prepareEditor()});var t=i.selStart.row(),n=i.selStart.col(),s=o.colToProp(n),a=o.getCell(t,n),c=o.getDataAtCell(t,n),h=o.getCellMeta(t,n),u=o.getCellEditor(h);l=e.editors.getEditor(u,o),l.prepare(t,n,s,a,c,h)},this.isEditorOpened=function(){return l.isOpened()},this.openEditor=function(t){l.beginEditing(t)},this.closeEditor=function(t,e,o){l?l.finishEditing(t,e,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(t){return this.closeEditor(!1,t)},this.closeEditorAndRestoreOriginalValue=function(t){return this.closeEditor(!0,t)},c()}}(o),function(t){var e={};t.renderers={registerRenderer:function(t,o){e[t]=o},getRenderer:function(t){if("function"==typeof t)return t;if("string"!=typeof t)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(t in e))throw Error('No editor registered under name "'+t+'"');return e[t]}}}(o),o.Dom=new y,o.helper.isPrintableChar=function(t){return 32==t||t>=48&&57>=t||t>=96&&111>=t||t>=186&&192>=t||t>=219&&222>=t||t>=226||t>=65&&90>=t},o.helper.isMetaKey=function(t){var e=o.helper.keyCode,i=[e.ARROW_DOWN,e.ARROW_UP,e.ARROW_LEFT,e.ARROW_RIGHT,e.HOME,e.END,e.DELETE,e.BACKSPACE,e.F1,e.F2,e.F3,e.F4,e.F5,e.F6,e.F7,e.F8,e.F9,e.F10,e.F11,e.F12,e.TAB,e.PAGE_DOWN,e.PAGE_UP,e.ENTER,e.ESCAPE,e.SHIFT,e.CAPS_LOCK,e.ALT];return-1!=i.indexOf(t)},o.helper.isCtrlKey=function(t){var e=o.helper.keyCode;return-1!=[e.CONTROL_LEFT,224,e.COMMAND_LEFT,e.COMMAND_RIGHT].indexOf(t)},o.helper.stringify=function(t){switch(typeof t){case"string":case"number":return t+"";break;case"object":return null===t?"":t.toString();break;case"undefined":return"";break;default:return t.toString()}},o.helper.spreadsheetColumnLabel=function(t){for(var e=t+1,o="",i;e>0;)i=(e-1)%26,o=String.fromCharCode(65+i)+o,e=parseInt((e-i)/26,10);return o},o.helper.isNumeric=function(t){var e=typeof t;return"number"==e?!isNaN(t)&&isFinite(t):"string"==e?t.length?1==t.length?/\d/.test(t):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(t):!1:"object"==e?!(!t||"number"!=typeof t.valueOf()||t instanceof Date):!1},o.helper.isArray=function(t){return null!==Object.prototype.toString.call(t).match(/array/i)},o.helper.isDescendant=function(t,e){for(var o=e.parentNode;null!=o;){if(o==t)return!0;o=o.parentNode}return!1},o.helper.randomString=function(){return b()},o.helper.inherit=function(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t},o.helper.extend=function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},o.helper.getPrototypeOf=function(t){var e;if("object"==typeof t.__proto__)e=t.__proto__;else{var o,i=t.constructor;"function"==typeof t.constructor&&(o=i,delete t.constructor&&(i=t.constructor,t.constructor=o)),e=i?i.prototype:null}return e},o.helper.columnFactory=function(t,e){function i(){}o.helper.inherit(i,t);for(var n=0,r=e.length;r>n;n++)i.prototype[e[n]]=void 0;return i},o.helper.translateRowsToColumns=function(t){var e,o,i,n,r=[],s=0;for(e=0,o=t.length;o>e;e++)for(i=0,n=t[e].length;n>i;i++)i==s&&(r.push([]),s++),r[i].push(t[e][i]);return r},o.helper.to2dArray=function(t){for(var e=0,o=t.length;o>e;)t[e]=[t[e]],e++},o.helper.extendArray=function(t,e){for(var o=0,i=e.length;i>o;)t.push(e[o]),o++},o.helper.isInput=function(t){var e=["INPUT","SELECT","TEXTAREA"];return e.indexOf(t.nodeName)>-1},o.helper.isOutsideInput=function(t){return o.helper.isInput(t)&&-1==t.className.indexOf("handsontableInput")},o.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},o.helper.isObject=function(t){return"[object Object]"==Object.prototype.toString.call(t)},o.helper.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"==Object.prototype.toString.call(t)},o.helper.pivot=function(t){var e=[];if(!t||0==t.length||!t[0]||0==t[0].length)return e;for(var o=t.length,i=t[0].length,n=0;o>n;n++)for(var r=0;i>r;r++)e[r]||(e[r]=[]),e[r][n]=t[n][r];return e},o.helper.proxy=function(t,e){return function(){return t.apply(e,arguments)}},o.helper.cellMethodLookupFactory=function(t,e){function i(t){var e=o.cellTypes[t];if("undefined"==typeof e)throw new Error('You declared cell type "'+t+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return e}return e="undefined"==typeof e?!0:e,function n(r,s){return function a(n){if(n){if(n.hasOwnProperty(t)&&n[t])return n[t];
if(n.hasOwnProperty("type")&&n.type){var r;if("string"!=typeof n.type)throw new Error("Cell type must be a string ");if(r=i(n.type),r.hasOwnProperty(t))return r[t];if(e)return}return a(o.helper.getPrototypeOf(n))}}("number"==typeof r?this.getCellMeta(r,s):r)}},o.SelectionPoint=function(){this._row=null,this._col=null},o.SelectionPoint.prototype.exists=function(){return null!==this._row},o.SelectionPoint.prototype.row=function(t){return void 0!==t&&(this._row=t),this._row},o.SelectionPoint.prototype.col=function(t){return void 0!==t&&(this._col=t),this._col},o.SelectionPoint.prototype.coords=function(t){return void 0!==t&&(this._row=t.row,this._col=t.col),{row:this._row,col:this._col}},o.SelectionPoint.prototype.arr=function(t){return void 0!==t&&(this._row=t[0],this._col=t[1]),[this._row,this._col]},function(e){e.DataMap=function(t,e,o){this.instance=t,this.priv=e,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{},this.createMap(),this.getVars={},this.setVars={}},e.DataMap.prototype.DESTINATION_RENDERER=1,e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,e.DataMap.prototype.recursiveDuckSchema=function(e){var o;if(t.isPlainObject(e)){o={};for(var i in e)e.hasOwnProperty(i)&&(o[i]=t.isPlainObject(e[i])?this.recursiveDuckSchema(e[i]):null)}else o=[];return o},e.DataMap.prototype.recursiveDuckColumns=function(e,o,i){var n,r;if("undefined"==typeof o&&(o=0,i=""),t.isPlainObject(e))for(r in e)e.hasOwnProperty(r)&&(null===e[r]?(n=i+r,this.colToPropCache.push(n),this.propToColCache[n]=o,o++):o=this.recursiveDuckColumns(e[r],o,r+"."));return o},e.DataMap.prototype.createMap=function(){if("undefined"==typeof this.getSchema())throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var t,e,o=this.getSchema();this.colToPropCache=[],this.propToColCache={};var i=this.instance.getSettings().columns;if(i)for(t=0,e=i.length;e>t;t++)this.colToPropCache[t]=i[t].data,this.propToColCache[i[t].data]=t;else this.recursiveDuckColumns(o)},e.DataMap.prototype.colToProp=function(t){return t=e.PluginHooks.execute(this.instance,"modifyCol",t),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[t]?this.colToPropCache[t]:t},e.DataMap.prototype.propToCol=function(t){var o;return o="undefined"!=typeof this.propToColCache[t]?this.propToColCache[t]:t,o=e.PluginHooks.execute(this.instance,"modifyCol",o)},e.DataMap.prototype.getSchema=function(){var t=this.instance.getSettings().dataSchema;return t?"function"==typeof t?t():t:this.duckSchema},e.DataMap.prototype.createRow=function(e,o,i){var n,r=this.instance.countCols(),s=0,a;o||(o=1),("number"!=typeof e||e>=this.instance.countRows())&&(e=this.instance.countRows()),a=e;for(var l=this.instance.getSettings().maxRows;o>s&&this.instance.countRows()<l;){if("array"===this.instance.dataType){n=[];for(var c=0;r>c;c++)n.push(null)}else n="function"===this.instance.dataType?this.instance.getSettings().dataSchema(e):t.extend(!0,{},this.getSchema());e===this.instance.countRows()?this.dataSource.push(n):this.dataSource.splice(e,0,n),s++,a++}return this.instance.PluginHooks.run("afterCreateRow",e,s,i),this.instance.forceFullRender=!0,s},e.DataMap.prototype.createCol=function(t,o,i){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var n=this.instance.countRows(),r=this.dataSource,s,a=0,l;o||(o=1),l=t;for(var c=this.instance.getSettings().maxCols;o>a&&this.instance.countCols()<c;){if(s=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){for(var h=0;n>h;h++)"undefined"==typeof r[h]&&(r[h]=[]),r[h].push(null);this.priv.columnSettings.push(s)}else{for(var h=0;n>h;h++)r[h].splice(l,0,null);this.priv.columnSettings.splice(l,0,s)}a++,l++}return this.instance.PluginHooks.run("afterCreateCol",t,a,i),this.instance.forceFullRender=!0,a},e.DataMap.prototype.removeRow=function(t,e){e||(e=1),"number"!=typeof t&&(t=-e),t=(this.instance.countRows()+t)%this.instance.countRows();var o=this.physicalRowsToLogical(t,e),i=this.instance.PluginHooks.execute("beforeRemoveRow",t,e);if(i!==!1){var n=this.dataSource,r=n.filter(function(t,e){return-1==o.indexOf(e)});n.length=0,Array.prototype.push.apply(n,r),this.instance.PluginHooks.run("afterRemoveRow",t,e),this.instance.forceFullRender=!0}},e.DataMap.prototype.removeCol=function(t,e){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");e||(e=1),"number"!=typeof t&&(t=-e),t=(this.instance.countCols()+t)%this.instance.countCols();var o=this.instance.PluginHooks.execute("beforeRemoveCol",t,e);if(o!==!1){for(var i=this.dataSource,n=0,r=this.instance.countRows();r>n;n++)i[n].splice(t,e);this.priv.columnSettings.splice(t,e),this.instance.PluginHooks.run("afterRemoveCol",t,e),this.instance.forceFullRender=!0}},e.DataMap.prototype.spliceCol=function(t,o,i){var n=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(t),s=r.slice(o,o+i),a=r.slice(o+i);e.helper.extendArray(n,a);for(var l=0;i>l;)n.push(null),l++;return e.helper.to2dArray(n),this.instance.populateFromArray(o,t,n,null,null,"spliceCol"),s},e.DataMap.prototype.spliceRow=function(t,o,i){var n=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtRow(t),s=r.slice(o,o+i),a=r.slice(o+i);e.helper.extendArray(n,a);for(var l=0;i>l;)n.push(null),l++;return this.instance.populateFromArray(t,o,[n],null,null,"spliceRow"),s},e.DataMap.prototype.get=function(t,e){if(this.getVars.row=t,this.getVars.prop=e,this.instance.PluginHooks.run("beforeGet",this.getVars),"string"==typeof this.getVars.prop&&this.getVars.prop.indexOf(".")>-1){var o=this.getVars.prop.split("."),i=this.dataSource[this.getVars.row];if(!i)return null;for(var n=0,r=o.length;r>n;n++)if(i=i[o[n]],"undefined"==typeof i)return null;return i}return"function"==typeof this.getVars.prop?this.getVars.prop(this.dataSource.slice(this.getVars.row,this.getVars.row+1)[0]):this.dataSource[this.getVars.row]?this.dataSource[this.getVars.row][this.getVars.prop]:null};var o=e.helper.cellMethodLookupFactory("copyable",!1);e.DataMap.prototype.getCopyable=function(t,e){return o.call(this.instance,t,this.propToCol(e))?this.get(t,e):""},e.DataMap.prototype.set=function(t,e,o,i){if(this.setVars.row=t,this.setVars.prop=e,this.setVars.value=o,this.instance.PluginHooks.run("beforeSet",this.setVars,i||"datamapGet"),"string"==typeof this.setVars.prop&&this.setVars.prop.indexOf(".")>-1){for(var n=this.setVars.prop.split("."),r=this.dataSource[this.setVars.row],s=0,a=n.length-1;a>s;s++)r=r[n[s]];r[n[s]]=this.setVars.value}else"function"==typeof this.setVars.prop?this.setVars.prop(this.dataSource.slice(this.setVars.row,this.setVars.row+1)[0],this.setVars.value):this.dataSource[this.setVars.row][this.setVars.prop]=this.setVars.value},e.DataMap.prototype.physicalRowsToLogical=function(t,e){for(var o=this.instance.countRows(),i=(o+t)%o,n=[],r=e;o>i&&r;)this.get(i,0),n.push(this.getVars.row),r--,i++;return n},e.DataMap.prototype.clear=function(){for(var t=0;t<this.instance.countRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")},e.DataMap.prototype.getAll=function(){return this.dataSource},e.DataMap.prototype.getRange=function(t,e,o){var i,n,r,s,a=[],l,c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(n=Math.max(t.row,e.row),s=Math.max(t.col,e.col),i=Math.min(t.row,e.row);n>=i;i++){for(l=[],r=Math.min(t.col,e.col);s>=r;r++)l.push(c.call(this,i,this.colToProp(r)));a.push(l)}return a},e.DataMap.prototype.getText=function(t,e){return SheetClip.stringify(this.getRange(t,e,this.DESTINATION_RENDERER))},e.DataMap.prototype.getCopyableText=function(t,e){return SheetClip.stringify(this.getRange(t,e,this.DESTINATION_CLIPBOARD_GENERATOR))}}(o),function(t){t.renderers.cellDecorator=function(t,e,o,i,n,r,s){s.readOnly&&t.view.wt.wtDom.addClass(e,s.readOnlyCellClassName),s.valid===!1&&s.invalidCellClassName&&t.view.wt.wtDom.addClass(e,s.invalidCellClassName),!r&&s.placeholder&&t.view.wt.wtDom.addClass(e,s.placeholderCellClassName)}}(o),function(t){var e=function(e,o,i,n,r,s,a){t.renderers.cellDecorator.apply(this,arguments),!s&&a.placeholder&&(s=a.placeholder);var l=t.helper.stringify(s);if(a.rendererTemplate){e.view.wt.wtDom.empty(o);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=e.getDataAtRow(i),o.appendChild(c)}else e.view.wt.wtDom.fastInnerText(o,l)};t.renderers.TextRenderer=e,t.renderers.registerRenderer("text",e)}(o),function(t){var e=document.createElement("DIV");e.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode("▼"));var i=function(e,o){o.innerHTML=e.innerHTML,t.Dom.empty(e),e.appendChild(o)},n=function(i,n,r,s,a,l,c){var h=e.cloneNode(!0),u=o.cloneNode(!0);t.renderers.TextRenderer(i,n,r,s,a,l,c),n.appendChild(u),t.Dom.addClass(n,"htAutocomplete"),n.firstChild||n.appendChild(document.createTextNode(" ")),i.acArrowListener||(i.acArrowListener=function(){i.view.wt.getSetting("onCellDblClick")},i.rootElement.on("mousedown",".htAutocompleteArrow",i.acArrowListener))};t.AutocompleteRenderer=n,t.renderers.AutocompleteRenderer=n,t.renderers.registerRenderer("autocomplete",n)}(o),function(e){var o=document.createElement("INPUT");o.className="htCheckboxRendererInput",o.type="checkbox",o.setAttribute("autocomplete","off");var i=function(i,n,r,s,a,l,c){"undefined"==typeof c.checkedTemplate&&(c.checkedTemplate=!0),"undefined"==typeof c.uncheckedTemplate&&(c.uncheckedTemplate=!1),i.view.wt.wtDom.empty(n);var h=o.cloneNode(!1);l===c.checkedTemplate||l===e.helper.stringify(c.checkedTemplate)?(h.checked=!0,n.appendChild(h)):l===c.uncheckedTemplate||l===e.helper.stringify(c.uncheckedTemplate)?n.appendChild(h):null===l?(h.className+=" noValue",n.appendChild(h)):i.view.wt.wtDom.fastInnerText(n,"#bad value#");var u=t(h);c.readOnly?u.on("click",function(t){t.preventDefault()}):(u.on("mousedown",function(t){t.stopPropagation()}),u.on("mouseup",function(t){t.stopPropagation()}),u.on("change",function(){this.checked?i.setDataAtRowProp(r,a,c.checkedTemplate):i.setDataAtRowProp(r,a,c.uncheckedTemplate)})),i.CheckboxRenderer&&i.CheckboxRenderer.beforeKeyDownHookBound||(i.CheckboxRenderer={beforeKeyDownHookBound:!0},i.addHook("beforeKeyDown",function(o){if(o.keyCode==e.helper.keyCode.SPACE)for(var n=i.getSelected(),r,s,a,l={row:Math.min(n[0],n[2]),col:Math.min(n[1],n[3])},c={row:Math.max(n[0],n[2]),col:Math.max(n[1],n[3])},h=l.row;h<=c.row;h++)for(var u=c.col;u<=c.col;u++)if(r=i.getCell(h,u),a=i.getCellMeta(h,u),s=r.querySelectorAll("input[type=checkbox]"),s.length>0&&!a.readOnly){o.isImmediatePropagationStopped()||(o.stopImmediatePropagation(),o.preventDefault());for(var d=0,p=s.length;p>d;d++)s[d].checked=!s[d].checked,t(s[d]).trigger("change")}}))};e.CheckboxRenderer=i,e.renderers.CheckboxRenderer=i,e.renderers.registerRenderer("checkbox",i)}(o),function(t){var e=function(e,o,i,n,r,s,a){t.helper.isNumeric(s)&&("undefined"!=typeof a.language&&numeral.language(a.language),s=numeral(s).format(a.format||"0"),e.view.wt.wtDom.addClass(o,"htNumeric")),t.renderers.TextRenderer(e,o,i,n,r,s,a)};t.NumericRenderer=e,t.renderers.NumericRenderer=e,t.renderers.registerRenderer("numeric",e)}(o),function(t){var e=function(t,e,i,n,r,s,a){o.renderers.TextRenderer.apply(this,arguments),s=e.innerHTML;var l,c=a.hashLength||s.length,h=a.hashSymbol||"*";for(l="";l.split(h).length-1<c;l+=h);t.view.wt.wtDom.fastInnerHTML(e,l)};t.PasswordRenderer=e,t.renderers.PasswordRenderer=e,t.renderers.registerRenderer("password",e)}(o),function(t){function e(e,o,i,n,r,s,a){t.renderers.cellDecorator.apply(this,arguments),t.Dom.fastInnerHTML(o,s)}t.renderers.registerRenderer("html",e),t.renderers.HtmlRenderer=e}(o),function(t){function e(e){this.instance=e,this.state=t.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}t.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},e.prototype._fireCallbacks=function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)},e.prototype.init=function(){},e.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},e.prototype.setValue=function(t){throw Error("Editor setValue() method unimplemented")},e.prototype.open=function(){throw Error("Editor open() method unimplemented")},e.prototype.close=function(){throw Error("Editor close() method unimplemented")},e.prototype.prepare=function(e,o,i,n,r,s){this.TD=n,this.row=e,this.col=o,this.prop=i,this.originalValue=r,this.cellProperties=s,this.state=t.EditorState.VIRGIN},e.prototype.extend=function(){function t(){o.apply(this,arguments)}function e(t,e){function o(){}return o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t,t}var o=this.constructor;return e(t,o)},e.prototype.saveValue=function(t,e){if(e){var o=this.instance.getSelected();this.instance.populateFromArray(o[0],o[1],t,o[2],o[3],"edit")}else this.instance.populateFromArray(this.row,this.col,t,null,null,"edit")},e.prototype.beginEditing=function(e){this.state==t.EditorState.VIRGIN&&(this.cellProperties.readOnly||(this.instance.view.scrollViewport({row:this.row,col:this.col}),this.instance.view.render(),this.state=t.EditorState.EDITING,e="string"==typeof e?e:this.originalValue,this.setValue(t.helper.stringify(e)),this.open(),this._opened=!0,this.focus(),this.instance.view.render()))},e.prototype.finishEditing=function(e,o,i){if(i){var n=this._closeCallback;this._closeCallback=function(t){n&&n(t),i(t)}}if(!this.isWaiting()){if(this.state==t.EditorState.VIRGIN){var r=this;return void setTimeout(function(){r._fireCallbacks(!0)})}if(this.state==t.EditorState.EDITING){if(e)return void this.cancelChanges();var s=[[String.prototype.trim.call(this.getValue())]];if(this.state=t.EditorState.WAITING,this.saveValue(s,o),this.instance.getCellValidator(this.cellProperties)){var r=this;this.instance.addHookOnce("afterValidate",function(e){r.state=t.EditorState.FINISHED,r.discardEditor(e)})}else this.state=t.EditorState.FINISHED,this.discardEditor(!0)}}},e.prototype.cancelChanges=function(){this.state=t.EditorState.FINISHED,this.discardEditor()},e.prototype.discardEditor=function(e){this.state===t.EditorState.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=t.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=t.EditorState.VIRGIN,this._fireCallbacks(!0)))},e.prototype.isOpened=function(){return this._opened},e.prototype.isWaiting=function(){return this.state===t.EditorState.WAITING},t.editors.BaseEditor=e}(o),function(e){var o=e.editors.BaseEditor.prototype.extend();o.prototype.init=function(){this.createElements(),this.bindEvents()},o.prototype.getValue=function(){return this.TEXTAREA.value},o.prototype.setValue=function(t){this.TEXTAREA.value=t};var i=function n(t){var o=this,i=o.getActiveEditor(),n=e.helper.keyCode,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target===i.TEXTAREA&&!t.isImmediatePropagationStopped()){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void t.stopImmediatePropagation();switch(t.keyCode){case n.ARROW_RIGHT:i.wtDom.getCaretPosition(i.TEXTAREA)!==i.TEXTAREA.value.length&&t.stopImmediatePropagation();break;case n.ARROW_LEFT:0!==i.wtDom.getCaretPosition(i.TEXTAREA)&&t.stopImmediatePropagation();break;case n.ENTER:var s=i.instance.getSelected(),a=!(s[0]===s[2]&&s[1]===s[3]);(r&&!a||t.altKey)&&(i.isOpened()?(i.setValue(i.getValue()+"\n"),i.focus()):i.beginEditing(i.originalValue+"\n"),t.stopImmediatePropagation()),t.preventDefault();break;case n.A:case n.X:case n.C:case n.V:if(r){t.stopImmediatePropagation();break}case n.BACKSPACE:case n.DELETE:case n.HOME:case n.END:t.stopImmediatePropagation()}}};o.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",i)},o.prototype.close=function(){this.textareaParentStyle.display="none",document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",i)},o.prototype.focus=function(){this.TEXTAREA.focus(),this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},o.prototype.createElements=function(){this.$body=t(document.body),this.wtDom=new y,this.TEXTAREA=document.createElement("TEXTAREA"),this.$textarea=t(this.TEXTAREA),this.wtDom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),this.wtDom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var o=this;e.PluginHooks.add("afterRender",function(){o.instance.registerTimeout("refresh_editor_dimensions",function(){o.refreshDimensions()},0)})},o.prototype.refreshDimensions=function(){if(this.state===e.EditorState.EDITING&&(this.TD=this.instance.getCell(this.row,this.col),this.TD)){var o=t(this.TD),i=this.wtDom.offset(this.TD),n=this.wtDom.offset(this.instance.rootElement[0]),r=this.instance.rootElement.scrollTop(),s=this.instance.rootElement.scrollLeft(),a=i.top-n.top+r-1,l=i.left-n.left+s-1,c=this.instance.getSettings(),h=c.rowHeaders===!1?0:1,u=c.colHeaders===!1?0:1;0>a&&(a=0),0>l&&(l=0),h>0&&parseInt(o.css("border-top-width"),10)>0&&(a+=1),u>0&&parseInt(o.css("border-left-width"),10)>0&&(l+=1),this.textareaParentStyle.top=a+"px",this.textareaParentStyle.left=l+"px";var d=o.width(),p=this.instance.view.maximumVisibleElementWidth(l)-10,f=o.outerHeight()-4,g=this.instance.view.maximumVisibleElementHeight(a)-5;parseInt(o.css("border-top-width"),10)>0&&(f-=1),parseInt(o.css("border-left-width"),10)>0&&h>0&&(d-=1),this.$textarea.autoResize({minHeight:Math.min(f,g),maxHeight:g,minWidth:Math.min(d,p),maxWidth:p,animate:!1,extraSpace:0}),this.textareaParentStyle.display="block"}},o.prototype.bindEvents=function(){this.$textarea.on("cut.editor",function(t){t.stopPropagation()}),this.$textarea.on("paste.editor",function(t){t.stopPropagation()})},e.editors.TextEditor=o,e.editors.registerEditor("text",e.editors.TextEditor)}(o),function(t){var e=t.editors.BaseEditor.prototype.extend();e.prototype.beginEditing=function(){this.saveValue([[!this.originalValue]])},e.prototype.finishEditing=function(){},e.prototype.init=function(){},e.prototype.open=function(){},e.prototype.close=function(){},e.prototype.getValue=function(){},e.prototype.setValue=function(){},e.prototype.focus=function(){},t.editors.CheckboxEditor=e,t.editors.registerEditor("checkbox",e)}(o),function(e){var o=e.editors.TextEditor.prototype.extend();o.prototype.init=function(){if(!t.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");e.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var o=this;this.instance.addHook("afterDestroy",function(){o.destroyElements()})},o.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=t(this.datePicker);var o=this,i={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,onSelect:function(t){o.setValue(t),o.finishEditing(!1)}};this.$datePicker.datepicker(i),this.$datePicker.on("mousedown",function(t){t.stopPropagation()}),this.hideDatepicker()},o.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},o.prototype.beginEditing=function(t,o,i,n,r){e.editors.TextEditor.prototype.beginEditing.apply(this,arguments),this.showDatepicker()},o.prototype.finishEditing=function(t,o){this.hideDatepicker(),e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.showDatepicker=function(){var e=t(this.TD),o=e.offset();this.datePickerStyle.top=o.top+e.height()+"px",this.datePickerStyle.left=o.left+"px";var i={defaultDate:this.originalValue||void 0};t.extend(i,this.cellProperties),this.$datePicker.datepicker("option",i),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},o.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},e.editors.DateEditor=o,e.editors.registerEditor("date",o)}(o),function(e){var o=e.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var o=document.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.$htContainer=t(o),this.$htContainer.handsontable()},o.prototype.prepare=function(o,i,n,r,s,a){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var l=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var t=this.getValue();void 0!==t&&l.setValue(t),l.instance.destroyEditor()},beforeOnKeyDown:function(t){var o=this;switch(t.keyCode){case e.helper.keyCode.ESCAPE:l.instance.destroyEditor(!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ENTER:var i=o.getSelected(),n=this.getDataAtCell(i[0],i[1]);void 0!==n&&l.setValue(n),l.instance.destroyEditor();break;case e.helper.keyCode.ARROW_UP:o.getSelected()&&0==o.getSelected()[0]&&!l.cellProperties.strict&&(o.deselectCell(),l.instance.listen(),l.focus(),t.preventDefault(),t.stopImmediatePropagation())}}};this.cellProperties.handsontable&&(c=t.extend(c,a.handsontable)),this.$htContainer.handsontable("destroy"),this.$htContainer.handsontable(c)};var i=function(t){if(!t.isImmediatePropagationStopped()){var o=this.getActiveEditor(),i=o.$htContainer.handsontable("getInstance");if(t.keyCode==e.helper.keyCode.ARROW_DOWN){if(i.getSelected()){var n=i.getSelected()[0],r=n<i.countRows()-1?n+1:n;i.selectCell(r,0)}else i.selectCell(0,0);t.preventDefault(),t.stopImmediatePropagation()}}};o.prototype.open=function(){this.instance.addHook("beforeKeyDown",i),e.editors.TextEditor.prototype.open.apply(this,arguments),this.$htContainer.handsontable("render"),this.cellProperties.strict?(this.$htContainer.handsontable("selectCell",0,0),this.$textarea[0].style.visibility="hidden"):(this.$htContainer.handsontable("deselectCell"),this.$textarea[0].style.visibility="visible"),this.wtDom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)},o.prototype.close=function(){this.instance.removeHook("beforeKeyDown",i),this.instance.listen(),e.editors.TextEditor.prototype.close.apply(this,arguments)},o.prototype.focus=function(){this.instance.listen(),e.editors.TextEditor.prototype.focus.apply(this,arguments)},o.prototype.beginEditing=function(t){var o=this.instance.getSettings().onBeginEditing;o&&o()===!1||e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},o.prototype.finishEditing=function(t,o){if(this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("getSelected")){var i=this.$htContainer.handsontable("getInstance").getValue();void 0!==i&&this.setValue(i)}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},e.editors.HandsontableEditor=o,e.editors.registerEditor("handsontable",o)}(o),function(t){function e(t,e){for(var o={},i=e.length,n,r,s,a=0,l=t.length;l>a;a++)n=t[a],r=i>0?n.indexOf(e):n===e?0:-1,-1!=r&&(s=n.length-r-i,("undefined"==typeof o.indexOfValue||o.indexOfValue>r||o.indexOfValue==r&&o.charsLeft>s)&&(o.indexOfValue=r,o.charsLeft=s,o.index=a));return o.index}var o=t.editors.HandsontableEditor.prototype.extend();o.prototype.init=function(){t.editors.HandsontableEditor.prototype.init.apply(this,arguments),this.query=null},o.prototype.createElements=function(){t.editors.HandsontableEditor.prototype.createElements.apply(this,arguments),this.$htContainer.addClass("autocompleteEditor")},o.prototype.bindEvents=function(){var e=this;this.$textarea.on("keydown.autocompleteEditor",function(o){t.helper.isMetaKey(o.keyCode)&&-1==[t.helper.keyCode.BACKSPACE,t.helper.keyCode.DELETE].indexOf(o.keyCode)?o.keyCode==t.helper.keyCode.ENTER&&e.cellProperties.strict!==!0&&e.$htContainer.handsontable("deselectCell"):setTimeout(function(){e.queryChoices(e.$textarea.val())})}),this.$htContainer.on("mouseenter",function(){e.$htContainer.handsontable("deselectCell")}),this.$htContainer.on("mouseleave",function(){e.queryChoices(e.query)}),t.editors.HandsontableEditor.prototype.bindEvents.apply(this,arguments)},o.prototype.beginEditing=function(){t.editors.HandsontableEditor.prototype.beginEditing.apply(this,arguments);var e=this;setTimeout(function(){e.queryChoices(e.TEXTAREA.value)});var o=this.$htContainer.handsontable("getInstance");o.updateSettings({colWidths:[this.wtDom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(t,o,i,n,r){var s=this.getCellMeta(o,i).filteringCaseSensitive===!0,a=s?r.indexOf(e.query):r.toLowerCase().indexOf(e.query.toLowerCase());if(-1!=a){var l=r.substr(a,e.query.length);t.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}})};var i;o.prototype.open=function(){var e=this;i=function(o){var i=this;o.keyCode==t.helper.keyCode.ARROW_UP&&i.getSelected()&&0==i.getSelected()[0]&&(e.cellProperties.strict||i.deselectCell(),e.instance.listen(),e.focus(),o.preventDefault(),o.stopImmediatePropagation())},this.$htContainer.handsontable("getInstance").addHook("beforeKeyDown",i),t.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.$textarea[0].style.visibility="visible",e.focus()},o.prototype.close=function(){this.$htContainer.handsontable("getInstance").removeHook("beforeKeyDown",i),t.editors.HandsontableEditor.prototype.close.apply(this,arguments)},o.prototype.queryChoices=function(e){if(this.query=e,"function"==typeof this.cellProperties.source){var o=this;this.cellProperties.source(e,function(t){o.updateChoicesList(t)})}else if(t.helper.isArray(this.cellProperties.source)){var i;if(e&&this.cellProperties.filter!==!1){var n=this.cellProperties.filteringCaseSensitive===!0,r=e.toLowerCase();i=this.cellProperties.source.filter(function(t){return n?-1!=t.indexOf(e):-1!=t.toLowerCase().indexOf(r)})}else i=this.cellProperties.source;this.updateChoicesList(i)}else this.updateChoicesList([])},o.prototype.updateChoicesList=function(o){this.$htContainer.handsontable("loadData",t.helper.pivot([o]));var i=this.getValue(),n;this.cellProperties.strict===!0&&(n=e(o,i),"undefined"==typeof n&&this.cellProperties.allowInvalid===!1&&(n=0)),"undefined"==typeof n?this.$htContainer.handsontable("deselectCell"):this.$htContainer.handsontable("selectCell",n,0),this.focus()},t.editors.AutocompleteEditor=o,t.editors.registerEditor("autocomplete",o)}(o),function(e){var o=e.editors.TextEditor.prototype.extend(),i=new y;o.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.$textarea=t(this.TEXTAREA),i.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},e.editors.PasswordEditor=o,e.editors.registerEditor("password",o)}(o),function(e){var o=e.editors.BaseEditor.prototype.extend();o.prototype.init=function(){this.select=t("<select />").addClass("htSelectEditor").hide(),this.instance.rootElement.append(this.select)},o.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var o=this.cellProperties.selectOptions,i;i=this.prepareOptions("function"==typeof o?o(this.row,this.col,this.prop):o);var n=[];for(var r in i)if(i.hasOwnProperty(r)){var s=t("<option />");s.val(r),s.html(i[r]),n.push(s)}this.select.empty(),this.select.append(n)},o.prototype.prepareOptions=function(t){var o={};if(e.helper.isArray(t))for(var i=0,n=t.length;n>i;i++)o[t[i]]=t[i];else"object"==typeof t&&(o=t);return o},o.prototype.getValue=function(){return this.select.val()},o.prototype.setValue=function(t){this.select.val(t)};var i=function(t){var o=this,i=o.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var n=i.select.find("option:selected").prev();1==n.length&&n.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var r=i.select.find("option:selected").next();1==r.length&&r.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};o.prototype.open=function(){this.select.css({height:t(this.TD).height(),"min-width":t(this.TD).outerWidth()}),this.select.show(),this.select.offset(t(this.TD).offset()),this.instance.addHook("beforeKeyDown",i)},o.prototype.close=function(){this.select.hide(),this.instance.removeHook("beforeKeyDown",i)},o.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=o,e.editors.registerEditor("select",o)}(o),function(t){var e=t.editors.AutocompleteEditor.prototype.extend();e.prototype.prepare=function(){t.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},t.editors.DropdownEditor=e,t.editors.registerEditor("dropdown",e)}(o),o.NumericValidator=function(t,e){null===t&&(t=""),e(/^-?\d*\.?\d*$/.test(t))};var I=function(t,e){var o=t,i="string"==typeof o?o.toLowerCase():null;return function(t){for(var n=!1,r=0,s=t.length;s>r;r++){if(o===t[r]){n=!0;break}if(i===t[r].toLowerCase()){n=!0;break}}e(n)}};o.AutocompleteValidator=function(t,e){this.strict&&this.source?"function"==typeof this.source?this.source(t,I(t,e)):I(t,e)(this.source):e(!0)},o.AutocompleteCell={editor:o.editors.AutocompleteEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.CheckboxCell={editor:o.editors.CheckboxEditor,renderer:o.renderers.CheckboxRenderer},o.TextCell={editor:o.editors.TextEditor,renderer:o.renderers.TextRenderer},o.NumericCell={editor:o.editors.TextEditor,renderer:o.renderers.NumericRenderer,validator:o.NumericValidator,dataType:"number"},o.DateCell={editor:o.editors.DateEditor,renderer:o.renderers.AutocompleteRenderer},o.HandsontableCell={editor:o.editors.HandsontableEditor,renderer:o.renderers.AutocompleteRenderer},o.PasswordCell={editor:o.editors.PasswordEditor,renderer:o.renderers.PasswordRenderer,copyable:!1},o.DropdownCell={editor:o.editors.DropdownEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.cellTypes={text:o.TextCell,date:o.DateCell,numeric:o.NumericCell,checkbox:o.CheckboxCell,autocomplete:o.AutocompleteCell,handsontable:o.HandsontableCell,password:o.PasswordCell,dropdown:o.DropdownCell},o.cellLookup={validator:{numeric:o.NumericValidator,autocomplete:o.AutocompleteValidator}},function(t){function e(i){return this.filter(e.resizableFilterSelector).each(function(){new o(t(this),i)}),this}function o(o,i){this.clones||(this.config=t.extend({},e.defaults,i),this.el=o,this.nodeName=o[0].nodeName.toLowerCase(),this.previousScrollTop=null,"original"===i.maxWidth&&(i.maxWidth=o.width()),"original"===i.minWidth&&(i.minWidth=o.width()),"original"===i.maxHeight&&(i.maxHeight=o.height()),"original"===i.minHeight&&(i.minHeight=o.height()),"textarea"===this.nodeName&&o.css({resize:"none",overflowY:"none"}),o.data("AutoResizer",this),this.createClone(),this.injectClone(),this.bind())
}e.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500},e.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"],e.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"},e.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]",e.AutoResizer=o,t.fn.autoResize=e,o.prototype={bind:function(){var e=t.proxy(function(){return this.check(),!0},this);this.unbind(),this.el.bind("keyup.autoResize",e).bind("change.autoResize",e),this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var o=this.el,i=this,n=this.config;this.clones=t(),("original"!==n.minHeight||"original"!==n.maxHeight)&&(this.hClone=o.clone().height("auto"),this.clones=this.clones.add(this.hClone)),("original"!==n.minWidth||"original"!==n.maxWidth)&&(this.wClone=t("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"}),this.clones=this.clones.add(this.wClone)),t.each(e.cloneCSSProperties,function(t,e){i.clones.css(e,o.css(e))}),this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(e.cloneCSSValues).css("overflowY","scroll")},check:function(t,e){var o=this.config,i=this.wClone,n=this.hClone,r=this.el,s=r.val();if(i){i.text(s);var a=i.outerWidth(),l=a+o.extraSpace>=o.minWidth?a+o.extraSpace:o.minWidth,c=r.width();l=Math.min(l,o.maxWidth),(c>l&&l>=o.minWidth||l>=o.minWidth&&l<=o.maxWidth)&&(o.onResize.call(r),r.scrollLeft(0),o.animate&&!e?r.stop(1,1).animate({width:l},o.animate):r.width(l))}if(n){l&&n.width(l),n.height(0).val(s).scrollTop(1e4);var h=n[0].scrollTop+o.extraSpace;if(this.previousScrollTop===h)return;this.previousScrollTop=h,h>=o.maxHeight&&(h=o.maxHeight),h<o.minHeight&&(h=o.minHeight),h==o.maxHeight&&l==o.maxWidth?r.css("overflowY","scroll"):r.css("overflowY","hidden"),o.onResize.call(r),o.animate&&!e?r.stop(1,1).animate({height:h},o.animate):r.height(h)}},destroy:function(){this.unbind(),this.el.removeData("AutoResizer"),this.clones.remove(),delete this.el,delete this.hClone,delete this.wClone,delete this.clones},injectClone:function(){(e.cloneContainer||(e.cloneContainer=t("<arclones/>").appendTo("body"))).empty().append(this.clones)}}}(jQuery),function(t){function e(t){return t.split('"').length-1}t.SheetClip={parse:function(t){var o,i,n,r=[],s=0,a,l,c,h;for(n=t.split("\n"),n.length>1&&""===n[n.length-1]&&n.pop(),o=0,i=n.length;i>o;o+=1){for(n[o]=n[o].split("	"),a=0,l=n[o].length;l>a;a+=1)r[s]||(r[s]=[]),c&&0===a?(h=r[s].length-1,r[s][h]=r[s][h]+"\n"+n[o][0],c&&1&e(n[o][0])&&(c=!1,r[s][h]=r[s][h].substring(0,r[s][h].length-1).replace(/""/g,'"'))):a===l-1&&0===n[o][a].indexOf('"')?(r[s].push(n[o][a].substring(1).replace(/""/g,'"')),c=!0):(r[s].push(n[o][a].replace(/""/g,'"')),c=!1);c||(s+=1)}return r},stringify:function(t){var e,o,i,n,r="",s;for(e=0,o=t.length;o>e;e+=1){for(i=0,n=t[e].length;n>i;i+=1)i>0&&(r+="	"),s=t[e][i],r+="string"==typeof s?s.indexOf("\n")>-1?'"'+s.replace(/"/g,'""')+'"':s:null===s||void 0===s?"":s;r+="\n"}return r}}}(e);var L=function(){var t;return{getInstance:function(){return t?t.hasBeenDestroyed()&&t.init():t=new i,t.refCounter++,t}}}();i.prototype.init=function(){var t=this,e,o;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this.listenerElement=document.documentElement,o=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top=0,e.left=0,o.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",e=this.elTextarea.style,e.width="1px",e.height="1px",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.keydownListener=function(e){var o=!1;if(e.metaKey?o=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(o=!0),o){if(document.activeElement!==t.elTextarea&&(""!=t.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;t.selectNodeText(t.elTextarea),setTimeout(function(){t.selectNodeText(t.elTextarea)},0)}!o||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){t.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){t.triggerPaste(e)},0))},this._bindEvent(this.listenerElement,"keydown",this.keydownListener)},i.prototype.selectNodeText=function(t){t.select()},i.prototype.getSelectionText=function(){var t="";return e.getSelection?t=e.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t},i.prototype.copyable=function(t){if("string"!=typeof t&&void 0===t.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=t},i.prototype.onCut=function(t){this.cutCallbacks.push(t)},i.prototype.onPaste=function(t){this.pasteCallbacks.push(t)},i.prototype.removeCallback=function(t){var e,o;for(e=0,o=this.copyCallbacks.length;o>e;e++)if(this.copyCallbacks[e]===t)return this.copyCallbacks.splice(e,1),!0;for(e=0,o=this.cutCallbacks.length;o>e;e++)if(this.cutCallbacks[e]===t)return this.cutCallbacks.splice(e,1),!0;for(e=0,o=this.pasteCallbacks.length;o>e;e++)if(this.pasteCallbacks[e]===t)return this.pasteCallbacks.splice(e,1),!0;return!1},i.prototype.triggerCut=function(t){var e=this;e.cutCallbacks&&setTimeout(function(){for(var o=0,i=e.cutCallbacks.length;i>o;o++)e.cutCallbacks[o](t)},50)},i.prototype.triggerPaste=function(t,e){var o=this;o.pasteCallbacks&&setTimeout(function(){for(var i=(e||o.elTextarea.value).replace(/\n$/,""),n=0,r=o.pasteCallbacks.length;r>n;n++)o.pasteCallbacks[n](i,t)},50)},i.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&this.elDiv.parentNode.removeChild(this.elDiv),this._unbindEvent(this.listenerElement,"keydown",this.keydownListener))},i.prototype.hasBeenDestroyed=function(){return!this.refCounter},i.prototype._bindEvent=function(){return e.jQuery?function(e,o,i){t(e).on(o+".copypaste",i)}:function(t,e,o){t.addEventListener(e,o,!1)}}(),i.prototype._unbindEvent=function(){return e.jQuery?function(e,o,i){t(e).off(o+".copypaste",i)}:function(t,e,o){t.removeEventListener(e,o,!1)}}();var B;!function(t){function o(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function i(t,e){var n;for(var r in t)if(t.hasOwnProperty(r)){if(t[r]===e)return o(r)+"/";if("object"==typeof t[r]&&(n=i(t[r],e),""!=n))return o(r)+"/"+n}return""}function n(t,e){if(t===e)return"/";var o=i(t,e);if(""===o)throw new Error("Object not found in root");return"/"+o}function r(t){for(var e=0,o=y.length;o>e;e++)if(y[e].obj===t)return y[e]}function s(t,e){for(var o=0,i=t.observers.length;i>o;o++)if(t.observers[o].callback===e)return t.observers[o].observer}function a(t,e){for(var o=0,i=t.observers.length;i>o;o++)if(t.observers[o].observer===e)return void t.observers.splice(o,1)}function l(t,e){d(e),Object.observe?u(e,t):clearTimeout(e.next);var o=r(t);a(o,e)}function c(t,o){var i=[],a=t,l,c=r(t);if(c?l=s(c,o):(c=new v(t),y.push(c)),l)return l;if(Object.observe)l=function(e){u(l,t),h(l,t);for(var r=0,s=e.length;s>r;){if(("length"!==e[r].name||!S(e[r].object))&&"__Jasmine_been_here_before__"!==e[r].name){var c=e[r].type;switch(c){case"new":c="add";break;case"deleted":c="delete";break;case"updated":c="update"}w[c].call(e[r],i,n(a,e[r].object))}r++}i&&o&&o(i),l.patches=i,i=[]};else if(l={},c.value=JSON.parse(JSON.stringify(t)),o){l.callback=o,l.next=null;var p=this.intervals||[100,1e3,1e4,6e4],f=0,g=function(){d(l)},m=function(){clearTimeout(l.next),l.next=setTimeout(function(){g(),f=0,l.next=setTimeout(b,p[f++])},0)},b=function(){g(),f==p.length&&(f=p.length-1),l.next=setTimeout(b,p[f++])};"undefined"!=typeof e&&(e.addEventListener?(e.addEventListener("mousedown",m),e.addEventListener("mouseup",m),e.addEventListener("keydown",m)):(e.attachEvent("onmousedown",m),e.attachEvent("onmouseup",m),e.attachEvent("onkeydown",m))),l.next=setTimeout(b,p[f++])}return l.patches=i,l.object=t,c.observers.push(new C(o,l)),h(l,t)}function h(t,e){if(Object.observe){Object.observe(e,t);for(var o in e)if(e.hasOwnProperty(o)){var i=e[o];i&&"object"==typeof i&&h(t,i)}}return t}function u(t,e){if(Object.observe){Object.unobserve(e,t);for(var o in e)if(e.hasOwnProperty(o)){var i=e[o];i&&"object"==typeof i&&u(t,i)}}return t}function d(t){if(Object.observe)Object.deliverChangeRecords(t);else{for(var e,o=0,i=y.length;i>o;o++)if(y[o].obj===t.object){e=y[o];break}p(e.value,t.object,t.patches,"")}var n=t.patches;return n.length>0&&(t.patches=[],t.callback&&t.callback(n)),n}function p(t,e,i,n){for(var r=b(e),s=b(t),a=!1,l=!1,c=s.length-1;c>=0;c--){var h=s[c],u=t[h];if(e.hasOwnProperty(h)){var d=e[h];u instanceof Object?p(u,d,i,n+"/"+o(h)):u!=d&&(a=!0,i.push({op:"replace",path:n+"/"+o(h),value:d}),t[h]=d)}else i.push({op:"remove",path:n+"/"+o(h)}),delete t[h],l=!0}if(l||r.length!=s.length)for(var c=0;c<r.length;c++){var h=r[c];t.hasOwnProperty(h)||(i.push({op:"add",path:n+"/"+o(h),value:e[h]}),t[h]=JSON.parse(JSON.stringify(e[h])))}}function f(t,e){for(var o=!1,i=0,n=e.length,r;n>i;){r=e[i];for(var s=r.path.split("/"),a=t,l=1,c=s.length;;)if(S(a)){var h=parseInt(s[l],10);if(l++,l>=c){o=m[r.op].call(r,a,h,t);break}a=a[h]}else{var u=s[l];if(-1!=u.indexOf("~")&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=c){o=g[r.op].call(r,a,u,t);break}a=a[u]}i++}return o}var g={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,o){var i={op:"_get",path:this.from};return f(o,[i]),f(o,[{op:"remove",path:this.from}]),f(o,[{op:"add",path:this.path,value:i.value}]),!0},copy:function(t,e,o){var i={op:"_get",path:this.from};return f(o,[i]),f(o,[{op:"add",path:this.path,value:i.value}]),!0},test:function(t,e){return JSON.stringify(t[e])===JSON.stringify(this.value)},_get:function(t,e){this.value=t[e]}},m={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:g.move,copy:g.copy,test:g.test,_get:g._get},w={add:function(t,e){var i={op:"add",path:e+o(this.name),value:this.object[this.name]};t.push(i)},"delete":function(t,e){var i={op:"remove",path:e+o(this.name)};t.push(i)},update:function(t,e){var i={op:"replace",path:e+o(this.name),value:this.object[this.name]};t.push(i)}},y=[];t.intervals;var v=function(){function t(t){this.observers=[],this.obj=t}return t}(),C=function(){function t(t,e){this.callback=t,this.observer=e}return t}();t.unobserve=l,t.observe=c,t.generate=d;var b;b=Object.keys?Object.keys:function(t){var e=[];for(var o in t)t.hasOwnProperty(o)&&e.push(o);return e};var S;S=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},t.apply=f}(B||(B={})),"undefined"!=typeof exports&&(exports.apply=B.apply,exports.observe=B.observe,exports.unobserve=B.unobserve,exports.generate=B.generate),o.PluginHookClass=function(){function t(){this.hooks=e(),this.legacy=i}var e=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeColumnSort:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterColumnSort:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],modifyCol:[]}},i={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return t.prototype.add=function(t,e){if(o.helper.isArray(e))for(var n=0,r=e.length;r>n;n++)this.add(t,e[n]);else t in i&&(t=i[t]),"undefined"==typeof this.hooks[t]&&(this.hooks[t]=[]),-1==this.hooks[t].indexOf(e)&&this.hooks[t].push(e);return this},t.prototype.once=function(t,e){if(o.helper.isArray(e))for(var i=0,n=e.length;n>i;i++)e[i].runOnce=!0,this.add(t,e[i]);else e.runOnce=!0,this.add(t,e)},t.prototype.remove=function(t,e){var o=!1;if(t in i&&(t=i[t]),"undefined"!=typeof this.hooks[t])for(var n=0,r=this.hooks[t].length;r>n;n++)if(this.hooks[t][n]==e){delete this.hooks[t][n].runOnce,this.hooks[t].splice(n,1),o=!0;break}return o},t.prototype.run=function(t,e,o,n,r,s,a){if(e in i&&(e=i[e]),"undefined"!=typeof this.hooks[e])for(var l=Array.prototype.slice.call(this.hooks[e]),c=0,h=l.length;h>c;c++)l[c].call(t,o,n,r,s,a),l[c].runOnce&&this.remove(e,l[c])},t.prototype.execute=function(t,e,o,n,r,s,a){var l,c;if(e in i&&(e=i[e]),"undefined"!=typeof this.hooks[e]){c=Array.prototype.slice.call(this.hooks[e]);for(var h=0,u=c.length;u>h;h++)if(l=c[h].call(t,o,n,r,s,a),void 0!==l&&(o=l),c[h].runOnce&&this.remove(e,c[h]),l===!1)return!1}return o},t}(),o.PluginHooks=new o.PluginHookClass,function(t){function e(){function e(t){var e=document,o=this;o.table=e.createElement("table"),o.theadTh=e.createElement("th"),o.table.appendChild(e.createElement("thead")).appendChild(e.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=e.createElement("tbody"),o.table.appendChild(o.tbody),o.container=e.createElement("div"),o.container.className=t.rootElement[0].className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}var i=this,n=5;this.beforeInit=function(){var t=this;t.autoColumnWidths=[],t.getSettings().autoColumnSize!==!1?t.autoColumnSizeTmp||(t.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},t.addHook("beforeRender",o.determineIfChanged),t.addHook("afterGetColWidth",o.getColWidth),t.addHook("afterDestroy",o.afterDestroy),t.determineColumnWidth=i.determineColumnWidth):t.autoColumnSizeTmp&&(t.removeHook("beforeRender",o.determineIfChanged),t.removeHook("afterGetColWidth",o.getColWidth),t.removeHook("afterDestroy",o.afterDestroy),delete t.determineColumnWidth,i.afterDestroy.call(t))},this.determineIfChanged=function(t){t&&o.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(o){var i=this,r=i.autoColumnSizeTmp;r.container||e.call(r,i),r.container.className=i.rootElement[0].className+" htAutoColumnSize",r.table.className=i.$table[0].className;for(var s=i.countRows(),a={},l=0,c=0;s>c;c++){var h=t.helper.stringify(i.getDataAtCell(c,o)),u=h.length;u>l&&(l=u),a[u]||(a[u]={needed:n,strings:[]}),a[u].needed&&(a[u].strings.push({value:h,row:c}),a[u].needed--)}var d=i.getSettings();d.colHeaders&&i.view.appendColHeader(o,r.theadTh),i.view.wt.wtDom.empty(r.tbody);for(var p in a)if(a.hasOwnProperty(p))for(var f=0,g=a[p].strings.length;g>f;f++){var m=a[p].strings[f].row,w=i.getCellMeta(m,o);w.col=o,w.row=m;var y=i.getCellRenderer(w),v=document.createElement("tr"),C=document.createElement("td");y(i,C,m,o,i.colToProp(o),a[p].strings[f].value,w),c++,v.appendChild(C),r.tbody.appendChild(v)}var b=i.rootElement[0].parentNode;b.appendChild(r.container);var S=i.view.wt.wtDom.outerWidth(r.table);if(b.removeChild(r.container),!d.nativeScrollbars){var T=i.view.wt.wtViewport.getViewportWidth()-2;S>T&&(S=T)}return S},this.determineColumnsWidth=function(){var t=this,e=this.getSettings();if(e.autoColumnSize||!e.colWidths)for(var o=this.countCols(),n=0;o>n;n++)t._getColWidthFromSettings(n)||(this.autoColumnWidths[n]=i.determineColumnWidth.call(t,n))},this.getColWidth=function(t,e){this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e.width&&(e.width=this.autoColumnWidths[t])},this.afterDestroy=function(){var t=this;t.autoColumnSizeTmp&&t.autoColumnSizeTmp.container&&t.autoColumnSizeTmp.container.parentNode&&t.autoColumnSizeTmp.container.parentNode.removeChild(t.autoColumnSizeTmp.container),t.autoColumnSizeTmp=null}}var o=new e;t.PluginHooks.add("beforeInit",o.beforeInit),t.PluginHooks.add("afterUpdateSettings",o.beforeInit)}(o);var W=new n;o.PluginHooks.add("afterInit",function(){W.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){W.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("beforeGet",W.onBeforeGetSet),o.PluginHooks.add("beforeSet",W.onBeforeGetSet),o.PluginHooks.add("afterGetColHeader",W.getColHeader),function(e){function o(i,n){function r(){var o=t("body > .htContextMenu")[0];return o||(o=document.createElement("DIV"),e.Dom.addClass(o,"htContextMenu"),document.getElementsByTagName("body")[0].appendChild(o)),o}this.instance=i;var s=this;this.menu=r(),this.enabled=!0,this.bindMouseEvents(),this.bindTableEvents(),this.instance.addHook("afterDestroy",function(){s.destroy()}),this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(t,e){this.alter("insert_row",e.start.row())},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},row_below:{name:"Insert row below",callback:function(t,e){this.alter("insert_row",e.end.row()+1)},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},hsep1:o.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(t,e){this.alter("insert_col",e.start.col())},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},col_right:{name:"Insert column on the right",callback:function(t,e){this.alter("insert_col",e.end.col()+1)},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},hsep2:o.SEPARATOR,remove_row:{name:"Remove row",callback:function(t,e){var o=e.end.row()-e.start.row()+1;this.alter("remove_row",e.start.row(),o)}},remove_col:{name:"Remove column",callback:function(t,e){var o=e.end.col()-e.start.col()+1;this.alter("remove_col",e.start.col(),o)}},hsep3:o.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}},this.options={},e.helper.extend(this.options,this.defaultOptions),this.updateOptions(n)}function i(){var t=this,i=t.getSettings().contextMenu,n=e.helper.isObject(i)?i:{};i?(t.contextMenu||(t.contextMenu=new o(t,n)),t.contextMenu.enable(),e.helper.isArray(i)&&t.contextMenu.filterItems(i)):t.contextMenu&&(t.contextMenu.destroy(),delete t.contextMenu)}o.prototype.bindMouseEvents=function(){function i(i){i.preventDefault(),("TD"==i.target.nodeName||e.Dom.hasClass(i.target,"current")&&e.Dom.hasClass(i.target,"wtBorder"))&&(this.show(i.pageY,i.pageX),t(document).on("mousedown.htContextMenu",e.helper.proxy(o.prototype.close,this)))}this.instance.rootElement.on("contextmenu.htContextMenu",e.helper.proxy(i,this))},o.prototype.bindTableEvents=function(){var t=this;this._afterScrollCallback=function(){t.close()},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},o.prototype.unbindTableEvents=function(){var t=this;this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},o.prototype.performAction=function(){var e=t(this.menu).handsontable("getInstance"),i=e.getSelected()[0],n=e.getData()[i];if(n.disabled!==!0&&("function"!=typeof n.disabled||n.disabled.call(this.instance)!==!0)&&"function"==typeof n.callback){var r=this.instance.getSelected(),s=o.utils.normalizeSelection(r);n.callback.call(this.instance,n.key,s)}},o.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu"),t(document).off("mousedown.htContextMenu")},o.prototype.show=function(i,n){this.menu.style.display="block",t(this.menu).off("mousedown.htContextMenu").on("mousedown.htContextMenu",e.helper.proxy(this.performAction,this)),t(this.menu).handsontable({data:o.utils.convertItemsToArray(this.getItems()),colHeaders:!1,colWidths:[160],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],beforeKeyDown:e.helper.proxy(this.onBeforeKeyDown,this)}),this.bindTableEvents(),this.setMenuPosition(i,n),t(this.menu).handsontable("listen")},o.prototype.close=function(){this.hide(),t(document).off("mousedown.htContextMenu"),this.unbindTableEvents(),this.instance.listen()},o.prototype.hide=function(){this.menu.style.display="none",t(this.menu).handsontable("destroy")},o.prototype.renderer=function(i,n,r,s,a,l,c){function h(t){return new RegExp(o.SEPARATOR,"i").test(t.name)}function u(t,e){return t.disabled===!0||"function"==typeof t.disabled&&t.disabled.call(d.instance)===!0}var d=this,p=i.getData()[r],f=document.createElement("DIV");e.Dom.empty(n),n.appendChild(f),h(p)?e.Dom.addClass(n,"htSeparator"):e.Dom.fastInnerText(f,l),u(p,d.instance)?(e.Dom.addClass(n,"htDisabled"),t(f).on("mouseenter",function(){i.deselectCell()})):(e.Dom.removeClass(n,"htDisabled"),t(f).on("mouseenter",function(){i.selectCell(r,s)}))},o.prototype.onBeforeKeyDown=function(i){function n(t){var e=t.getCell(0,0);o.utils.isSeparator(e)||o.utils.isDisabled(e)?s(0,0,t):t.selectCell(0,0)}function r(t){var e=t.countRows()-1,i=t.getCell(e,0);o.utils.isSeparator(i)||o.utils.isDisabled(i)?a(e,0,t):t.selectCell(e,0)}function s(t,e,i){var n=t+1,r=n<i.countRows()?i.getCell(n,e):null;r&&(o.utils.isSeparator(r)||o.utils.isDisabled(r)?s(n,e,i):i.selectCell(n,e))}function a(t,e,i){var n=t-1,r=n>=0?i.getCell(n,e):null;r&&(o.utils.isSeparator(r)||o.utils.isDisabled(r)?a(n,e,i):i.selectCell(n,e))}var l=this,c=t(l.menu).handsontable("getInstance"),h=c.getSelected();switch(i.keyCode){case e.helper.keyCode.ESCAPE:l.close(),i.preventDefault(),i.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:c.getSelected()&&(l.performAction(),l.close());break;case e.helper.keyCode.ARROW_DOWN:h?s(h[0],h[1],c):n(c),i.preventDefault(),i.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:h?a(h[0],h[1],c):r(c),i.preventDefault(),i.stopImmediatePropagation()}},o.prototype.getItems=function(){function t(t){"string"==typeof t?this.name=t:e.helper.extend(this,t)}var o={};t.prototype=this.options;for(var i in this.options.items)!this.options.items.hasOwnProperty(i)||this.itemsFilter&&-1==this.itemsFilter.indexOf(i)||(o[i]=new t(this.options.items[i]));return o},o.prototype.updateOptions=function(t){if(t=t||{},t.items)for(var o in t.items){var i={};t.items.hasOwnProperty(o)&&this.defaultOptions.items.hasOwnProperty(o)&&e.helper.isObject(t.items[o])&&(e.helper.extend(i,this.defaultOptions.items[o]),e.helper.extend(i,t.items[o]),t.items[o]=i)}e.helper.extend(this.options,t)},o.prototype.setMenuPosition=function(t,e){var o={top:t,topRelative:t-document.documentElement.scrollTop,left:e,leftRelative:e-document.documentElement.scrollLeft};this.menuFitsBelowCursor(o)?this.positionMenuBelowCursor(o):this.positionMenuAboveCursor(o),this.menuFitsOnRightOfCursor(o)?this.positionMenuOnRightOfCursor(o):this.positionMenuOnLeftOfCursor(o)},o.prototype.menuFitsBelowCursor=function(t){return t.topRelative+this.menu.offsetHeight<=document.documentElement.scrollTop+document.documentElement.clientHeight},o.prototype.menuFitsOnRightOfCursor=function(t){return t.leftRelative+this.menu.offsetWidth<=document.documentElement.scrollLeft+document.documentElement.clientWidth},o.prototype.positionMenuBelowCursor=function(t){this.menu.style.top=t.top+"px"},o.prototype.positionMenuAboveCursor=function(t){this.menu.style.top=t.top-this.menu.offsetHeight+"px"},o.prototype.positionMenuOnRightOfCursor=function(t){this.menu.style.left=t.left+"px"},o.prototype.positionMenuOnLeftOfCursor=function(t){this.menu.style.left=t.left-this.menu.offsetWidth+"px"},o.utils={},o.utils.convertItemsToArray=function(t){var e=[],o;for(var i in t)if(t.hasOwnProperty(i)){if("string"==typeof t[i])o={name:t[i]};else{if(t[i].visible===!1)continue;o=t[i]}o.key=i,e.push(o)}return e},o.utils.normalizeSelection=function(t){var o={start:new e.SelectionPoint,end:new e.SelectionPoint};return o.start.row(Math.min(t[0],t[2])),o.start.col(Math.min(t[1],t[3])),o.end.row(Math.max(t[0],t[2])),o.end.col(Math.max(t[1],t[3])),o},o.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")},o.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")},o.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},o.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.close(),this.unbindMouseEvents(),this.unbindTableEvents())},o.prototype.destroy=function(){this.close(),this.unbindMouseEvents(),this.unbindTableEvents(),this.isMenuEnabledByOtherHotInstance()||this.removeMenu()},o.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=t(".handsontable"),o=!1,i=0,n=e.length;n>i;i++){var r=t(e[i]).handsontable("getInstance");if(r&&r.getSettings().contextMenu){o=!0;break}}return o},o.prototype.removeMenu=function(){this.menu.parentNode&&this.menu.parentNode.removeChild(this.menu)},o.prototype.filterItems=function(t){this.itemsFilter=t},o.SEPARATOR="---------",e.PluginHooks.add("afterInit",i),e.PluginHooks.add("afterUpdateSettings",i),e.ContextMenu=o}(o),o.PluginHooks.add("beforeGetCellMeta",function(t,e,o){if(o.isWritable=!o.readOnly,o.autoComplete)throw new Error("Support for legacy autocomplete syntax was removed in Handsontable 0.10.0. Please remove the property named 'autoComplete' from your config. For replacement instructions, see wiki page https://github.com/warpech/jquery-handsontable/wiki/Migration-guide-to-0.10.x")});var _=new r;o.PluginHooks.add("beforeInit",_.beforeInit),o.PluginHooks.add("afterInit",function(){_.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){_.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("afterGetColHeader",_.getColHeader),o.PluginHooks.add("modifyCol",_.modifyCol);var z=new s;o.PluginHooks.add("beforeInit",z.beforeInit),o.PluginHooks.add("afterInit",function(){z.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){z.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("afterGetColWidth",z.getColWidth),function Z(){function t(){var t=this,o=t.getSettings().observeChanges;o?(t.observer&&n.call(t),e.call(t),s.call(t)):o||n.call(t)}function e(){var t=this;t.observeChangesActive=!0,t.pauseObservingChanges=function(){t.observeChangesActive=!1},t.resumeObservingChanges=function(){t.observeChangesActive=!0},t.observedData=t.getData(),t.observer=B.observe(t.observedData,function(e){t.observeChangesActive&&(i.call(t,e),t.render()),t.runHooks("afterChangesObserved")})}function i(t){function e(t){var e;return e=i(t),e=o(e)}function o(t){var e=[];return t.filter(function(t){var o=n(t.path);if(-1!=["add","remove"].indexOf(t.op)&&!isNaN(o.col)){if(-1!=e.indexOf(o.col))return!1;e.push(o.col)}return!0})}function i(t){return t.filter(function(t){return!/[/]length/gi.test(t.path)})}function n(t){var e=t.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(e[1],10),col:/^\d*$/.test(e[2])?parseInt(e[2],10):e[2]}}for(var r=this,s=e(t),a=0,l=s.length;l>a;a++){var c=s[a],h=n(c.path);switch(c.op){case"add":isNaN(h.col)?r.runHooks("afterCreateRow",h.row):r.runHooks("afterCreateCol",h.col);break;case"remove":isNaN(h.col)?r.runHooks("afterRemoveRow",h.row,1):r.runHooks("afterRemoveCol",h.col,1);break;case"replace":r.runHooks("afterChange",[h.row,h.col,null,c.value],"external")}}}function n(){var t=this;t.observer&&(r.call(t),a.call(t))}function r(){var t=this;B.unobserve(t.observedData,t.observer),delete t.observeChangesActive,delete t.pauseObservingChanges,delete t.resumeObservingChanges}function s(){var t=this;t.addHook("afterDestroy",n),t.addHook("afterCreateRow",l),t.addHook("afterRemoveRow",l),t.addHook("afterCreateCol",l),t.addHook("afterRemoveCol",l),t.addHook("afterChange",function(t,e){"loadData"!=e&&l.call(this)})}function a(){var t=this;t.removeHook("afterDestroy",n),t.removeHook("afterCreateRow",l),t.removeHook("afterRemoveRow",l),t.removeHook("afterCreateCol",l),t.removeHook("afterRemoveCol",l),t.removeHook("afterChange",l)}function l(){var t=this;t.pauseObservingChanges(),t.addHookOnce("afterChangesObserved",function(){t.resumeObservingChanges()})}o.PluginHooks.add("afterLoadData",t),o.PluginHooks.add("afterUpdateSettings",t)}(),function(t){function e(){function e(){var t=this;for(var e in r)r.hasOwnProperty(e)&&!i.call(t,e)&&t.PluginHooks.add(e,r[e])}function o(){var t=this;for(var e in r)r.hasOwnProperty(e)&&i.call(t,e)&&t.PluginHooks.remove(e,r[e])}function i(t){var e=this;return e.PluginHooks.hooks.hasOwnProperty(t)}var n=this;this.init=function(){var i=this,r=i.getSettings().persistentState;return n.enabled=!!r,n.enabled?(i.storage||(i.storage=new t(i.rootElement[0].id)),i.resetState=n.resetValue,void e.call(i)):void o.call(i)},this.saveValue=function(t,e){var o=this;o.storage.saveValue(t,e)},this.loadValue=function(t,e){var o=this;e.value=o.storage.loadValue(t)},this.resetValue=function(t){var e=this;"undefined"!=typeof t?e.storage.reset(t):e.storage.resetAll()};var r={persistentStateSave:n.saveValue,persistentStateLoad:n.loadValue,persistentStateReset:n.resetValue}}var i=new e;o.PluginHooks.add("beforeInit",i.init),o.PluginHooks.add("afterUpdateSettings",i.init)}(a),function(e){e.UndoRedo=function(t){var o=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t,i){if(t){var n=new e.UndoRedo.ChangeAction(t);o.done(n)}}),t.addHook("afterCreateRow",function(t,i,n){if(!n){var r=new e.UndoRedo.CreateRowAction(t,i);o.done(r)}}),t.addHook("beforeRemoveRow",function(t,i){var n=o.instance.getData();t=(n.length+t)%n.length;var r=n.slice(t,t+i),s=new e.UndoRedo.RemoveRowAction(t,r);o.done(s)}),t.addHook("afterCreateCol",function(t,i,n){if(!n){var r=new e.UndoRedo.CreateColumnAction(t,i);o.done(r)}}),t.addHook("beforeRemoveCol",function(i,n){var r=o.instance.getData();i=(o.instance.countCols()+i)%o.instance.countCols();for(var s=[],a=0,l=r.length;l>a;a++)s[a]=r[a].slice(i,i+n);var c;e.helper.isArray(t.getSettings().colHeaders)&&(c=t.getSettings().colHeaders.slice(i,i+s.length));var h=new e.UndoRedo.RemoveColumnAction(i,s,c);o.done(h)})},e.UndoRedo.prototype.done=function(t){this.ignoreNewActions||(this.doneActions.push(t),this.undoneActions.length=0)},e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.pop();this.ignoreNewActions=!0,t.undo(this.instance),this.ignoreNewActions=!1,this.undoneActions.push(t)}},e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.pop();this.ignoreNewActions=!0,t.redo(this.instance),this.ignoreNewActions=!0,this.doneActions.push(t)}},e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},e.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},e.UndoRedo.Action=function(){},e.UndoRedo.Action.prototype.undo=function(){},e.UndoRedo.Action.prototype.redo=function(){},e.UndoRedo.ChangeAction=function(t){this.changes=t
},e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action),e.UndoRedo.ChangeAction.prototype.undo=function(e){for(var o=t.extend(!0,[],this.changes),i=0,n=o.length;n>i;i++)o[i].splice(3,1);e.setDataAtRowProp(o,null,null,"undo")},e.UndoRedo.ChangeAction.prototype.redo=function(e){for(var o=t.extend(!0,[],this.changes),i=0,n=o.length;n>i;i++)o[i].splice(2,1);e.setDataAtRowProp(o,null,null,"redo")},e.UndoRedo.CreateRowAction=function(t,e){this.index=t,this.amount=e},e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action),e.UndoRedo.CreateRowAction.prototype.undo=function(t){t.alter("remove_row",this.index,this.amount)},e.UndoRedo.CreateRowAction.prototype.redo=function(t){t.alter("insert_row",this.index+1,this.amount)},e.UndoRedo.RemoveRowAction=function(t,e){this.index=t,this.data=e},e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action),e.UndoRedo.RemoveRowAction.prototype.undo=function(t){var e=[this.index,0];Array.prototype.push.apply(e,this.data),Array.prototype.splice.apply(t.getData(),e),t.render()},e.UndoRedo.RemoveRowAction.prototype.redo=function(t){t.alter("remove_row",this.index,this.data.length)},e.UndoRedo.CreateColumnAction=function(t,e){this.index=t,this.amount=e},e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action),e.UndoRedo.CreateColumnAction.prototype.undo=function(t){t.alter("remove_col",this.index,this.amount)},e.UndoRedo.CreateColumnAction.prototype.redo=function(t){t.alter("insert_col",this.index+1,this.amount)},e.UndoRedo.RemoveColumnAction=function(t,e,o){this.index=t,this.data=e,this.amount=this.data[0].length,this.headers=o},e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action),e.UndoRedo.RemoveColumnAction.prototype.undo=function(t){for(var e,o,i=0,n=t.getData().length;n>i;i++)e=t.getDataAtRow(i),o=[this.index,0],Array.prototype.push.apply(o,this.data[i]),Array.prototype.splice.apply(e,o);"undefined"!=typeof this.headers&&(o=[this.index,0],Array.prototype.push.apply(o,this.headers),Array.prototype.splice.apply(t.getSettings().colHeaders,o)),t.render()},e.UndoRedo.RemoveColumnAction.prototype.redo=function(t){t.alter("remove_col",this.index,this.amount)}}(o),function(t){function e(){var e=this,s="undefined"==typeof e.getSettings().undo||e.getSettings().undo;s?e.undoRedo||(e.undoRedo=new t.UndoRedo(e),n(e),e.addHook("beforeKeyDown",o),e.addHook("afterChange",i)):e.undoRedo&&(delete e.undoRedo,r(e),e.removeHook("beforeKeyDown",o),e.removeHook("afterChange",i))}function o(t){var e=this,o=(t.ctrlKey||t.metaKey)&&!t.altKey;o&&(89===t.keyCode||t.shiftKey&&90===t.keyCode?(e.undoRedo.redo(),t.stopImmediatePropagation()):90===t.keyCode&&(e.undoRedo.undo(),t.stopImmediatePropagation()))}function i(t,e){var o=this;return"loadData"==e?o.undoRedo.clear():void 0}function n(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function r(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}t.PluginHooks.add("afterInit",e),t.PluginHooks.add("afterUpdateSettings",e)}(o),l.prototype.setBoundaries=function(t){this.boundaries=t},l.prototype.setCallback=function(t){this.callback=t},l.prototype.check=function(t,e){var o=0,i=0;e<this.boundaries.top?i=e-this.boundaries.top:e>this.boundaries.bottom&&(i=e-this.boundaries.bottom),t<this.boundaries.left?o=t-this.boundaries.left:t>this.boundaries.right&&(o=t-this.boundaries.right),this.callback(o,i)};var F=!1,j,U;if("undefined"!=typeof o){var $=function(t){var o=t.view.wt.wtScrollbars.vertical.scrollHandler;j=new l,o!==e&&(j.setBoundaries(o?o.getBoundingClientRect():t.$table[0].getBoundingClientRect()),j.setCallback(function(e,i){0>e?o?o.scrollLeft-=50:t.view.wt.scrollHorizontal(-1).draw():e>0&&(o?o.scrollLeft+=50:t.view.wt.scrollHorizontal(1).draw()),0>i?o?o.scrollTop-=20:t.view.wt.scrollVertical(-1).draw():i>0&&(o?o.scrollTop+=20:t.view.wt.scrollVertical(1).draw())}),F=!0)};o.PluginHooks.add("afterInit",function(){t(document).on("mouseup."+this.guid,function(){F=!1}),t(document).on("mousemove."+this.guid,function(t){F&&j.check(t.clientX,t.clientY)})}),o.PluginHooks.add("destroy",function(){t(document).off("."+this.guid)}),o.PluginHooks.add("afterOnCellMouseDown",function(){$(this)}),o.PluginHooks.add("afterOnCellCornerMouseDown",function(){$(this)})}if(function(t,e,o){function i(i){function n(){i.isListening()&&i.selection.empty()}function r(t){if(i.isListening()&&i.selection.isSelected()){var e=t.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),n=o.parse(e),r=i.getSelected(),s=i.getCornerCoords([{row:r[0],col:r[1]},{row:r[2],col:r[3]}]),a=s.TL,l={row:Math.max(s.BR.row,n.length-1+s.TL.row),col:Math.max(s.BR.col,n[0].length-1+s.TL.col)};i.PluginHooks.once("afterChange",function(t,e){t&&t.length&&this.selectCell(a.row,a.col,l.row,l.col)}),i.populateFromArray(a.row,a.col,n,l.row,l.col,"paste",i.getSettings().pasteMode)}}function s(e){if(t.helper.isCtrlKey(e.keyCode)&&i.getSelected())return a.setCopyableText(),void e.stopImmediatePropagation();var o=(e.ctrlKey||e.metaKey)&&!e.altKey;e.keyCode==t.helper.keyCode.A&&o&&setTimeout(t.helper.proxy(a.setCopyableText,a))}this.copyPasteInstance=e.getInstance(),this.copyPasteInstance.onCut(n),this.copyPasteInstance.onPaste(r);var a=this;i.addHook("beforeKeyDown",s),this.destroy=function(){this.copyPasteInstance.removeCallback(n),this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.destroy(),i.removeHook("beforeKeyDown",s)},i.addHook("afterDestroy",t.helper.proxy(this.destroy,this)),this.triggerPaste=t.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=t.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=i.getSelected(),e=i.getSettings(),o=e.copyRowsLimit,n=e.copyColsLimit,r=Math.min(t[0],t[2]),s=Math.min(t[1],t[3]),a=Math.max(t[0],t[2]),l=Math.max(t[1],t[3]),c=Math.min(a,r+o-1),h=Math.min(l,s+n-1);i.copyPaste.copyPasteInstance.copyable(i.getCopyableData(r,s,c,h)),(a!==c||l!==h)&&i.PluginHooks.run("afterCopyLimit",a-r+1,l-s+1,o,n)}}function n(){var t=this,e=t.getSettings().copyPaste!==!1;e&&!t.copyPaste?t.copyPaste=new i(t):!e&&t.copyPaste&&(t.copyPaste.destroy(),delete t.copyPaste)}t.PluginHooks.add("afterInit",n),t.PluginHooks.add("afterUpdateSettings",n)}(o,L,SheetClip),c.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.fixed.style.position="absolute",this.fixed.style.left="0",this.scrollHandler=this.getScrollableElement(this.TABLE),this.$scrollHandler=t(this.scrollHandler)},c.prototype.makeClone=function(t){var e=document.createElement("DIV");e.className="ht_clone_"+t+" handsontable",e.style.position="fixed",e.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,e.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(e),new m({cloneSource:this.instance,cloneOverlay:this,table:o})},c.prototype.getScrollableElement=function(t){for(var o=t.parentNode;o&&o.style;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(this instanceof D&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return e},c.prototype.prepare=function(){},c.prototype.onScroll=function(t){this.windowScrollPosition=this.getScrollPosition(),this.readSettings(),t&&(this.windowScrollPosition=t),this.resetFixedPosition()},c.prototype.availableSize=function(){var t;return t=this.windowScrollPosition>this.tableParentOffset?this.instance.wtTable.getLastVisibleRow()===this.total-1?this.instance.wtDom.outerHeight(this.TABLE):this.windowSize:this.windowSize-this.tableParentOffset},c.prototype.refresh=function(t){var e=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset),this.measureAfter=-1===e?0:this.sumCellSizes(e,this.total-e),this.applyToDOM(),this.clone&&this.clone.draw(t)},c.prototype.destroy=function(){this.$scrollHandler.off("."+this.instance.guid),t(e).off("."+this.instance.guid),t(document).off("."+this.instance.guid)},h.prototype.appear=function(t){var e,o,i,n,r,s,a,l,c,h,u,d;if(!this.disabled){var p=this.instance,f,g,m,w,y=!1,v=!1,C=!1,b=!1,S,T,E;for(p.wtTable.isRowInViewport(t[0])||(y=!0),p.wtTable.isRowInViewport(t[2])||(C=!0),T=p.wtTable.rowStrategy.countVisible(),S=0;T>S;S++)if(E=p.wtTable.rowFilter.visibleToSource(S),E>=t[0]&&E<=t[2]){f=E;break}for(S=T-1;S>=0;S--)if(E=p.wtTable.rowFilter.visibleToSource(S),E>=t[0]&&E<=t[2]){m=E;break}if(y&&C)v=!0,b=!0;else{for(p.wtTable.isColumnInViewport(t[1])||(v=!0),p.wtTable.isColumnInViewport(t[3])||(b=!0),T=p.wtTable.columnStrategy.countVisible(),S=0;T>S;S++)if(E=p.wtTable.columnFilter.visibleToSource(S),E>=t[1]&&E<=t[3]){g=E;break}for(S=T-1;S>=0;S--)if(E=p.wtTable.columnFilter.visibleToSource(S),E>=t[1]&&E<=t[3]){w=E;break}}if(void 0===f||void 0===g)return void this.disappear();e=f!==m||g!==w,o=p.wtTable.getCell([f,g]),i=e?p.wtTable.getCell([m,w]):o,n=this.wtDom.offset(o),r=e?this.wtDom.offset(i):n,s=this.wtDom.offset(p.wtTable.TABLE),l=n.top,u=r.top+this.wtDom.outerHeight(i)-l,h=n.left,d=r.left+this.wtDom.outerWidth(i)-h,a=l-s.top-1,c=h-s.left-1;var R=this.wtDom.getComputedStyle(o);parseInt(R.borderTopWidth,10)>0&&(a+=1,u=u>0?u-1:0),parseInt(R.borderLeftWidth,10)>0&&(c+=1,d=d>0?d-1:0),y?this.topStyle.display="none":(this.topStyle.top=a+"px",this.topStyle.left=c+"px",this.topStyle.width=d+"px",this.topStyle.display="block"),v?this.leftStyle.display="none":(this.leftStyle.top=a+"px",this.leftStyle.left=c+"px",this.leftStyle.height=u+"px",this.leftStyle.display="block");var x=Math.floor(this.settings.border.width/2);C?this.bottomStyle.display="none":(this.bottomStyle.top=a+u-x+"px",this.bottomStyle.left=c+"px",this.bottomStyle.width=d+"px",this.bottomStyle.display="block"),b?this.rightStyle.display="none":(this.rightStyle.top=a+"px",this.rightStyle.left=c+d-x+"px",this.rightStyle.height=u+1+"px",this.rightStyle.display="block"),C||b||!this.hasSetting(this.settings.border.cornerVisible)?this.cornerStyle.display="none":(this.cornerStyle.top=a+u-4+"px",this.cornerStyle.left=c+d-4+"px",this.cornerStyle.display="block")}},h.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none"},h.prototype.hasSetting=function(t){return"function"==typeof t?t():!!t},u.prototype.source=function(t){return t},u.prototype.offsetted=function(t){return t+this.offset},u.prototype.unOffsetted=function(t){return t-this.offset},u.prototype.fixed=function(t){return t<this.fixedCount?t-this.offset:t},u.prototype.unFixed=function(t){return t<this.fixedCount?t+this.offset:t},u.prototype.visibleToSource=function(t){return this.source(this.offsetted(this.fixed(t)))},u.prototype.sourceToVisible=function(t){return this.source(this.unOffsetted(this.unFixed(t)))},d.prototype.getSize=function(t){return this.cellSizes[t]},d.prototype.getContainerSize=function(t){return"function"==typeof this.containerSizeFn?this.containerSizeFn(t):this.containerSizeFn},d.prototype.countVisible=function(){return this.cellCount},d.prototype.isLastIncomplete=function(){if(this.instance.getSetting("nativeScrollbars")){var t=this.instance.cloneFrom?this.instance.cloneFrom.wtScrollbars.vertical:this.instance.wtScrollbars.vertical;return this.remainingSize>t.sumCellSizes(t.offset,t.offset+t.curOuts+1)}return this.remainingSize>0},p.prototype.add=function(t,e,o){this.cache[t]||(this.cache[t]=[]),this.cache[t][e]||(this.cache[t][e]=[]),this.cache[t][e][o]=!0},p.prototype.test=function(t,e,o){return this.cache[t]&&this.cache[t][e]&&this.cache[t][e][o]},f.prototype=new u,f.prototype.readSettings=function(t){this.offset=t.wtSettings.settings.offsetColumn,this.total=t.getSetting("totalColumns"),this.fixedCount=t.getSetting("fixedColumnsLeft"),this.countTH=t.getSetting("rowHeaders").length},f.prototype.offsettedTH=function(t){return t-this.countTH},f.prototype.unOffsettedTH=function(t){return t+this.countTH},f.prototype.visibleRowHeadedColumnToSourceColumn=function(t){return this.visibleToSource(this.offsettedTH(t))},f.prototype.sourceColumnToVisibleRowHeadedColumn=function(t){return this.unOffsettedTH(this.sourceToVisible(t))},g.prototype=new d,g.prototype.getSize=function(t){return this.cellSizes[t]+(this.cellStretch[t]||0)},g.prototype.stretch=function(){var t=this.getContainerSize(this.cellSizesSum),e=0;if(this.remainingSize=this.cellSizesSum-t,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o=t/this.cellSizesSum,i;e<this.cellCount-1;)i=Math.floor(o*this.cellSizes[e]),this.remainingSize+=i-this.cellSizes[e],this.cellStretch[e]=i-this.cellSizes[e],e++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&1/0!==t&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},m.prototype.draw=function(t){return this.drawInterrupted=!1,t||this.wtDom.isVisible(this.wtTable.TABLE)?(this.getSetting("beforeDraw",!t),t=t&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn,this.drawn&&(this.scrollVertical(0),this.scrollHorizontal(0)),this.lastOffsetRow=this.getSetting("offsetRow"),this.lastOffsetColumn=this.getSetting("offsetColumn"),this.wtTable.draw(t),this.cloneSource||this.getSetting("onDraw",!t),this):void(this.drawInterrupted=!0)},m.prototype.update=function(t,e){return this.wtSettings.update(t,e)},m.prototype.scrollVertical=function(t){var e=this.wtScroll.scrollVertical(t);return this.getSetting("onScrollVertically"),e},m.prototype.scrollHorizontal=function(t){var e=this.wtScroll.scrollHorizontal(t);return this.getSetting("onScrollHorizontally"),e},m.prototype.scrollViewport=function(t){return this.wtScroll.scrollViewport(t),this},m.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},m.prototype.getSetting=function(t,e,o,i){return this.wtSettings.getSetting(t,e,o,i)},m.prototype.hasSetting=function(t){return this.wtSettings.has(t)},m.prototype.destroy=function(){t(document.body).off("."+this.guid),this.wtScrollbars.destroy(),clearTimeout(this.wheelTimeout),this.wtEvent&&this.wtEvent.destroy()},w.prototype=new c,w.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=this.instance.wtTable.holder.getBoundingClientRect();t.style.top=Math.ceil(e.top,10)+"px",t.style.left=Math.ceil(e.left,10)+"px"}},w.prototype.prepare=function(){},w.prototype.refresh=function(t){this.clone&&this.clone.draw(t)},w.prototype.getScrollPosition=function(){},w.prototype.getLastCell=function(){},w.prototype.applyToDOM=function(){},w.prototype.scrollTo=function(){},w.prototype.readWindowSize=function(){},w.prototype.readSettings=function(){},y.prototype.closest=function(t,e,o){for(;null!=t&&t!==o;){if(1===t.nodeType&&e.indexOf(t.nodeName)>-1)return t;t=t.parentNode}return null},y.prototype.isChildOf=function(t,e){for(var o=t.parentNode;null!=o;){if(o==e)return!0;o=o.parentNode}return!1},y.prototype.index=function(t){for(var e=0;t=t.previousSibling;)++e;return e},document.documentElement.classList?(y.prototype.hasClass=function(t,e){return t.classList.contains(e)},y.prototype.addClass=function(t,e){t.classList.add(e)},y.prototype.removeClass=function(t,e){t.classList.remove(e)}):(y.prototype.hasClass=function(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},y.prototype.addClass=function(t,e){this.hasClass(t,e)||(t.className+=" "+e)},y.prototype.removeClass=function(t,e){if(this.hasClass(t,e)){var o=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(o," ").trim()}}),y.prototype.removeTextNodes=function(t,e){if(3===t.nodeType)e.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var o=t.childNodes,i=o.length-1;i>=0;i--)this.removeTextNodes(o[i],t)},y.prototype.empty=function(t){for(var e;e=t.lastChild;)t.removeChild(e)},y.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,y.prototype.fastInnerHTML=function(t,e){this.HTML_CHARACTERS.test(e)?t.innerHTML=e:this.fastInnerText(t,e)},y.prototype.fastInnerText=document.createTextNode("test").textContent?function(t,e){var o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=e:(this.empty(t),t.appendChild(document.createTextNode(e)))}:function(t,e){var o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=e:(this.empty(t),t.appendChild(document.createTextNode(e)))},y.prototype.isVisible=function(t){for(var e=t;e!==document.documentElement;){if(null===e)return!1;if(11===e.nodeType){if(e.host){if(e.host.impl)return y.prototype.isVisible(e.host.impl);if(e.host)return y.prototype.isVisible(e.host);throw new Error("Lost in Web Components world")}return!1}if("none"===e.style.display)return!1;e=e.parentNode}return!0},y.prototype.offset=function(t){if(this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName){var o=t.getBoundingClientRect();return{top:o.top+(e.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:o.left+(e.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}for(var i=t.offsetLeft,n=t.offsetTop,r=t;(t=t.offsetParent)&&t!==document.body;)i+=t.offsetLeft,n+=t.offsetTop,r=t;return r&&"fixed"===r.style.position&&(i+=e.pageXOffset||document.documentElement.scrollLeft,n+=e.pageYOffset||document.documentElement.scrollTop),{left:i,top:n}},y.prototype.getComputedStyle=function(t){return t.currentStyle||document.defaultView.getComputedStyle(t)},y.prototype.outerWidth=function(t){return t.offsetWidth},y.prototype.outerHeight=function(t){return this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight},function(){function t(){var t=document.createElement("TABLE");t.style.borderSpacing=0,t.style.borderWidth=0,t.style.padding=0;var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var i=document.createElement("CAPTION");i.innerHTML="c<br>c<br>c<br>c",i.style.padding=0,i.style.margin=0,t.insertBefore(i,e),document.body.appendChild(t),o=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function e(){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),(document.body||document.documentElement).appendChild(e);var o=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;return o==i&&(i=e.clientWidth),(document.body||document.documentElement).removeChild(e),o-i}var o;y.prototype.hasCaptionProblem=function(){return void 0===o&&t(),o},y.prototype.getCaretPosition=function(t){if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null==e)return 0;var o=t.createTextRange(),i=o.duplicate();return o.moveToBookmark(e.getBookmark()),i.setEndPoint("EndToStart",o),i.text.length}return 0},y.prototype.setCaretPosition=function(t,e,o){if(void 0===o&&(o=e),t.setSelectionRange)t.focus(),t.setSelectionRange(e,o);else if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveEnd("character",o),i.moveStart("character",e),i.select()}};var i;y.prototype.getScrollbarWidth=function(){return void 0===i&&(i=e()),i}}(),v.prototype.parentCell=function(t){var e={},o=this.instance.wtTable.TABLE,i=this.wtDom.closest(t,["TD","TH"],o);return i&&this.wtDom.isChildOf(i,o)?(e.coords=this.instance.wtTable.getCoords(i),e.TD=i):this.wtDom.hasClass(t,"wtBorder")&&this.wtDom.hasClass(t,"current")&&(e.coords=this.instance.selections.current.selected[0],e.TD=this.instance.wtTable.getCell(e.coords)),e},v.prototype.destroy=function(){clearTimeout(this.dblClickTimeout0),clearTimeout(this.dblClickTimeout1)},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,o){return e.setTimeout(t,1e3/60)}}(),e.cancelRequestAnimFrame=function(){return e.cancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),e.getComputedStyle||!function(){var t,o={getPropertyValue:function i(e){return"float"==e&&(e="styleFloat"),t.currentStyle[e.toUpperCase()]||null}};e.getComputedStyle=function(e){return t=e,o}}(),!String.prototype.trim){var G=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(G,"")}}S.prototype=new u,S.prototype.readSettings=function(t){this.offset=t.cloneOverlay instanceof w?0:t.wtSettings.settings.offsetRow,this.total=t.getSetting("totalRows"),this.fixedCount=t.getSetting("fixedRowsTop")},T.prototype=new d,T.prototype.add=function(t,e,o){if(!this.isLastIncomplete()&&0!=this.remainingSize){var i=this.sizeAtIndex(t,e);if(void 0===i)return!1;var n=this.getContainerSize(this.cellSizesSum+i);return o?this.cellSizes.unshift(i):this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,this.remainingSize=this.cellSizesSum-n,o&&this.isLastIncomplete()?!1:!0}return!1},T.prototype.remove=function(){var t=this.cellSizes.pop();this.cellSizesSum-=t,this.cellCount--,this.remainingSize-=t},T.prototype.removeOutstanding=function(){for(;this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize;)this.remove()},E.prototype.scrollVertical=function(t){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var e=this.instance,o,i=e.getSetting("offsetRow"),n=e.getSetting("fixedRowsTop"),r=e.getSetting("totalRows"),s=e.wtViewport.getViewportHeight();return o=r>0?this.scrollLogicVertical(t,i,r,n,s,function(t){return n>t-i&&t-i>=0?e.getSetting("rowHeight",t-i):e.getSetting("rowHeight",t)},function(t){e.wtTable.verticalRenderReverse=t}):0,o!==i&&this.instance.wtScrollbars.vertical.scrollTo(o),e},E.prototype.scrollHorizontal=function(t){if(!this.instance.drawn)throw new Error("scrollHorizontal can only be called after table was drawn to DOM");var e=this.instance,o,i=e.getSetting("offsetColumn"),n=e.getSetting("fixedColumnsLeft"),r=e.getSetting("totalColumns"),s=e.wtViewport.getViewportWidth();return o=r>0?this.scrollLogicHorizontal(t,i,r,n,s,function(t){return n>t-i&&t-i>=0?e.getSetting("columnWidth",t-i):e.getSetting("columnWidth",t)}):0,o!==i&&this.instance.wtScrollbars.horizontal.scrollTo(o),e},E.prototype.scrollLogicVertical=function(t,e,o,i,n,r,s){var a=e+t;return a>=o-i&&(a=o-i-1,s(!0)),0>a&&(a=0),a},E.prototype.scrollLogicHorizontal=function(t,e,o,i,n,r){var s=e+t,a=0,l;if(s>i){for(s>=o-i&&(s=o-i-1),l=s;n>a&&o>l;)a+=r(l),l++;if(n>a)for(;s>0&&(a+=r(s-1),n>a);)s--}else 0>s&&(s=0);return s},E.prototype.scrollViewport=function(t){if(this.instance.drawn){var o=this.instance.getSetting("offsetRow"),i=this.instance.getSetting("offsetColumn"),n=this.instance.wtTable.getLastVisibleRow(),r=this.instance.getSetting("totalRows"),s=this.instance.getSetting("totalColumns"),a=this.instance.getSetting("fixedRowsTop"),l=this.instance.getSetting("fixedColumnsLeft");if(this.instance.getSetting("nativeScrollbars")){var c=this.instance.wtTable.getCell(t);if("object"==typeof c){var h=y.prototype.offset(c),u=y.prototype.outerWidth(c),d=y.prototype.outerHeight(c),p=this.instance.wtScrollbars.horizontal.getScrollPosition(),f=this.instance.wtScrollbars.vertical.getScrollPosition(),g=y.prototype.outerWidth(this.instance.wtScrollbars.horizontal.scrollHandler),m=y.prototype.outerHeight(this.instance.wtScrollbars.vertical.scrollHandler);return this.instance.wtScrollbars.horizontal.scrollHandler!==e&&(h.left=h.left-y.prototype.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left),this.instance.wtScrollbars.vertical.scrollHandler!==e&&(h.top=h.top-y.prototype.offset(this.instance.wtScrollbars.vertical.scrollHandler).top),g-=20,m-=20,g>u&&(h.left<p?this.instance.wtScrollbars.horizontal.setScrollPosition(h.left):h.left+u>p+g&&this.instance.wtScrollbars.horizontal.setScrollPosition(h.left-g+u)),void(m>d&&(h.top<f?this.instance.wtScrollbars.vertical.setScrollPosition(h.top):h.top+d>f+m&&this.instance.wtScrollbars.vertical.setScrollPosition(h.top-m+d)))}}if(t[0]<0||t[0]>r-1)throw new Error("row "+t[0]+" does not exist");if(t[1]<0||t[1]>s-1)throw new Error("column "+t[1]+" does not exist");if(t[0]>n?(this.scrollVertical(t[0]-a-o),this.instance.wtTable.verticalRenderReverse=!0):t[0]===n&&this.instance.wtTable.rowStrategy.isLastIncomplete()?(this.scrollVertical(t[0]-a-o),this.instance.wtTable.verticalRenderReverse=!0):this.scrollVertical(t[0]-a<o?t[0]-a-o:0),this.instance.wtTable.isColumnBeforeViewport(t[1]))this.instance.wtScrollbars.horizontal.scrollTo(t[1]-l);else if(this.instance.wtTable.isColumnAfterViewport(t[1])||this.instance.wtTable.getLastVisibleColumn()===t[1]&&!this.instance.wtTable.isLastColumnFullyVisible()){for(var w=0,v=0;l>v;v++)w+=this.instance.getSetting("columnWidth",v);var C=t[1];w+=this.instance.getSetting("columnWidth",C);var b=this.instance.wtViewport.getViewportWidth();if(b>w)for(var S=this.instance.getSetting("columnWidth",C-1);b>=w+S&&C>=l;)C--,w+=S,S=this.instance.getSetting("columnWidth",C-1);this.instance.wtScrollbars.horizontal.scrollTo(C-l)}return this.instance}},R.prototype.init=function(){var e=this;this.$table=t(this.instance.wtTable.TABLE),this.slider=document.createElement("DIV"),this.sliderStyle=this.slider.style,this.sliderStyle.position="absolute",this.sliderStyle.top="0",this.sliderStyle.left="0",this.sliderStyle.display="none",this.slider.className="dragdealer "+this.type,this.handle=document.createElement("DIV"),this.handleStyle=this.handle.style,this.handle.className="handle",this.slider.appendChild(this.handle),this.container=this.instance.wtTable.holder,this.container.appendChild(this.slider);var o=!0;this.dragTimeout=null;var i,n=function(){e.onScroll(i)};this.dragdealer=new J(this.slider,{vertical:"vertical"===this.type,horizontal:"horizontal"===this.type,slide:!1,speed:100,animationCallback:function(t,r){return o?void(o=!1):(e.skipRefresh=!0,i="vertical"===e.type?r:t,void(null===e.dragTimeout&&(e.dragTimeout=setInterval(n,100),n())))},callback:function(t,o){e.skipRefresh=!1,clearInterval(e.dragTimeout),e.dragTimeout=null,i="vertical"===e.type?o:t,e.onScroll(i)}}),this.skipRefresh=!1},R.prototype.onScroll=function(t){if(this.instance.drawn&&(this.readSettings(),this.total>this.visibleCount)){var e=Math.round(this.handlePosition*this.total/this.sliderSize);1===t?"vertical"===this.type?this.instance.scrollVertical(1/0).draw():this.instance.scrollHorizontal(1/0).draw():e!==this.offset?"vertical"===this.type?this.instance.scrollVertical(e-this.offset).draw():this.instance.scrollHorizontal(e-this.offset).draw():this.refresh()}},R.prototype.getHandleSizeRatio=function(t,e){return!e||t>e||t==e?1:1/e},R.prototype.prepare=function(){if(!this.skipRefresh){var t=this.getHandleSizeRatio(this.visibleCount,this.total);this.visible=(1===t||isNaN(t))&&"auto"===this.scrollMode||"none"===this.scrollMode?!1:!0}},R.prototype.refresh=function(){if(!this.skipRefresh){if(!this.visible)return void(this.sliderStyle.display="none");var t,e,o,i,n=this.visibleCount,r=this.instance.wtViewport.getWorkspaceWidth(),s=this.instance.wtViewport.getWorkspaceHeight();1/0===r&&(r=this.instance.wtViewport.getWorkspaceActualWidth()),1/0===s&&(s=this.instance.wtViewport.getWorkspaceActualHeight()),"vertical"===this.type?(this.instance.wtTable.rowStrategy.isLastIncomplete()&&n--,e=s-2,this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px",this.sliderStyle.left=r-1+"px",this.sliderStyle.height=Math.max(e,0)+"px"):(e=r-2,this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px",this.sliderStyle.top=s-1+"px",this.sliderStyle.width=Math.max(e,0)+"px"),t=this.getHandleSizeRatio(n,this.total),o=Math.round(e*t),10>o&&(o=15),i=Math.floor(e*(this.offset/this.total)),o+i>e&&(i=e-o),"vertical"===this.type?(this.handleStyle.height=o+"px",this.handleStyle.top=i+"px"):(this.handleStyle.width=o+"px",this.handleStyle.left=i+"px"),this.sliderStyle.display="block"}},R.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var K=function(t){this.instance=t,this.type="vertical",this.init()};K.prototype=new R,K.prototype.scrollTo=function(t){this.instance.update("offsetRow",t)},K.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV"),this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows"),this.visibleCount=this.instance.wtTable.rowStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.top,10),this.sliderSize=parseInt(this.sliderStyle.height,10),this.fixedCount=this.instance.getSetting("fixedRowsTop")};var X=function(t){this.instance=t,this.type="horizontal",this.init()};X.prototype=new R,X.prototype.scrollTo=function(t){this.instance.update("offsetColumn",t)},X.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH"),this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns"),this.visibleCount=this.instance.wtTable.columnStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.left,10),this.sliderSize=parseInt(this.sliderStyle.width,10),this.fixedCount=this.instance.getSetting("fixedColumnsLeft")},X.prototype.getHandleSizeRatio=function(t,e){return!e||t>e||t==e?1:t/e},x.prototype=new c,x.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,o;if(this.scrollHandler===e){o=this.instance.wtTable.hider.getBoundingClientRect();var i=Math.ceil(o.top,10),n=Math.ceil(o.bottom,10);t.style.top=0>i&&n>0?"0":i+"px";var r=Math.ceil(o.left,10),s=Math.ceil(o.right,10);t.style.left=0>r&&s>0?"0":r+"px"}else o=this.scrollHandler.getBoundingClientRect(),t.style.top=Math.ceil(o.top,10)+"px",t.style.left=Math.ceil(o.left,10)+"px";t.style.width=y.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px",t.style.height=y.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},x.prototype.prepare=function(){},x.prototype.refresh=function(t){this.measureBefore=0,this.measureAfter=0,this.clone&&this.clone.draw(t)},x.prototype.getScrollPosition=function(){},x.prototype.getLastCell=function(){},x.prototype.applyToDOM=function(){},x.prototype.scrollTo=function(){},x.prototype.readWindowSize=function(){},x.prototype.readSettings=function(){},D.prototype=new c,D.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,o;if(this.scrollHandler===e){o=this.instance.wtTable.hider.getBoundingClientRect();var i=Math.ceil(o.left,10),n=Math.ceil(o.right,10);t.style.left=0>i&&n>0?"0":i+"px"}else o=this.scrollHandler.getBoundingClientRect(),t.style.top=Math.ceil(o.top,10)+"px",t.style.left=Math.ceil(o.left,10)+"px"}},D.prototype.react=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode;if(this.instance.wtScrollbars.vertical.scrollHandler===e){var o=this.instance.wtTable.hider.getBoundingClientRect();
t.style.top=Math.ceil(o.top,10)+"px",t.style.height=y.prototype.outerHeight(this.clone.wtTable.TABLE)+"px"}else this.clone.wtTable.holder.style.top=-(this.instance.wtScrollbars.vertical.windowScrollPosition-this.instance.wtScrollbars.vertical.measureBefore)+"px",t.style.height=this.instance.wtViewport.getWorkspaceHeight()+"px";t.style.width=y.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},D.prototype.prepare=function(){},D.prototype.refresh=function(t){this.measureBefore=0,this.measureAfter=0,this.clone&&this.clone.draw(t)},D.prototype.getScrollPosition=function(){return this.scrollHandler===e?this.scrollHandler.scrollX:this.scrollHandler.scrollLeft},D.prototype.setScrollPosition=function(t){this.scrollHandler.scrollLeft=t},D.prototype.onScroll=function(){c.prototype.onScroll.apply(this,arguments),this.instance.getSetting("onScrollHorizontally")},D.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()},D.prototype.applyToDOM=function(){this.fixedContainer.style.paddingLeft=this.measureBefore+"px",this.fixedContainer.style.paddingRight=this.measureAfter+"px"},D.prototype.scrollTo=function(t){this.$scrollHandler.scrollLeft(this.tableParentOffset+t*this.cellSize)},D.prototype.readWindowSize=function(){this.scrollHandler===e?(this.windowSize=document.documentElement.clientWidth,this.tableParentOffset=this.instance.wtTable.holderOffset.left):(this.windowSize=y.prototype.outerWidth(this.scrollHandler),this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},D.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns")},H.prototype=new c,H.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,o;if(this.scrollHandler===e){o=this.instance.wtTable.hider.getBoundingClientRect();var i=Math.ceil(o.top,10),n=Math.ceil(o.bottom,10);t.style.top=0>i&&n>0?"0":i+"px"}else o=this.instance.wtScrollbars.horizontal.scrollHandler.getBoundingClientRect(),t.style.top=Math.ceil(o.top,10)+"px",t.style.left=Math.ceil(o.left,10)+"px";t.style.width=this.instance.wtScrollbars.horizontal.scrollHandler===e?this.instance.wtViewport.getWorkspaceActualWidth()+"px":y.prototype.outerWidth(this.instance.wtTable.holder.parentNode)+"px",t.style.height=y.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},H.prototype.react=function(){if(this.instance.wtTable.holder.parentNode&&this.instance.wtScrollbars.horizontal.scrollHandler!==e){var t=this.clone.wtTable.holder.parentNode;t.firstChild.style.left=-this.instance.wtScrollbars.horizontal.windowScrollPosition+"px"}},H.prototype.getScrollPosition=function(){return this.scrollHandler===e?this.scrollHandler.scrollY:this.scrollHandler.scrollTop},H.prototype.setScrollPosition=function(t){this.scrollHandler.scrollTop=t},H.prototype.onScroll=function(t){c.prototype.onScroll.apply(this,arguments);var e,o=0;if(!0&&(e=this.windowScrollPosition-this.tableParentOffset,Y=0,e>0)){for(var i=0,n,r=0;r<this.total&&(n=this.instance.getSetting("rowHeight",r),i+=n,!(i>e));r++);this.offset>0&&(Y=i-e),o=r,o=Math.min(o,this.total)}this.curOuts=o>this.maxOuts?this.maxOuts:o,o-=this.curOuts,this.instance.update("offsetRow",o),this.readSettings(),this.instance.draw(),this.instance.getSetting("onScrollVertically")},H.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};var Y=0;H.prototype.sumCellSizes=function(t,e){for(var o=0;e>t;)o+=this.instance.getSetting("rowHeight",t),t++;return o},H.prototype.applyToDOM=function(){var t=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=t+this.sumCellSizes(0,this.total)+4+"px",this.fixed.style.top=this.measureBefore+"px",this.fixed.style.bottom=""},H.prototype.scrollTo=function(t){var e=this.tableParentOffset+t*this.cellSize;this.$scrollHandler.scrollTop(e),this.onScroll(e)},H.prototype.readWindowSize=function(){this.scrollHandler===e?(this.windowSize=document.documentElement.clientHeight,this.tableParentOffset=this.instance.wtTable.holderOffset.top):(this.windowSize=this.scrollHandler.clientHeight,this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},H.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows")},k.prototype.registerListeners=function(){function o(){return i.instance.wtTable.holder.parentNode?(i.vertical.windowScrollPosition=i.vertical.getScrollPosition(),i.horizontal.windowScrollPosition=i.horizontal.getScrollPosition(),i.box=i.instance.wtTable.hider.getBoundingClientRect(),i.box.width===l&&i.box.height===c||!i.instance.rowHeightCache||(l=i.box.width,c=i.box.height,i.instance.draw()),void((i.vertical.windowScrollPosition!==n||i.horizontal.windowScrollPosition!==r||i.box.top!==s||i.box.left!==a)&&(i.vertical.onScroll(),i.horizontal.onScroll(),i.vertical.react(),i.horizontal.react(),n=i.vertical.windowScrollPosition,r=i.horizontal.windowScrollPosition,s=i.box.top,a=i.box.left))):void i.destroy()}var i=this,n,r,s,a,l,c,h=t(e);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,o),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,o),this.vertical.scrollHandler!==e&&this.horizontal.scrollHandler!==e&&h.on("scroll."+this.instance.guid,o),h.on("load."+this.instance.guid,o),h.on("resize."+this.instance.guid,o),t(document).on("ready."+this.instance.guid,o),setInterval(o,100)},k.prototype.destroy=function(){this.vertical&&this.vertical.destroy(),this.horizontal&&this.horizontal.destroy()},k.prototype.refresh=function(t){this.horizontal&&this.horizontal.readSettings(),this.vertical&&this.vertical.readSettings(),this.horizontal&&this.horizontal.prepare(),this.vertical&&this.vertical.prepare(),this.horizontal&&this.horizontal.refresh(t),this.vertical&&this.vertical.refresh(t),this.corner&&this.corner.refresh(t),this.debug&&this.debug.refresh(t)},A.prototype.add=function(t){this.selected.push(t)},A.prototype.clear=function(){this.selected.length=0},A.prototype.getCorners=function(){var t,e,o,i,n,r=this.selected.length;if(r>0&&(t=o=this.selected[0][0],e=i=this.selected[0][1],r>1))for(n=1;r>n;n++)this.selected[n][0]<t?t=this.selected[n][0]:this.selected[n][0]>o&&(o=this.selected[n][0]),this.selected[n][1]<e?e=this.selected[n][1]:this.selected[n][1]>i&&(i=this.selected[n][1]);return[t,e,o,i]},A.prototype.draw=function(){var t,e,o,i,n,r=this.instance.wtTable.rowStrategy.countVisible(),s=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){for(t=this.getCorners(),e=0;r>e;e++)for(o=0;s>o;o++)i=this.instance.wtTable.rowFilter.visibleToSource(e),n=this.instance.wtTable.columnFilter.visibleToSource(o),i>=t[0]&&i<=t[2]&&n>=t[1]&&n<=t[3]?this.instance.wtTable.currentCellCache.add(e,o,this.settings.className):i>=t[0]&&i<=t[2]?this.instance.wtTable.currentCellCache.add(e,o,this.settings.highlightRowClassName):n>=t[1]&&n<=t[3]&&this.instance.wtTable.currentCellCache.add(e,o,this.settings.highlightColumnClassName);this.border&&this.border.appear(t)}else this.border&&this.border.disappear()},P.prototype.update=function(t,e){if(void 0===e)for(var o in t)t.hasOwnProperty(o)&&(this.settings[o]=t[o]);else this.settings[t]=e;return this.instance},P.prototype.getSetting=function(t,e,o,i){return this[t]?this[t](e,o,i):this._getSetting(t,e,o,i)},P.prototype._getSetting=function(t,e,o,i){return"function"==typeof this.settings[t]?this.settings[t](e,o,i):void 0!==e&&"[object Array]"===Object.prototype.toString.call(this.settings[t])?this.settings[t][e]:this.settings[t]},P.prototype.has=function(t){return!!this.settings[t]},P.prototype.rowHeight=function(t,e){if(this.instance.rowHeightCache||(this.instance.rowHeightCache=[]),void 0===this.instance.rowHeightCache[t]){var o=23;return e&&(o=this.instance.wtDom.outerHeight(e),this.instance.rowHeightCache[t]=o),o}return this.instance.rowHeightCache[t]},O.prototype.refreshHiderDimensions=function(){var t=this.instance.wtViewport.getWorkspaceHeight(),e=this.instance.wtViewport.getWorkspaceWidth(),o=this.spreader.style;1/0===t&&1/0===e||this.instance.getSetting("nativeScrollbars")?(o.position="relative",o.width="auto",o.height="auto"):(1/0===t&&(t=this.instance.wtViewport.getWorkspaceActualHeight()),1/0===e&&(e=this.instance.wtViewport.getWorkspaceActualWidth()),this.hiderStyle.overflow="hidden",o.position="absolute",o.top="0",o.left="0",this.instance.getSetting("nativeScrollbars")||(o.height="4000px",o.width="4000px"),0>t&&(t=0),this.hiderStyle.height=t+"px",this.hiderStyle.width=e+"px")},O.prototype.refreshStretching=function(){if(!this.instance.cloneSource){var t=this.instance,e=t.getSetting("stretchH"),o=t.getSetting("totalRows"),i=t.getSetting("totalColumns"),n=t.getSetting("offsetColumn"),r=function(t){var e=s.instance.wtViewport.getViewportWidth(t);return t>e&&s.instance.getSetting("nativeScrollbars")?1/0:e},s=this,a=function(e){var o=s.columnFilter.visibleToSource(e);return i>o?t.getSetting("columnWidth",o):void 0};"hybrid"===e&&(e=n>0?"last":"none");var l=function(t){return s.instance.getSetting("nativeScrollbars")?s.instance.cloneOverlay instanceof w?1/0:2*s.instance.wtViewport.getViewportHeight(t):s.instance.wtViewport.getViewportHeight(t)},c=function(t,e){if(s.instance.getSetting("nativeScrollbars"))return 20;var i=s.rowFilter.visibleToSource(t);return o>i?s.verticalRenderReverse&&0===t?s.instance.getSetting("rowHeight",i,e)-1:s.instance.getSetting("rowHeight",i,e):void 0};this.columnStrategy=new g(t,r,a,e),this.rowStrategy=new T(t,l,c)}},O.prototype.adjustAvailableNodes=function(){for(var t,e=this.instance.getSetting("rowHeaders"),o=e.length,i=this.instance.getSetting("columnHeaders"),n,r,s;this.colgroupChildrenLength<o;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(this.refreshStretching(),t=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof D||this.instance.cloneOverlay instanceof x)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount;this.colgroupChildrenLength<t+o;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(;this.colgroupChildrenLength>t+o;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.colgroupChildrenLength--;if(n=this.THEAD.firstChild,i.length){for(n||(n=document.createElement("TR"),this.THEAD.appendChild(n)),this.theadChildrenLength=n.childNodes.length;this.theadChildrenLength<t+o;)n.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>t+o;)n.removeChild(n.lastChild),this.theadChildrenLength--}else n&&this.wtDom.empty(n);for(s=0;s<this.colgroupChildrenLength;s++)o>s?this.wtDom.addClass(this.COLGROUP.childNodes[s],"rowHeader"):this.wtDom.removeClass(this.COLGROUP.childNodes[s],"rowHeader");if(i.length&&(n=this.THEAD.firstChild,o))for(r=n.firstChild,s=0;o>s;s++)e[s](-o+s,r),r=r.nextSibling;for(s=0;t>s;s++)i.length&&i[0](this.columnFilter.visibleToSource(s),n.childNodes[o+s])},O.prototype.adjustColumns=function(t,e){for(var o=t.childNodes.length;e>o;){var i=document.createElement("TD");t.appendChild(i),o++}for(;o>e;)t.removeChild(t.lastChild),o--},O.prototype.draw=function(t){return this.instance.getSetting("nativeScrollbars")&&(this.verticalRenderReverse=!1),this.rowFilter.readSettings(this.instance),this.columnFilter.readSettings(this.instance),t?this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0):(this.instance.getSetting("nativeScrollbars")?this.instance.cloneSource?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:(this.holderOffset=this.wtDom.offset(this.holder),this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtScrollbars.vertical.readWindowSize(),this.instance.wtScrollbars.horizontal.readWindowSize(),this.instance.wtViewport.resetSettings()):(this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtViewport.resetSettings()),this._doDraw()),this.refreshPositions(t),t||this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition(),this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition())),this.instance.drawn=!0,this},O.prototype._doDraw=function(){var t=0,e,o,i,n=this.instance.getSetting("offsetRow"),r=this.instance.getSetting("totalRows"),s=this.instance.getSetting("totalColumns"),a,l=this.instance.getSetting("rowHeaders"),c=l.length,h,u,d,p=!1,f,g,m;this.verticalRenderReverse&&(g=n);var y=!1;if(this.verticalRenderReverse&&(n===r-this.rowFilter.fixedCount-1?y=!0:(this.instance.update("offsetRow",n+1),this.rowFilter.readSettings(this.instance))),this.instance.cloneSource&&(this.columnStrategy=this.instance.cloneSource.wtTable.columnStrategy,this.rowStrategy=this.instance.cloneSource.wtTable.rowStrategy),s>0){e=this.rowFilter.visibleToSource(t);var v=this.instance.getSetting("fixedRowsTop"),C;for(this.instance.cloneSource&&(this.instance.cloneOverlay instanceof H||this.instance.cloneOverlay instanceof x?C=v:this.instance.cloneOverlay instanceof D&&(C=this.rowStrategy.countVisible())),this.adjustAvailableNodes(),p=!0,a=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof D||this.instance.cloneOverlay instanceof x)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount,this.instance.cloneSource||(f=this.instance.wtViewport.getWorkspaceWidth(),this.columnStrategy.stretch()),o=0;a>o;o++)this.COLGROUP.childNodes[o+c].style.width=this.columnStrategy.getSize(o)+"px";for(;r>e&&e>=0;){if(t>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==C&&t===C)break;if(t>=this.tbodyChildrenLength||this.verticalRenderReverse&&t>=this.rowFilter.fixedCount){for(h=document.createElement("TR"),o=0;c>o;o++)h.appendChild(document.createElement("TH"));this.verticalRenderReverse&&t>=this.rowFilter.fixedCount?this.TBODY.insertBefore(h,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild):this.TBODY.appendChild(h),this.tbodyChildrenLength++}else h=0===t?this.TBODY.firstChild:h.nextSibling;for(d=h.firstChild,o=0;c>o;o++)"TD"==d.nodeName&&(u=d,d=document.createElement("TH"),h.insertBefore(d,u),h.removeChild(u)),l[o](e,d),d=d.nextSibling;for(this.adjustColumns(h,a+c),o=0;a>o;o++)i=this.columnFilter.visibleToSource(o),u=0===o?h.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:u.nextSibling,"TH"==u.nodeName&&(d=u,u=document.createElement("TD"),h.insertBefore(u,d),h.removeChild(d)),u.className="",u.removeAttribute("style"),this.instance.getSetting("cellRenderer",e,i,u);if(n=this.instance.getSetting("offsetRow"),this.verticalRenderReverse&&y){if(-this.wtDom.outerHeight(h.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(h),this.instance.update("offsetRow",n+1),this.tbodyChildrenLength--,this.rowFilter.readSettings(this.instance);break}this.instance.cloneSource||(m=this.rowStrategy.add(t,u,this.verticalRenderReverse),m===!1&&this.rowStrategy.removeOutstanding())}else if(!this.instance.cloneSource&&(m=this.rowStrategy.add(t,u,this.verticalRenderReverse),m===!1&&(this.instance.getSetting("nativeScrollbars")||this.rowStrategy.removeOutstanding()),this.rowStrategy.isLastIncomplete())){if(this.verticalRenderReverse&&!this.isRowInViewport(g))return this.verticalRenderReverse=!1,this.instance.update("offsetRow",g),void this.draw();break}if(this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource?h.style.height=this.instance.getSetting("rowHeight",e)+"px":this.instance.getSetting("rowHeight",e,u)),this.verticalRenderReverse&&t>=this.rowFilter.fixedCount){if(0===n)break;this.instance.update("offsetRow",n-1),this.rowFilter.readSettings(this.instance)}else t++;e=this.rowFilter.visibleToSource(t)}}if(p||this.adjustAvailableNodes(),!(this.instance.cloneOverlay instanceof w))for(t=this.rowStrategy.countVisible();this.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.tbodyChildrenLength--;if(this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!1),!this.instance.cloneSource&&f!==this.instance.wtViewport.getWorkspaceWidth())for(this.columnStrategy.stretch(),o=0;o<this.columnStrategy.cellCount;o++)this.COLGROUP.childNodes[o+c].style.width=this.columnStrategy.getSize(o)+"px";this.verticalRenderReverse=!1},O.prototype.refreshPositions=function(t){this.refreshHiderDimensions(),this.refreshSelections(t)},O.prototype.refreshSelections=function(t){var e,o,i,n,r,s,a=[],l=this.rowStrategy.countVisible(),c=this.columnStrategy.countVisible();if(this.oldCellCache=this.currentCellCache,this.currentCellCache=new p,this.instance.selections)for(o in this.instance.selections)this.instance.selections.hasOwnProperty(o)&&(this.instance.selections[o].draw(),this.instance.selections[o].settings.className&&a.push(this.instance.selections[o].settings.className),this.instance.selections[o].settings.highlightRowClassName&&a.push(this.instance.selections[o].settings.highlightRowClassName),this.instance.selections[o].settings.highlightColumnClassName&&a.push(this.instance.selections[o].settings.highlightColumnClassName));for(s=a.length,e=0;l>e;e++)for(i=0;c>i;i++)for(o=this.rowFilter.visibleToSource(e),n=this.columnFilter.visibleToSource(i),r=0;s>r;r++)this.currentCellCache.test(e,i,a[r])?this.wtDom.addClass(this.getCell([o,n]),a[r]):t&&this.oldCellCache.test(e,i,a[r])&&this.wtDom.removeClass(this.getCell([o,n]),a[r])},O.prototype.getCell=function(t){return this.isRowBeforeViewport(t[0])?-1:this.isRowAfterViewport(t[0])?-2:this.isColumnBeforeViewport(t[1])?-3:this.isColumnAfterViewport(t[1])?-4:this.TBODY.childNodes[this.rowFilter.sourceToVisible(t[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t[1])]},O.prototype.getCoords=function(t){return[this.rowFilter.visibleToSource(this.wtDom.index(t.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(t.cellIndex)]},O.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)},O.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)},O.prototype.isRowBeforeViewport=function(t){return this.rowFilter.sourceToVisible(t)<this.rowFilter.fixedCount&&t>=this.rowFilter.fixedCount},O.prototype.isRowAfterViewport=function(t){return t>this.getLastVisibleRow()},O.prototype.isColumnBeforeViewport=function(t){return this.columnFilter.sourceToVisible(t)<this.columnFilter.fixedCount&&t>=this.columnFilter.fixedCount},O.prototype.isColumnAfterViewport=function(t){return t>this.getLastVisibleColumn()},O.prototype.isRowInViewport=function(t){return!this.isRowBeforeViewport(t)&&!this.isRowAfterViewport(t)},O.prototype.isColumnInViewport=function(t){return!this.isColumnBeforeViewport(t)&&!this.isColumnAfterViewport(t)},O.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete()},O.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete()},M.prototype.getWorkspaceHeight=function(t){if(this.instance.getSetting("nativeScrollbars"))return this.instance.wtScrollbars.vertical.windowSize;var e=this.instance.getSetting("height");return(1/0===e||void 0===e||null===e||1>e)&&(e=this.instance.wtScrollbars.vertical instanceof c?this.instance.wtScrollbars.vertical.availableSize():1/0),1/0!==e&&(t>=e?e-=this.instance.getSetting("scrollbarHeight"):this.instance.wtScrollbars.horizontal.visible&&(e-=this.instance.getSetting("scrollbarHeight"))),e},M.prototype.getWorkspaceWidth=function(t){var e=this.instance.getSetting("width");return(1/0===e||void 0===e||null===e||1>e)&&(e=this.instance.wtScrollbars.horizontal instanceof c?this.instance.wtScrollbars.horizontal.availableSize():1/0),1/0!==e&&(t>=e?e-=this.instance.getSetting("scrollbarWidth"):this.instance.wtScrollbars.vertical.visible&&(e-=this.instance.getSetting("scrollbarWidth"))),e},M.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)},M.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)},M.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){var t=this.instance.wtDom.offset(this.instance.wtTable.TBODY),e=this.instance.wtTable.tableOffset;this.columnHeaderHeight=t.top-e.top}return this.columnHeaderHeight},M.prototype.getViewportHeight=function(t){var e=this.getWorkspaceHeight(t);if(1/0===e)return e;var o=this.getColumnHeaderHeight();return o>0?e-o:e},M.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var t=this.instance.getSetting("rowHeaders");if(t.length){var e=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var o=0,i=t.length;i>o;o++)e?(this.rowHeaderWidth+=this.instance.wtDom.outerWidth(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},M.prototype.getViewportWidth=function(t){var e=this.getWorkspaceWidth(t);if(1/0===e)return e;var o=this.getRowHeaderWidth();return o>0?e-o:e},M.prototype.resetSettings=function(){this.rowHeaderWidth=0/0,this.columnHeaderHeight=0/0};var q={x:0,y:0,init:function(){this.setEvent("mouse"),this.setEvent("touch")},setEvent:function(t){var e=document["on"+t+"move"]||function(){};document["on"+t+"move"]=function(t){e(t),q.refresh(t)}},refresh:function(t){t||(t=e.event),"mousemove"==t.type?this.set(t):t.touches&&this.set(t.touches[0])},set:function(t){t.pageX||t.pageY?(this.x=t.pageX,this.y=t.pageY):document.body&&(t.clientX||t.clientY)&&(this.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop)}};q.init();var Q={get:function(t){var e=0,o=0;if(t.offsetParent)do o+=t.offsetLeft,e+=t.offsetTop;while(t=t.offsetParent);return[o,e]}},J=function(t,e){if("string"==typeof t&&(t=document.getElementById(t)),t){var o=t.getElementsByTagName("div")[0];o&&-1!=o.className.search(/(^|\s)handle(\s|$)/)&&(this.init(t,o,e||{}),this.setup())}};J.prototype={init:function(t,e,o){this.wrapper=t,this.handle=e,this.options=o,this.disabled=this.getOption("disabled",!1),this.horizontal=this.getOption("horizontal",!0),this.vertical=this.getOption("vertical",!1),this.slide=this.getOption("slide",!0),this.steps=this.getOption("steps",0),this.snap=this.getOption("snap",!1),this.loose=this.getOption("loose",!1),this.speed=this.getOption("speed",10)/100,this.xPrecision=this.getOption("xPrecision",0),this.yPrecision=this.getOption("yPrecision",0),this.callback=o.callback||null,this.animationCallback=o.animationCallback||null,this.bounds={left:o.left||0,right:-(o.right||0),top:o.top||0,bottom:-(o.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0},this.value={prev:[-1,-1],current:[o.x||0,o.y||0],target:[o.x||0,o.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.change=[0,0],this.activity=!1,this.dragging=!1,this.tapping=!1},getOption:function(t,e){return void 0!==this.options[t]?this.options[t]:e},setup:function(){this.setWrapperOffset(),this.setBoundsPadding(),this.setBounds(),this.setSteps(),this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=Q.get(this.wrapper)},setBoundsPadding:function(){this.bounds.left||this.bounds.right||(this.bounds.left=Q.get(this.handle)[0]-this.offset.wrapper[0],this.bounds.right=-this.bounds.left),this.bounds.top||this.bounds.bottom||(this.bounds.top=Q.get(this.handle)[1]-this.offset.wrapper[1],this.bounds.bottom=-this.bounds.top)},setBounds:function(){this.bounds.x0=this.bounds.left,this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right,this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth,this.bounds.y0=this.bounds.top,this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom,this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight,this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth)),this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var t=0;t<=this.steps-1;t++)this.stepRatios[t]=t/(this.steps-1)}},addListeners:function(){var t=this;this.wrapper.onselectstart=function(){return!1},this.handle.onmousedown=this.handle.ontouchstart=function(e){t.handleDownHandler(e)},this.wrapper.onmousedown=this.wrapper.ontouchstart=function(e){t.wrapperDownHandler(e)};var o=document.onmouseup||function(){};document.onmouseup=function(e){o(e),t.documentUpHandler(e)};var i=document.ontouchend||function(){};document.ontouchend=function(e){i(e),t.documentUpHandler(e)};var n=e.onresize||function(){};e.onresize=function(e){n(e),t.documentResizeHandler(e)},this.wrapper.onmousemove=function(e){t.activity=!0},this.wrapper.onclick=function(e){return!t.activity},this.interval=setInterval(function(){t.animate()},25),t.animate(!1,!0)},handleDownHandler:function(t){this.activity=!1,q.refresh(t),this.preventDefaults(t,!0),this.startDrag()},wrapperDownHandler:function(t){q.refresh(t),this.preventDefaults(t,!0),this.startTap()},documentUpHandler:function(t){this.stopDrag(),this.stopTap()},documentResizeHandler:function(t){this.setWrapperOffset(),this.setBounds(),this.update()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,this.handle.className+=" disabled"},setStep:function(t,e,o){this.setValue(this.steps&&t>1?(t-1)/(this.steps-1):0,this.steps&&e>1?(e-1)/(this.steps-1):0,o)},setValue:function(t,e,o){this.setTargetValue([t,e||0]),o&&this.groupCopy(this.value.current,this.value.target)},startTap:function(t){this.disabled||(this.tapping=!0,this.setWrapperOffset(),this.setBounds(),void 0===t&&(t=[q.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,q.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]),this.setTargetOffset(t))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current),this.result())},startDrag:function(){this.disabled||(this.setWrapperOffset(),this.setBounds(),this.offset.mouse=[q.x-Q.get(this.handle)[0],q.y-Q.get(this.handle)[1]],this.dragging=!0)},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var t=this.groupClone(this.value.current);if(this.slide){var e=this.change;t[0]+=4*e[0],t[1]+=4*e[1]}this.setTargetValue(t),this.result()}},feedback:function(){var t=this.value.current;this.snap&&this.steps>1&&(t=this.getClosestSteps(t)),this.groupCompare(t,this.value.prev)||("function"==typeof this.animationCallback&&this.animationCallback(t[0],t[1]),this.groupCopy(this.value.prev,t))},result:function(){"function"==typeof this.callback&&this.callback(this.value.target[0],this.value.target[1])},animate:function(t,e){if(!t||this.dragging){if(this.dragging){var o=this.groupClone(this.value.target),i=[q.x-this.offset.wrapper[0]-this.offset.mouse[0],q.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(i,this.loose),this.change=[this.value.target[0]-o[0],this.value.target[1]-o[1]]}(this.dragging||e)&&this.groupCopy(this.value.current,this.value.target),(this.dragging||this.glide()||e)&&(this.update(),this.feedback())}},glide:function(){var t=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return t[0]||t[1]?(Math.abs(t[0])>this.bounds.xStep||Math.abs(t[1])>this.bounds.yStep?(this.value.current[0]+=t[0]*this.speed,this.value.current[1]+=t[1]*this.speed):this.groupCopy(this.value.current,this.value.target),!0):!1},update:function(){this.offset.current=this.getOffsetsByRatios(this.snap?this.getClosestSteps(this.value.current):this.value.current),this.show()},show:function(){this.groupCompare(this.offset.current,this.offset.prev)||(this.horizontal&&(this.handle.style.left=String(this.offset.current[0])+"px"),this.vertical&&(this.handle.style.top=String(this.offset.current[1])+"px"),this.groupCopy(this.offset.prev,this.offset.current))},setTargetValue:function(t,e){var o=e?this.getLooseValue(t):this.getProperValue(t);this.groupCopy(this.value.target,o),this.offset.target=this.getOffsetsByRatios(o)},setTargetOffset:function(t,e){var o=this.getRatiosByOffsets(t),i=e?this.getLooseValue(o):this.getProperValue(o);this.groupCopy(this.value.target,i),this.offset.target=this.getOffsetsByRatios(i)},getLooseValue:function(t){var e=this.getProperValue(t);return[e[0]+(t[0]-e[0])/4,e[1]+(t[1]-e[1])/4]},getProperValue:function(t){var e=this.groupClone(t);return e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0),e[0]=Math.min(e[0],1),e[1]=Math.min(e[1],1),(!this.dragging&&!this.tapping||this.snap)&&this.steps>1&&(e=this.getClosestSteps(e)),e},getRatiosByOffsets:function(t){return[this.getRatioByOffset(t[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(t[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(t,e,o){return e?(t-o)/e:0},getOffsetsByRatios:function(t){return[this.getOffsetByRatio(t[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(t[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(t,e,o){return Math.round(t*e)+o},getClosestSteps:function(t){return[this.getClosestStep(t[0]),this.getClosestStep(t[1])]},getClosestStep:function(t){for(var e=0,o=1,i=0;i<=this.steps-1;i++)Math.abs(this.stepRatios[i]-t)<o&&(o=Math.abs(this.stepRatios[i]-t),e=i);return this.stepRatios[e]},groupCompare:function(t,e){return t[0]==e[0]&&t[1]==e[1]},groupCopy:function(t,e){t[0]=e[0],t[1]=e[1]},groupClone:function(t){return[t[0],t[1]]},preventDefaults:function(t,o){t||(t=e.event),t.preventDefault&&t.preventDefault(),t.returnValue=!1,o&&document.selection&&document.selection.empty()},cancelEvent:function(t){t||(t=e.event),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0}},function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function o(o){var i=o||e.event,n=[].slice.call(arguments,1),a=0,l=0,c=0,h=0,u=0,d;return o=t.event.fix(i),o.type="mousewheel",i.wheelDelta&&(a=i.wheelDelta),i.detail&&(a=-1*i.detail),i.deltaY&&(c=-1*i.deltaY,a=c),i.deltaX&&(l=i.deltaX,a=-1*l),void 0!==i.wheelDeltaY&&(c=i.wheelDeltaY),void 0!==i.wheelDeltaX&&(l=-1*i.wheelDeltaX),h=Math.abs(a),(!r||r>h)&&(r=h),u=Math.max(Math.abs(c),Math.abs(l)),(!s||s>u)&&(s=u),d=a>0?"floor":"ceil",a=Math[d](a/r),l=Math[d](l/s),c=Math[d](c/s),n.unshift(o,a,l,c),(t.event.dispatch||t.event.handle).apply(this,n)}var i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],r,s;if(t.event.fixHooks)for(var a=i.length;a;)t.event.fixHooks[i[--a]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=n.length;t;)this.addEventListener(n[--t],o,!1);else this.onmousewheel=o},teardown:function(){if(this.removeEventListener)for(var t=n.length;t;)this.removeEventListener(n[--t],o,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})}(jQuery,window,Handsontable),function(){function t(t){this._n=t}function e(t,e,o){var i=Math.pow(10,e),n;if(n=(Math.round(t*i)/i).toFixed(e),o){var r=new RegExp("0{1,"+o+"}$");
n=n.replace(r,"")}return n}function o(t,e){var o;return o=e.indexOf("$")>-1?n(t,e):e.indexOf("%")>-1?r(t,e):e.indexOf(":")>-1?s(t,e):l(t,e)}function i(t,e){if(e.indexOf(":")>-1)t._n=a(e);else if(e===f)t._n=0;else{var o=e;"."!==d[p].delimiters.decimal&&(e=e.replace(/\./g,"").replace(d[p].delimiters.decimal,"."));for(var i=new RegExp(d[p].abbreviations.thousand+"(?:\\)|(\\"+d[p].currency.symbol+")?(?:\\))?)?$"),n=new RegExp(d[p].abbreviations.million+"(?:\\)|(\\"+d[p].currency.symbol+")?(?:\\))?)?$"),r=new RegExp(d[p].abbreviations.billion+"(?:\\)|(\\"+d[p].currency.symbol+")?(?:\\))?)?$"),s=new RegExp(d[p].abbreviations.trillion+"(?:\\)|(\\"+d[p].currency.symbol+")?(?:\\))?)?$"),l=["KB","MB","GB","TB","PB","EB","ZB","YB"],c=!1,h=0;h<=l.length&&!(c=e.indexOf(l[h])>-1?Math.pow(1024,h+1):!1);h++);t._n=(c?c:1)*(o.match(i)?Math.pow(10,3):1)*(o.match(n)?Math.pow(10,6):1)*(o.match(r)?Math.pow(10,9):1)*(o.match(s)?Math.pow(10,12):1)*(e.indexOf("%")>-1?.01:1)*Number((e.indexOf("(")>-1?"-":"")+e.replace(/[^0-9\.-]+/g,"")),t._n=c?Math.ceil(t._n):t._n}return t._n}function n(t,e){var i=e.indexOf("$")<=1?!0:!1,n="";e.indexOf(" $")>-1?(n=" ",e=e.replace(" $","")):e.indexOf("$ ")>-1?(n=" ",e=e.replace("$ ","")):e=e.replace("$","");var r=o(t,e);return i?r.indexOf("(")>-1||r.indexOf("-")>-1?(r=r.split(""),r.splice(1,0,d[p].currency.symbol+n),r=r.join("")):r=d[p].currency.symbol+n+r:r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,n+d[p].currency.symbol),r=r.join("")):r=r+n+d[p].currency.symbol,r}function r(t,e){var i="";e.indexOf(" %")>-1?(i=" ",e=e.replace(" %","")):e=e.replace("%",""),t._n=100*t._n;var n=o(t,e);return n.indexOf(")")>-1?(n=n.split(""),n.splice(-1,0,i+"%"),n=n.join("")):n=n+i+"%",n}function s(t,e){var o=Math.floor(t._n/60/60),i=Math.floor((t._n-60*o*60)/60),n=Math.round(t._n-60*o*60-60*i);return o+":"+(10>i?"0"+i:i)+":"+(10>n?"0"+n:n)}function a(t){var e=t.split(":"),o=0;return 3===e.length?(o+=60*Number(e[0])*60,o+=60*Number(e[1]),o+=Number(e[2])):2===e.lenght&&(o+=60*Number(e[0]),o+=Number(e[1])),Number(o)}function l(t,o){var i=!1,n=!1,r="",s="",a="",l=Math.abs(t._n);if(0===t._n&&null!==f)return f;if(o.indexOf("(")>-1&&(i=!0,o=o.slice(1,-1)),o.indexOf("a")>-1&&(o.indexOf(" a")>-1?(r=" ",o=o.replace(" a","")):o=o.replace("a",""),l>=Math.pow(10,12)?(r+=d[p].abbreviations.trillion,t._n=t._n/Math.pow(10,12)):l<Math.pow(10,12)&&l>=Math.pow(10,9)?(r+=d[p].abbreviations.billion,t._n=t._n/Math.pow(10,9)):l<Math.pow(10,9)&&l>=Math.pow(10,6)?(r+=d[p].abbreviations.million,t._n=t._n/Math.pow(10,6)):l<Math.pow(10,6)&&l>=Math.pow(10,3)&&(r+=d[p].abbreviations.thousand,t._n=t._n/Math.pow(10,3))),o.indexOf("b")>-1){o.indexOf(" b")>-1?(s=" ",o=o.replace(" b","")):o=o.replace("b","");for(var c=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],h,u,g=0;g<=c.length;g++)if(h=Math.pow(1024,g),u=Math.pow(1024,g+1),t._n>=h&&t._n<u){s+=c[g],h>0&&(t._n=t._n/h);break}}o.indexOf("o")>-1&&(o.indexOf(" o")>-1?(a=" ",o=o.replace(" o","")):o=o.replace("o",""),a+=d[p].ordinal(t._n)),o.indexOf("[.]")>-1&&(n=!0,o=o.replace("[.]","."));var m=t._n.toString().split(".")[0],w=o.split(".")[1],y=o.indexOf(","),v="",C=!1;return w?(w.indexOf("[")>-1?(w=w.replace("]",""),w=w.split("["),v=e(t._n,w[0].length+w[1].length,w[1].length)):v=e(t._n,w.length),m=v.split(".")[0],v=v.split(".")[1].length?d[p].delimiters.decimal+v.split(".")[1]:"",n&&0===Number(v)&&(v="")):m=e(t._n,null),m.indexOf("-")>-1&&(m=m.slice(1),C=!0),y>-1&&(m=m.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d[p].delimiters.thousands)),0===o.indexOf(".")&&(m=""),(i&&C?"(":"")+(!i&&C?"-":"")+m+v+(a?a:"")+(r?r:"")+(s?s:"")+(i&&C?")":"")}function c(t,e){d[t]=e}var h,u="1.4.7",d={},p="en",f=null,g="undefined"!=typeof module&&module.exports;h=function(e){return h.isNumeral(e)?e=e.value():Number(e)||(e=0),new t(Number(e))},h.version=u,h.isNumeral=function(e){return e instanceof t},h.language=function(t,e){return t?(t&&!e&&(p=t),(e||!d[t])&&c(t,e),h):p},h.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1===~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),h.zeroFormat=function(t){f="string"==typeof t?t:null},h.fn=t.prototype={clone:function(){return h(this)},format:function(t){return o(this,t?t:h.defaultFormat)},unformat:function(t){return i(this,t?t:h.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(t){return this._n=Number(t),this},add:function(t){return this._n=this._n+Number(t),this},subtract:function(t){return this._n=this._n-Number(t),this},multiply:function(t){return this._n=this._n*Number(t),this},divide:function(t){return this._n=this._n/Number(t),this},difference:function(t){var e=this._n-Number(t);return 0>e&&(e=-e),e}},g&&(module.exports=h),"undefined"==typeof ender&&(this.numeral=h),"function"==typeof define&&define.amd&&define([],function(){return h})}.call(this);